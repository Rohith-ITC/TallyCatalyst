"use strict";(self.webpackChunkDataLynkr=self.webpackChunkDataLynkr||[]).push([[85],{65442(e,t,n){n.r(t),n.d(t,{default:()=>ae});var a=n(89379),s=n(9950),o=n(42074),r=n(28429);const i=n.p+"static/media/DLlogo.f0670fcb2c87a0fe8926.png";n(6096),n(79983);var l=n(16243),d=n(34534),c=n(1321),p=n(54996),g=n(1049),u=n(44414);const x=e=>{let{isOpen:t,onClose:n,sidebarItems:o,activeView:r,onViewChange:i,name:l,email:d,onProfileClick:c,onLogout:p,profileDropdownOpen:x,setProfileDropdownOpen:f,showGoogleConfigModal:m,setShowGoogleConfigModal:h,SubscriptionBadge:b,navigate:y}=e;const[v,j]=s.useState({});return t?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:9998,animation:"fadeIn 0.3s ease-out"},onClick:n}),(0,u.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"280px",height:"100vh",background:"linear-gradient(180deg, #1e3a8a 0%, #3b82f6 100%)",zIndex:9999,display:"flex",flexDirection:"column",boxShadow:"4px 0 20px rgba(0, 0, 0, 0.3)",animation:"slideInLeft 0.3s ease-out",overflow:"hidden"},onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("button",{onClick:n,style:{position:"absolute",top:"16px",right:"16px",background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:1e4,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="scale(1)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:"24px"},children:"close"})}),(0,u.jsxs)("div",{style:{padding:"24px 20px",display:"flex",alignItems:"center",gap:"12px",borderBottom:"1px solid rgba(255, 255, 255, 0.2)",flexShrink:0},children:[(0,u.jsx)("img",{src:g,alt:"Tally Logo",style:{height:40,width:"auto",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))"}}),(0,u.jsx)("span",{style:{color:"#fff",fontWeight:700,fontSize:20,letterSpacing:.5,textShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:"DataLynkr"})]}),(0,u.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"16px 0",display:"flex",flexDirection:"column",gap:"4px"},children:o.map(e=>{const t=r===e.key,s=v[e.key],o=e.subItems&&e.subItems.length>0;return(0,u.jsxs)("div",{children:[(0,u.jsxs)("button",{onClick:()=>{var t;o?(t=e.key,j(e=>(0,a.A)((0,a.A)({},e),{},{[t]:!e[t]}))):(i(e.key),n())},style:{background:t?"linear-gradient(135deg, rgba(255, 152, 0, 0.25) 0%, rgba(255, 152, 0, 0.15) 100%)":"transparent",color:t?"#ff9800":"rgba(255, 255, 255, 0.95)",border:t?"1px solid rgba(255, 152, 0, 0.4)":"1px solid transparent",padding:"18px 20px",display:"flex",alignItems:"center",gap:"16px",borderRadius:"0",fontWeight:t?700:600,cursor:"pointer",fontSize:"15px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left",width:"100%",borderLeft:t?"5px solid #ff9800":"5px solid transparent",boxShadow:t?"inset 4px 0 12px rgba(255, 152, 0, 0.2), 0 2px 8px rgba(0, 0, 0, 0.1)":"none",position:"relative",margin:"2px 0",overflow:"hidden"},onMouseEnter:e=>{t||(e.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%)",e.currentTarget.style.transform="translateX(4px)",e.currentTarget.style.boxShadow="inset 0 0 20px rgba(255, 255, 255, 0.1), 0 2px 12px rgba(0, 0, 0, 0.15)",e.currentTarget.style.borderLeft="5px solid rgba(255, 255, 255, 0.3)")},onMouseLeave:e=>{t||(e.currentTarget.style.background="transparent",e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderLeft="5px solid transparent")},children:[t&&(0,u.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"5px",background:"linear-gradient(180deg, #ff9800 0%, #ff6f00 100%)",boxShadow:"0 0 12px rgba(255, 152, 0, 0.6)"}}),(0,u.jsx)("div",{style:{width:"44px",height:"44px",borderRadius:"12px",background:t?"linear-gradient(135deg, rgba(255, 152, 0, 0.3) 0%, rgba(255, 152, 0, 0.2) 100%)":"rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.3s",boxShadow:t?"0 4px 12px rgba(255, 152, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)":"0 2px 6px rgba(0, 0, 0, 0.2)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:t?"#ff9800":"rgba(255, 255, 255, 0.95)",transition:"all 0.3s",filter:t?"drop-shadow(0 2px 4px rgba(255, 152, 0, 0.4))":"none"},children:e.icon})}),(0,u.jsx)("span",{style:{flex:1,textAlign:"left",letterSpacing:"0.3px",fontSize:"15px",fontWeight:t?700:600},children:e.label}),o&&(0,u.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:s?"rgba(255, 152, 0, 0.2)":"rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:t?"#ff9800":"rgba(255, 255, 255, 0.8)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), color 0.2s",transform:s?"rotate(180deg)":"rotate(0deg)"},children:"expand_more"})}),t&&!o&&(0,u.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"linear-gradient(135deg, #ff9800 0%, #ff6f00 100%)",boxShadow:"0 0 12px rgba(255, 152, 0, 0.8), 0 0 24px rgba(255, 152, 0, 0.4)",animation:"pulse 2s ease-in-out infinite"}})]}),o&&s&&(0,u.jsx)("div",{style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.15) 100%)",padding:"12px 0",marginTop:"8px",marginLeft:"20px",marginRight:"12px",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"inset 0 2px 8px rgba(0, 0, 0, 0.2), 0 4px 12px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:e.subItems.map((t,a)=>{const s=r===t.key;return(0,u.jsxs)("button",{onClick:()=>{i(t.key),n()},style:{background:s?"linear-gradient(135deg, rgba(255, 152, 0, 0.25) 0%, rgba(255, 152, 0, 0.15) 100%)":"transparent",color:s?"#ff9800":"rgba(255, 255, 255, 0.9)",padding:"16px 20px 16px 20px",display:"flex",alignItems:"center",gap:"16px",borderRadius:"8px",fontWeight:s?700:500,cursor:"pointer",fontSize:"14px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left",width:"calc(100% - 16px)",margin:"4px 8px",borderLeft:s?"4px solid #ff9800":"4px solid transparent",borderBottom:a<e.subItems.length-1?"1px solid rgba(255, 255, 255, 0.08)":"none",position:"relative",boxShadow:s?"0 2px 8px rgba(255, 152, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none"},onMouseEnter:e=>{s||(e.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%)",e.currentTarget.style.color="rgba(255, 255, 255, 1)",e.currentTarget.style.transform="translateX(6px) scale(1.02)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.2)",e.currentTarget.style.borderLeft="4px solid rgba(255, 255, 255, 0.3)")},onMouseLeave:e=>{s||(e.currentTarget.style.background="transparent",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)",e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderLeft="4px solid transparent")},children:[(0,u.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"10px",background:s?"linear-gradient(135deg, rgba(255, 152, 0, 0.3) 0%, rgba(255, 152, 0, 0.2) 100%)":"rgba(255, 255, 255, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.3s",boxShadow:s?"0 2px 8px rgba(255, 152, 0, 0.3)":"0 1px 4px rgba(0, 0, 0, 0.2)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:s?"#ff9800":"rgba(255, 255, 255, 0.8)",transition:"all 0.3s"},children:t.icon})}),(0,u.jsx)("span",{style:{flex:1,textAlign:"left",letterSpacing:"0.3px",fontSize:"14px"},children:t.label}),s&&(0,u.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"linear-gradient(135deg, #ff9800 0%, #ff6f00 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(255, 152, 0, 0.5)",flexShrink:0},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#fff"},children:"check"})})]},t.key)})})]},e.key)})}),(0,u.jsxs)("div",{style:{padding:"16px 20px",borderTop:"1px solid rgba(255, 255, 255, 0.2)",display:"flex",flexDirection:"column",gap:"12px",flexShrink:0,background:"rgba(0, 0, 0, 0.1)"},children:[b&&(0,u.jsx)("div",{style:{marginBottom:"8px"},children:(0,u.jsx)(b,{})}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("button",{onClick:()=>{f(!x)},style:{background:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"10px",padding:"12px 16px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600,transition:"all 0.2s ease",width:"100%"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.25)",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)",e.currentTarget.style.transform="translateY(0)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"account_circle"}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1},children:[(0,u.jsx)("span",{style:{fontSize:"14px",fontWeight:600},children:l||"User"}),(0,u.jsx)("span",{style:{fontSize:"12px",opacity:.8},children:d||""})]}),(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"rgba(255, 255, 255, 0.8)",transition:"transform 0.3s ease",transform:x?"rotate(180deg)":"rotate(0deg)"},children:"expand_more"})]}),x&&(0,u.jsxs)("div",{style:{position:"absolute",bottom:"100%",left:0,right:0,marginBottom:"8px",background:"#fff",borderRadius:16,boxShadow:"0 12px 40px 0 rgba(31, 38, 135, 0.2), 0 0 0 1px rgba(0,0,0,0.05)",padding:20,zIndex:1e4,textAlign:"left",animation:"fadeIn 0.2s ease-out"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,paddingBottom:12,borderBottom:"1px solid #e5e7eb"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32,color:"#3b82f6"},children:"account_circle"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:16,color:"#1e293b",fontWeight:700,marginBottom:2},children:l||"User"}),(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b"},children:d||""})]})]}),(0,u.jsxs)("button",{style:{width:"100%",padding:"12px 18px",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(59,130,246,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:8,transition:"all 0.3s ease",marginBottom:10},onClick:()=>{y("/change-password"),n()},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"lock"}),"Change Password"]}),(0,u.jsxs)("button",{style:{width:"100%",padding:"12px 18px",background:"linear-gradient(135deg, #4285f4 0%, #34a853 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(66,133,244,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:8,transition:"all 0.3s ease"},onClick:()=>{h(!0),f(!1),n()},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"account_circle"}),"Configure Google Account"]})]})]}),(0,u.jsxs)("button",{onClick:()=>{p(),n()},style:{background:"rgba(220, 38, 38, 0.2)",border:"1px solid rgba(220, 38, 38, 0.4)",borderRadius:"10px",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600,transition:"all 0.2s ease",width:"100%"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(220, 38, 38, 0.3)",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(220, 38, 38, 0.2)",e.currentTarget.style.transform="translateY(0)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"logout"}),(0,u.jsx)("span",{children:"Logout"})]})]})]}),(0,u.jsx)("style",{children:"\n          @keyframes fadeIn {\n            from { opacity: 0; }\n            to { opacity: 1; }\n          }\n          @keyframes slideInLeft {\n            from { \n              transform: translateX(-100%);\n            }\n            to { \n              transform: translateX(0);\n            }\n          }\n          @keyframes pulse {\n            0%, 100% {\n              opacity: 1;\n              transform: scale(1);\n            }\n            50% {\n              opacity: 0.7;\n              transform: scale(1.1);\n            }\n          }\n        "})]}):null},f=()=>{const[e,t]=s.useState(window.innerWidth<=768);return s.useEffect(()=>{const e=()=>{t(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e},m=e=>{let{companyGuid:t,companyFields:n,companyArrays:a,activeTable:o,onTableChange:r,onAddField:i,onRemoveField:l,onUpdateField:d,onAddArray:c,onRemoveArray:p,onUpdateArray:g,onAddArrayField:x,onRemoveArrayField:f,onUpdateArrayField:m}=e;const h=n[o]||[],b=(null===a||void 0===a?void 0:a[o])||[],[y,v]=(0,s.useState)(!1),j=(0,s.useRef)(null),S=(0,s.useRef)({}),w=(0,s.useRef)({}),k=(0,s.useRef)({arrayId:null,selectionStart:null,selectionEnd:null});(0,s.useLayoutEffect)(()=>{const{arrayId:e,selectionStart:t,selectionEnd:n}=k.current;if(e&&S.current[e]){const s=S.current[e];if(s)if(s.focus(),null!==t&&null!==n)try{s.setSelectionRange(t,n)}catch(a){const e=s.value.length;s.setSelectionRange(e,e)}else{const e=s.value.length;s.setSelectionRange(e,e)}k.current={arrayId:null,selectionStart:null,selectionEnd:null}}},[b]);const _=(0,s.useCallback)((e,t,n,a)=>{const s=S.current[t];s&&s===document.activeElement&&(k.current={arrayId:t,selectionStart:s.selectionStart,selectionEnd:s.selectionEnd}),g(e,t,n,a)},[g]),N=(0,s.useCallback)((e,t,n,a,s)=>{const o="".concat(t,"_").concat(n,"_").concat(a),r=w.current[o],i=r===document.activeElement;m(e,t,n,a,s),i&&r&&requestAnimationFrame(()=>{const e=w.current[o];if(e){e.focus();const t=e.value.length;e.setSelectionRange(t,t)}})},[m]),C={voucher:{icon:"description",label:"Voucher",color:"#3b82f6"},ledgerentries:{icon:"account_balance",label:"Ledger Entries",color:"#10b981"},billallocations:{icon:"receipt_long",label:"Bill Allocations",color:"#f59e0b"},inventoryentries:{icon:"inventory_2",label:"Inventory Entries",color:"#8b5cf6"},batchallocations:{icon:"diamond",label:"Batch Allocations",color:"#ef4444"}};(0,s.useEffect)(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&v(!1)};return y&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[y]);const z=C[o]||{icon:"table_chart",label:o,color:"#3b82f6"};return(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,u.jsxs)("div",{style:{position:"relative"},ref:j,children:[(0,u.jsxs)("button",{type:"button",onClick:()=>v(!y),style:{width:"100%",padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px",background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"13px",fontWeight:500,color:"#1f2937",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.borderColor=z.color},onMouseLeave:e=>{e.currentTarget.style.borderColor="#d1d5db"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px",color:z.color},children:z.icon}),(0,u.jsx)("span",{children:z.label})]}),(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px",color:"#64748b",transform:y?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"arrow_drop_down"})]}),y&&(0,u.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"#fff",border:"1px solid #d1d5db",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:["voucher","ledgerentries","billallocations","inventoryentries","batchallocations"].map(e=>{const t=C[e]||{icon:"table_chart",label:e,color:"#64748b"},n=o===e;return(0,u.jsxs)("button",{onClick:()=>{r(e),v(!1)},style:{width:"100%",padding:"12px 14px",border:"none",background:n?"".concat(t.color,"10"):"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"13px",fontWeight:n?600:500,color:n?t.color:"#1f2937",textAlign:"left",transition:"background 0.2s",borderLeft:n?"3px solid ".concat(t.color):"3px solid transparent"},onMouseEnter:e=>{n||(e.currentTarget.style.background="#f9fafb")},onMouseLeave:e=>{n||(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px",color:n?t.color:"#64748b"},children:t.icon}),t.label,n&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px",color:t.color,marginLeft:"auto"},children:"check"})]},e)})})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,u.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:"#1f2937",display:"flex",alignItems:"center",gap:"8px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px",color:z.color},children:z.icon}),(0,u.jsx)("span",{children:"Field Configurations"}),h.length>0&&(0,u.jsxs)("span",{style:{fontSize:"12px",fontWeight:500,color:"#64748b",marginLeft:"8px"},children:["(",h.length,")"]})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,u.jsxs)("button",{type:"button",onClick:()=>i(o),style:{padding:"8px 14px",border:"1px solid #d1d5db",borderRadius:"6px",background:"#fff",color:"#374151",fontSize:"12px",fontWeight:500,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:e=>{e.currentTarget.style.background=z.color,e.currentTarget.style.color="#fff",e.currentTarget.style.borderColor=z.color},onMouseLeave:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#374151",e.currentTarget.style.borderColor="#d1d5db"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"add"}),"Add Field"]}),c&&(0,u.jsxs)("button",{type:"button",onClick:()=>c(o),style:{padding:"8px 14px",border:"2px solid #3b82f6",borderRadius:"6px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontSize:"12px",fontWeight:600,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(59, 130, 246, 0.3)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"add_circle"}),"Add Aggregate"]})]})]}),(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0",maxHeight:"450px",overflowY:"auto",overflowX:"hidden",paddingRight:"4px"},children:0===h.length?(0,u.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#94a3b8",background:"#f9fafb",borderRadius:"6px",border:"1px dashed #d1d5db"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"40px",display:"block",marginBottom:"8px",color:"#cbd5e1"},children:"add_circle_outline"}),(0,u.jsx)("div",{style:{fontSize:"13px",color:"#64748b"},children:'No field configurations. Click "Add Field" to get started.'})]}):(0,u.jsx)("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:"6px",overflow:"hidden"},children:h.map((e,t)=>(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 14px",borderBottom:t<h.length-1?"1px solid #f3f4f6":"none",transition:"background 0.2s",background:t%2===0?"#fff":"#fafbfc"},onMouseEnter:e=>{e.currentTarget.style.background="#f0f9ff"},onMouseLeave:e=>{e.currentTarget.style.background=t%2===0?"#fff":"#fafbfc"},children:[(0,u.jsxs)("div",{style:{minWidth:"24px",fontSize:"12px",fontWeight:500,color:"#9ca3af",textAlign:"center"},children:[t+1,"."]}),(0,u.jsx)("div",{style:{flex:"0 0 180px",minWidth:0},children:(0,u.jsx)("input",{type:"text",value:e.fieldName||"",onChange:t=>d(o,e.id,"fieldName",t.target.value),placeholder:"Field name",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px",outline:"none",transition:"all 0.2s",background:"#fff",color:"#1f2937",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor=z.color,e.target.style.boxShadow="0 0 0 2px ".concat(z.color,"20")},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none"}})}),(0,u.jsx)("div",{style:{flex:"1 1 auto",minWidth:0},children:(0,u.jsx)("input",{type:"text",value:e.formula||"",onChange:t=>d(o,e.id,"formula",t.target.value),placeholder:"Formula (e.g., $Parent:Ledger:$PartyLedgerName)",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px",outline:"none",transition:"all 0.2s",fontFamily:'"Consolas", "Monaco", "Courier New", monospace',background:"#fff",color:"#1f2937",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor=z.color,e.target.style.boxShadow="0 0 0 2px ".concat(z.color,"20")},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none"}})}),(0,u.jsx)("button",{type:"button",onClick:()=>l(o,e.id),style:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",width:"32px",height:"32px",background:"transparent",border:"none",borderRadius:"4px",color:"#ef4444",cursor:"pointer",transition:"all 0.2s",flexShrink:0},onMouseEnter:e=>{e.currentTarget.style.background="#fee2e2"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Remove field",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px"},children:"delete"})})]},e.id))})}),b.length>0&&(0,u.jsx)("div",{style:{marginTop:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:b.map((e,t)=>{var n;return(0,u.jsxs)("div",{style:{background:"#fff",border:"2px solid #3b82f6",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.1)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",paddingBottom:"12px",borderBottom:"1px solid #e5e7eb"},children:[(0,u.jsxs)("div",{style:{minWidth:"24px",fontSize:"12px",fontWeight:600,color:"#3b82f6"},children:["Aggregate ",t+1,":"]}),(0,u.jsx)("div",{style:{flex:1},children:(0,u.jsx)("input",{ref:t=>{t?S.current[e.id]=t:delete S.current[e.id]},type:"text",value:e.arrayName||"",onChange:t=>_(o,e.id,"arrayName",t.target.value),placeholder:"",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px",fontWeight:600,outline:"none",background:"#f9fafb",color:"#1f2937",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 2px #3b82f620",e.target.style.background="#fff"},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none",e.target.style.background="#f9fafb"}})}),(0,u.jsx)("button",{type:"button",onClick:()=>p(o,e.id),style:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",width:"32px",height:"32px",background:"transparent",border:"none",borderRadius:"4px",color:"#ef4444",cursor:"pointer",transition:"all 0.2s",flexShrink:0},onMouseEnter:e=>{e.currentTarget.style.background="#fee2e2"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Remove array",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px"},children:"delete"})})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,u.jsxs)("div",{style:{fontSize:"12px",fontWeight:600,color:"#64748b"},children:["Fields (",(null===(n=e.fields)||void 0===n?void 0:n.length)||0,")"]}),(0,u.jsxs)("button",{type:"button",onClick:()=>x(o,e.id),style:{padding:"6px 12px",border:"1px solid #d1d5db",borderRadius:"4px",background:"#fff",color:"#374151",fontSize:"11px",fontWeight:500,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:e=>{e.currentTarget.style.background="#3b82f6",e.currentTarget.style.color="#fff",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#374151",e.currentTarget.style.borderColor="#d1d5db"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"14px"},children:"add"}),"Add Field"]})]}),e.fields&&0!==e.fields.length?(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:e.fields.map((t,n)=>(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px",background:n%2===0?"#f9fafb":"#fff",borderRadius:"4px",border:"1px solid #e5e7eb"},children:[(0,u.jsxs)("div",{style:{minWidth:"20px",fontSize:"11px",fontWeight:500,color:"#9ca3af",textAlign:"center"},children:[n+1,"."]}),(0,u.jsx)("div",{style:{flex:"0 0 150px",minWidth:0},children:(0,u.jsx)("input",{ref:n=>{const a="".concat(e.id,"_").concat(t.id,"_fieldName");n?w.current[a]=n:delete w.current[a]},type:"text",value:t.fieldName||"",onChange:n=>N(o,e.id,t.id,"fieldName",n.target.value),placeholder:"Field name",style:{width:"100%",padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"11px",outline:"none",background:"#fff",color:"#1f2937",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 2px #3b82f620"},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none"}})}),(0,u.jsx)("div",{style:{flex:"1 1 auto",minWidth:0},children:(0,u.jsx)("input",{ref:n=>{const a="".concat(e.id,"_").concat(t.id,"_formula");n?w.current[a]=n:delete w.current[a]},type:"text",value:t.formula||"",onChange:n=>N(o,e.id,t.id,"formula",n.target.value),placeholder:"Formula (e.g., $Parent:Ledger:$PartyLedgerName)",style:{width:"100%",padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"11px",outline:"none",fontFamily:'"Consolas", "Monaco", "Courier New", monospace',background:"#fff",color:"#1f2937",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 2px #3b82f620"},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none"}})}),(0,u.jsx)("button",{type:"button",onClick:()=>f(o,e.id,t.id),style:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",width:"28px",height:"28px",background:"transparent",border:"none",borderRadius:"4px",color:"#ef4444",cursor:"pointer",transition:"all 0.2s",flexShrink:0},onMouseEnter:e=>{e.currentTarget.style.background="#fee2e2"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Remove field",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"delete"})})]},t.id))}):(0,u.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#94a3b8",background:"#f9fafb",borderRadius:"4px",border:"1px dashed #d1d5db",fontSize:"12px"},children:'No fields in this aggregate. Click "Add Field" to add fields.'})]})]},e.id)})})]})};const h=function(){var e,t;const n=f(),[o,r]=(0,s.useState)([]),[i,g]=(0,s.useState)(!1),[x,h]=(0,s.useState)({ip:"",port:"",connectionName:"",accessType:"Tally"}),[b,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(""),[S,w]=(0,s.useState)(""),[k,_]=(0,s.useState)(""),[N,C]=(sessionStorage.getItem("token"),(0,s.useState)({})),[z,I]=(0,s.useState)(!1),[A,T]=(0,s.useState)(!1),[R,E]=(0,s.useState)(null),[W,L]=(0,s.useState)([]),[B,P]=(0,s.useState)(0),[M,F]=(0,s.useState)({}),[D,U]=(0,s.useState)(!1),[Y,O]=(0,s.useState)(!1),[G,H]=(0,s.useState)({}),[q,V]=(0,s.useState)("voucher"),J=["voucher","ledgerentries","billallocations","inventoryentries","batchallocations"],[X,K]=(0,s.useState)({}),[Z,$]=(0,s.useState)({}),[Q,ee]=(0,s.useState)({}),[te,ne]=(0,s.useState)(!1),[ae,se]=(0,s.useState)(null),[oe,re]=(0,s.useState)(null),[ie,le]=(0,s.useState)(null),[de,ce]=(0,s.useState)(!1),pe=async()=>{g(!0),_("");try{const e=Date.now(),t=await(0,d.Vg)("/api/tally/connections/all?ts=".concat(e));if(t&&t.success)r(t.data.connections||[]);else if(t)throw new Error(t.message||"Failed to fetch connections")}catch(e){_(e.message)}finally{g(!1)}};(0,s.useEffect)(()=>{pe(),ge()},[]),(0,s.useEffect)(()=>{if(te&&W.length>0){const e=W[B];if(e&&M[e.guid]){const t=M[e.guid];if(t&&t.configs){const n=t.configs.find(e=>"google_display_name"===e.config_key),s=t.configs.find(e=>"google_token"===e.config_key);if(n&&n.permission_value&&re(n.permission_value),s&&s.permission_value){(async()=>{try{const o=(null===R||void 0===R?void 0:R.tallyloc_id)||(null===R||void 0===R?void 0:R.id),r=e.guid;if(o&&r){const e=await(0,c.Ir)(o,r);if(e){if(se(e),localStorage.setItem("google_access_token",e),localStorage.setItem("google_access_token_timestamp",Date.now().toString()),null===n||void 0===n||!n.permission_value)try{const t=await ke(e);re(t),F(e=>{const n=(0,a.A)({},e);return n[r]&&n[r].configs&&(n[r]=(0,a.A)((0,a.A)({},n[r]),{},{configs:n[r].configs.map(e=>"google_display_name"===e.config_key?(0,a.A)((0,a.A)({},e),{},{permission_value:t}):e)})),n})}catch(t){console.warn("Could not fetch display name:",t)}}else se(null),localStorage.removeItem("google_access_token")}else se(s.permission_value),localStorage.setItem("google_access_token",s.permission_value)}catch(o){console.error("Error validating/refreshing token:",o),se(s.permission_value)}})()}else{const e=localStorage.getItem("google_access_token");e&&(se(e),ke(e).then(e=>{if(e){const t=W[B];t&&F(n=>{const s=(0,a.A)({},n);return s[t.guid]&&s[t.guid].configs&&(s[t.guid]=(0,a.A)((0,a.A)({},s[t.guid]),{},{configs:s[t.guid].configs.map(t=>"google_display_name"===t.config_key?(0,a.A)((0,a.A)({},t),{},{permission_value:e}):t)})),s})}}).catch(()=>{}))}}}}},[te,M,W,B,R]);const ge=(0,s.useCallback)(async()=>{I(!0);try{const e=Date.now(),t=await(0,d.Vg)("/api/tally/user-connections?ts=".concat(e));let n=[];if(Array.isArray(t))n=t;else if(t){const e=Array.isArray(t.createdByMe)?t.createdByMe:[],a=Array.isArray(t.sharedWithMe)?t.sharedWithMe:[];n=[...e,...a]}const a={};n.filter(e=>"connected"===((null===e||void 0===e?void 0:e.status)||"").toLowerCase()).forEach(e=>{const t=e.conn_name||e.connectionName||e.connection_name||e.name||"";t&&(a[t]||(a[t]=[]),a[t].push({guid:e.guid||"".concat(t,"-").concat(e.company),company:e.company,accessType:e.access_type||e.accessType||"Unknown",status:e.status,tallyloc_id:e.tallyloc_id}))}),C(a);const s=Object.values(a).flat();await ue(s),await xe(s)}catch(e){console.error("Failed to fetch connection companies:",e),C({})}finally{I(!1)}},[]),ue=async e=>{if(!e||0===e.length)return;const t=e.map(async e=>{if(e.guid&&e.tallyloc_id)try{const t=Date.now(),n=await(0,d.Vg)("/api/access-control/user-access?tallylocId=".concat(e.tallyloc_id,"&co_guid=").concat(e.guid,"&ts=").concat(t));if(n&&n.success){const t="user_access_".concat(e.guid,"_").concat(e.tallyloc_id);sessionStorage.setItem(t,JSON.stringify(n.data)),console.log("\u2705 User access cached for company: ".concat(e.company))}}catch(t){console.error("Error fetching user-access for ".concat(e.guid,"_").concat(e.tallyloc_id,":"),t)}});await Promise.all(t)},xe=async e=>{if(!e||0===e.length)return;const t=e.map(async e=>{if(!e.guid||!e.tallyloc_id)return;const t="".concat(e.guid,"_").concat(e.tallyloc_id),n="company_info_".concat(t),s=localStorage.getItem(n);if(s)try{const e=JSON.parse(s),n=Date.now()-(e.timestamp||0);if(n<36e5&&e.data)return void ee(n=>(0,a.A)((0,a.A)({},n),{},{[t]:{data:e.data,loading:!1,error:null,timestamp:e.timestamp}}))}catch(o){console.warn("Failed to parse cached company info:",o)}ee(e=>(0,a.A)((0,a.A)({},e),{},{[t]:(0,a.A)((0,a.A)({},e[t]),{},{loading:!0,error:null})}));try{const s={tallyloc_id:e.tallyloc_id,company:e.company||"",guid:e.guid},r=await(0,d.apiPost)("/api/tally/masterdata/companyinfo",s);if(!r)throw new Error("No data received from API");{const e=Date.now();ee(n=>(0,a.A)((0,a.A)({},n),{},{[t]:{data:r,loading:!1,error:null,timestamp:e}}));try{localStorage.setItem(n,JSON.stringify({data:r,timestamp:e}))}catch(o){console.warn("Failed to cache company info to localStorage:",o)}}}catch(r){console.error("Error fetching company info for ".concat(t,":"),r),ee(e=>(0,a.A)((0,a.A)({},e),{},{[t]:{data:null,loading:!1,error:r.message||"Failed to load company info"}}))}});await Promise.all(t)},fe=e=>{h((0,a.A)((0,a.A)({},x),{},{[e.target.name]:e.target.value})),j(""),w("")},me=async(e,t)=>{try{const n=Date.now();await(0,d.mu)("/api/tally/connections/".concat(e,"?ts=").concat(n),{isActive:t}),await pe(),await ge()}catch(n){_("Failed to update connection status")}},he=e=>{const t=e.connectionName||e.name||e.conn_name||e.ip||"",n=N[t]||[];0!==n.length?(E(e),L(n),P(0),F({}),T(!0),n.forEach((t,n)=>{be(t,e,0===n),ye(t,e)})):_("No companies available for this connection")},be=async function(e,t){const n=e.tallyloc_id||t.tallyloc_id;if(e.guid&&n){F(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:(0,a.A)((0,a.A)({},t[e.guid]),{},{loading:!0,error:null})}));try{const t=Date.now(),s=await(0,d.Vg)("/api/cmpconfig/list?tallyloc_id=".concat(n,"&co_guid=").concat(e.guid,"&ts=").concat(t));console.log("\ud83d\udd0d Company Config API Response:",s),console.log("\ud83d\udd0d Response type:",typeof s),console.log("\ud83d\udd0d Is array:",Array.isArray(s)),console.log("\ud83d\udd0d Has success:",null===s||void 0===s?void 0:s.success),console.log("\ud83d\udd0d Has data:",!(null===s||void 0===s||!s.data)),console.log("\ud83d\udd0d Has configurations:",!(null===s||void 0===s||!s.configurations)),console.log("\ud83d\udd0d Keys:",s?Object.keys(s):"null");let o=[],r=n,i=e.guid,l=e.company;s&&(s.success&&Array.isArray(s.data)?(o=s.data,o.length>0&&o[0].tallyloc_id&&(r=o[0].tallyloc_id),o.length>0&&o[0].co_guid&&(i=o[0].co_guid),o.length>0&&o[0].co_name&&(l=o[0].co_name)):s.success&&s.data&&!Array.isArray(s.data)?(o=s.data.configurations||s.data.configs||[],r=s.data.tallyloc_id||n,i=s.data.co_guid||e.guid,l=s.data.co_name||e.company):Array.isArray(s.data)?o=s.data:s.configurations||s.configs?(o=s.configurations||s.configs||[],r=s.tallyloc_id||n,i=s.co_guid||e.guid,l=s.co_name||e.company):Array.isArray(s)?o=s:(o=s.configurations||s.configs||s.list||[],r=s.tallyloc_id||n,i=s.co_guid||e.guid,l=s.co_name||e.company)),console.log("\ud83d\udd0d Extracted configs:",o),console.log("\ud83d\udd0d Configs count:",o.length),F(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{configs:o,loading:!1,error:null,tallyloc_id:r,co_guid:i,co_name:l}})),je(e.guid,o),Se(e.guid,o)}catch(s){console.error("Error fetching company config:",s),F(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{configs:[],loading:!1,error:s.message||"Failed to load configurations"}}))}}else F(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{configs:[],loading:!1,error:"Missing company or connection information"}}))},ye=async(e,t)=>{const n=e.tallyloc_id||t.tallyloc_id;if(e.guid&&n){$(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:(0,a.A)((0,a.A)({},t[e.guid]),{},{loading:!0,error:null})}));try{const t={tallyloc_id:n,company:e.company||e.co_name||"",guid:e.guid},s=await(0,d.apiPost)("/api/tally/masterdata/bankupi",t);if(!s)throw new Error("No data received from API");$(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{banks:s.banks||[],upis:s.upis||[],bankCount:s.bankCount||0,upiCount:s.upiCount||0,loading:!1,error:null}}))}catch(s){console.error("Error fetching bank/UPI data:",s),$(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{banks:[],upis:[],bankCount:0,upiCount:0,loading:!1,error:s.message||"Failed to load bank/UPI data"}}))}}else $(t=>(0,a.A)((0,a.A)({},t),{},{[e.guid]:{banks:[],upis:[],bankCount:0,upiCount:0,loading:!1,error:"Missing company or connection information"}}))},ve=(e,t,n,s)=>{F(o=>{const r=o[e]||{configs:[]},i=r.configs.map(e=>{if(e.config_id===t||e.id===t){const t=(0,a.A)((0,a.A)({},e),{},{[n]:s});return"permission_value"===n?t.config_value=s:"config_value"===n&&(t.permission_value=s),t}return e});return(0,a.A)((0,a.A)({},o),{},{[e]:(0,a.A)((0,a.A)({},r),{},{configs:i})})})},je=(e,t)=>{const n=t.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase()),s={};if(J.forEach(e=>{s[e]=[]}),n&&n.permission_value_json)try{const e="string"===typeof n.permission_value_json?JSON.parse(n.permission_value_json):n.permission_value_json,t={vouchers:"voucher",ledgerentries:"ledgerentries",billallocations:"billallocations",inventoryentries:"inventoryentries",batchallocations:"batchallocations"};Object.keys(e).forEach(n=>{const a=t[n]||n,o=e[n];if(Array.isArray(o)&&o.length>0){const e=o[0],t={};Object.keys(e).forEach(n=>{const a=e[n];Array.isArray(a)||"string"===typeof a&&(t[n]=a)});const n=Object.keys(t).map(e=>({id:"field_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),fieldName:e,formula:t[e]}));void 0!==s[a]&&(s[a]=n)}})}catch(o){console.log("Could not parse Voucher_udf permission_value_json:",o)}H(t=>(0,a.A)((0,a.A)({},t),{},{[e]:s}))},Se=(e,t)=>{const n=t.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase()),s={};if(J.forEach(e=>{s[e]=[]}),n&&n.permission_value_json)try{const e="string"===typeof n.permission_value_json?JSON.parse(n.permission_value_json):n.permission_value_json,t={vouchers:"voucher",ledgerentries:"ledgerentries",billallocations:"billallocations",inventoryentries:"inventoryentries",batchallocations:"batchallocations"};Object.keys(e).forEach(n=>{const a=t[n]||n,o=e[n];if(Array.isArray(o)&&o.length>0){const e=o[0],t=[];Object.keys(e).forEach(n=>{const a=e[n];if(Array.isArray(a)&&a.length>0){const e=a[0],s=Object.keys(e).map(t=>({id:"field_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),fieldName:t,formula:e[t]}));t.push({id:"array_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),arrayName:n,fields:s})}}),void 0!==s[a]&&(s[a]=t)}})}catch(o){console.log("Could not parse Voucher_udf arrays from permission_value_json:",o)}K(t=>(0,a.A)((0,a.A)({},t),{},{[e]:s}))},we=(0,s.useRef)(new Set),ke=async e=>{if(!e)return null;if(we.current.has(e))return null;try{const t=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const n=await t.json(),a=n.name||n.displayName||n.email||"";return a&&(re(a),we.current.delete(e)),a}return 401===t.status?(we.current.add(e),se(null),null):null}catch(t){return null}},_e=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!R||0===W.length)return;const s=W[B];if(!s)return;const o=M[s.guid];if(!o)return;const r=(0,p.isExternalUser)();if(r&&(n=n||("undefined"!==typeof sessionStorage?sessionStorage.getItem("email"):null),!n))return console.error("External user but no email provided"),void le({type:"error",message:"User email not found. Cannot save configuration."});if(r&&t)try{return await(0,c.Su)(o.tallyloc_id,o.co_guid,t,e,n),await be(s,R,!1),void le({type:"success",message:"Google account linked and saved successfully!"})}catch(f){return console.error("Error saving Link Account configs:",f),void le({type:"error",message:f.message||"Failed to save configurations"})}if(!o.configs)return;const i=o.configs.map(n=>"google_display_name"===n.config_key?(0,a.A)((0,a.A)({},n),{},{permission_value:void 0!==e?e:n.permission_value||""}):"google_token"===n.config_key?(0,a.A)((0,a.A)({},n),{},{permission_value:void 0!==t?t:n.permission_value||""}):n);F(e=>(0,a.A)((0,a.A)({},e),{},{[s.guid]:(0,a.A)((0,a.A)({},o),{},{configs:i})}));try{var l,g,u,x;const e={tallyloc_id:o.tallyloc_id,co_guid:o.co_guid,co_name:o.co_name,configurations:i.map(e=>{const t=e.permission_value||e.config_value||"";return{config_id:e.config_id||e.id,is_enabled:!0===e.is_enabled||1===e.is_enabled,permission_value:t,config_value:t}})};console.log("\ud83d\udcbe Auto-saving Link Account configurations:",{tallyloc_id:e.tallyloc_id,co_guid:e.co_guid,googleToken:null!==(l=i.find(e=>"google_token"===e.config_key))&&void 0!==l&&l.permission_value?"***"+(null===(g=i.find(e=>"google_token"===e.config_key))||void 0===g?void 0:g.permission_value.substring((null===(u=i.find(e=>"google_token"===e.config_key))||void 0===u?void 0:u.permission_value.length)-10)):"not set",googleEmail:(null===(x=i.find(e=>"google_email"===e.config_key))||void 0===x?void 0:x.permission_value)||"not set"});const t=await(0,d.apiPost)("/api/cmpconfig/update",e);t&&t.success&&(await be(s,R,!1),le({type:"success",message:"Google account linked and saved successfully!"}))}catch(f){console.error("Error saving Link Account configs:",f),le({type:"error",message:"Failed to save configurations"})}},Ne=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(ce(!0),le(null),!(0,l.isGoogleDriveFullyConfigured)().configured)return le({type:"error",message:"Google API credentials are not configured. Please configure REACT_APP_GOOGLE_CLIENT_ID and REACT_APP_GOOGLE_API_KEY in your environment variables."}),void ce(!1);await new Promise((e,t)=>{if(window.google&&window.google.accounts)return void e();const n=document.createElement("script");n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n.onload=()=>{setTimeout(()=>{window.google&&window.google.accounts?e():t(new Error("Google Identity Services failed to load"))},100)},n.onerror=()=>t(new Error("Failed to load Google Identity Services")),document.body.appendChild(n)});const t=window.google.accounts.oauth2.initTokenClient({client_id:l.GOOGLE_DRIVE_CONFIG.CLIENT_ID,scope:l.GOOGLE_DRIVE_CONFIG.SCOPES,callback:async e=>{if(ce(!1),e.error){let t=e.error_description||e.error||"Authentication failed";if("redirect_uri_mismatch"===e.error||t.includes("redirect_uri_mismatch")){const e=window.location.origin;t='Redirect URI mismatch. Please add "'.concat(e,'" to Authorized JavaScript origins and Authorized redirect URIs in your Google Cloud Console OAuth 2.0 Client settings.')}return void le({type:"error",message:t})}if(e.access_token){se(e.access_token),localStorage.setItem("google_access_token",e.access_token),localStorage.setItem("google_access_token_timestamp",Date.now().toString());const n=await ke(e.access_token);re(n);const s=(0,p.isExternalUser)();if(s)try{const t=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:"Bearer ".concat(e.access_token)}});if(t.ok){const e=(await t.json()).email,n=sessionStorage.getItem("email");if(e&&n&&e.toLowerCase()!==n.toLowerCase())return le({type:"error",message:"Email mismatch. Please sign in with your registered email: ".concat(n,". You signed in with: ").concat(e)}),void ce(!1)}}catch(t){return console.error("Error verifying email:",t),le({type:"error",message:"Failed to verify Google account email"}),void ce(!1)}const o=s?sessionStorage.getItem("email"):null;await _e(n,e.access_token,o);const r=W[B];r&&F(t=>{const s=(0,a.A)({},t);return s[r.guid]&&s[r.guid].configs&&(s[r.guid]=(0,a.A)((0,a.A)({},s[r.guid]),{},{configs:s[r.guid].configs.map(t=>"google_display_name"===t.config_key?(0,a.A)((0,a.A)({},t),{},{permission_value:n||""}):"google_token"===t.config_key?(0,a.A)((0,a.A)({},t),{},{permission_value:e.access_token}):t)})),s}),le({type:"success",message:"Google account connected successfully!"})}}}),n=localStorage.getItem("google_access_token"),s=e?"consent":n?"":"consent";t.requestAccessToken({prompt:s})}catch(t){ce(!1),le({type:"error",message:t.message||"Failed to initialize Google authentication"})}};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes slideUp {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        .tallyconfig-desktop-table {\n          overflow-x: hidden !important;\n          width: 100% !important;\n          max-width: 100% !important;\n          box-sizing: border-box !important;\n        }\n        .tallyconfig-desktop-table table {\n          table-layout: fixed !important;\n          width: 100% !important;\n        }\n        .tallyconfig-desktop-table th,\n        .tallyconfig-desktop-table td {\n          overflow: hidden !important;\n          text-overflow: ellipsis !important;\n        }\n        @media (max-width: 700px) {\n          body, html, #root, .adminhome-container {\n            max-width: 100vw !important;\n            overflow-x: hidden !important;\n          }\n          .tallyconfig-mobile-form {\n            flex-direction: column !important;\n            gap: 16px !important;\n            align-items: stretch !important;\n            max-width: 100% !important;\n            box-sizing: border-box !important;\n          }\n          .tallyconfig-mobile-form > div {\n            min-width: 0 !important;\n            width: 100% !important;\n            max-width: 100% !important;\n            margin-right: 0 !important;\n            margin-bottom: 0 !important;\n            box-sizing: border-box !important;\n            display: block !important;\n            flex: 1 1 100% !important;\n          }\n          .tallyconfig-mobile-form button {\n            width: 100% !important;\n            min-width: 0 !important;\n            max-width: 100% !important;\n            margin-right: 0 !important;\n            margin-bottom: 0 !important;\n            box-sizing: border-box !important;\n            flex: 1 1 100% !important;\n          }\n          .tallyconfig-mobile-form input,\n          .tallyconfig-mobile-form select {\n            width: 100% !important;\n            min-width: 0 !important;\n            font-size: 16px !important;\n            padding: 14px 16px !important;\n            box-sizing: border-box !important;\n          }\n          .tallyconfig-mobile-form label {\n            margin-bottom: 8px !important;\n            font-size: 14px !important;\n          }\n          .tallyconfig-mobile-table, .tallyconfig-mobile-stacked-table {\n            padding: 16px !important;\n            min-width: 0 !important;\n            width: 100% !important;\n            max-width: 100% !important;\n            box-sizing: border-box !important;\n            overflow-x: hidden !important;\n          }\n          .tallyconfig-mobile-table table, .tallyconfig-mobile-stacked-table table {\n            width: 100% !important;\n            min-width: 0 !important;\n            font-size: 13px !important;\n            table-layout: fixed !important;\n          }\n          .tallyconfig-mobile-table th, .tallyconfig-mobile-table td,\n          .tallyconfig-mobile-stacked-table th, .tallyconfig-mobile-stacked-table td {\n            padding: 6px 2px !important;\n            font-size: 13px !important;\n            word-break: break-word !important;\n            max-width: 80px !important;\n            overflow: hidden !important;\n            text-overflow: ellipsis !important;\n          }\n          .tallyconfig-mobile-stacked-table th {\n            white-space: normal !important;\n            word-break: break-word !important;\n            line-height: 1.2 !important;\n          }\n          .tallyconfig-mobile-stacked-table td {\n            max-width: 90px !important;\n          }\n        }\n      "}),(0,u.jsxs)("div",{style:{margin:"0 auto",padding:n?"12px":0,paddingTop:n?"72px":0,width:n?"100%":"90vw",maxWidth:1200,boxSizing:"border-box"},children:[(0,u.jsxs)("div",{style:{display:"flex",flexDirection:n?"column":"row",alignItems:n?"flex-start":"center",justifyContent:"space-between",marginBottom:n?20:32,marginTop:n?0:50,gap:n?16:0},children:[(0,u.jsxs)("div",{style:{width:n?"100%":"auto"},children:[(0,u.jsxs)("h2",{style:{color:"#1e40af",fontWeight:700,fontSize:n?20:28,margin:0,display:"flex",alignItems:"center",gap:n?8:12,flexWrap:"wrap"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?24:32,color:"#1e40af"},children:"settings"}),(0,u.jsx)("span",{children:"Tally Access Settings"})]}),(0,u.jsx)("div",{style:{color:"#64748b",fontSize:n?13:16,marginTop:4},children:"Manage Tally Server Connection"})]}),(0,u.jsxs)("div",{style:{background:"#f0f9ff",color:"#0369a1",padding:n?"8px 14px":"8px 16px",borderRadius:20,fontSize:n?12:14,fontWeight:600,display:"flex",alignItems:"center",gap:8,width:n?"100%":"auto",justifyContent:n?"center":"flex-start",marginTop:n?4:0},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?16:18},children:"account_tree"}),o.length," connections configured"]})]}),(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:n?16:32,marginBottom:n?20:24,width:"100%",margin:"0 auto",boxSizing:"border-box"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:n?20:24,paddingBottom:n?12:16,borderBottom:"1px solid #f1f5f9"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?20:24,color:"#3b82f6"},children:"add_circle"}),(0,u.jsx)("h3",{style:{color:"#1e293b",fontWeight:700,margin:0,fontSize:n?18:20},children:"Create New Connection"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),y(!0),j(""),w("");try{const e=Date.now(),t=await(0,d.apiPost)("/api/tally/check-connection?ts=".concat(e),{ip:x.ip,port:x.port,connectionName:x.connectionName,accessType:x.accessType});if(t&&t.success)w(t.message||"Tally connection successful and saved"),h({ip:"",port:"",connectionName:"",accessType:"Tally"}),await pe(),await ge();else if(t)throw new Error(t.message||"Tally connection failed")}catch(t){j(t.message)}finally{y(!1)}},className:"tallyconfig-mobile-form",style:{display:"flex",flexDirection:n?"column":"row",gap:16,alignItems:n?"stretch":"flex-end",width:"100%"},children:[(0,u.jsxs)("div",{style:{flex:n?"1 1 100%":"0.6",minWidth:n?"100%":200,width:n?"100%":"auto",marginRight:n?0:2},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:8,display:"block",fontSize:n?14:16},children:"Tally Access Type"}),(0,u.jsx)("select",{name:"accessType",value:x.accessType,onChange:()=>{},disabled:!0,style:{padding:n?"14px 16px":"12px 14px",borderRadius:8,border:"1.5px solid #cbd5e1",width:"100%",fontSize:16,background:"#f1f5f9",marginBottom:0,cursor:"not-allowed",opacity:.8,boxSizing:"border-box",WebkitAppearance:"none",appearance:"none"},children:(0,u.jsx)("option",{value:"Tally",children:"Tally"})})]}),(0,u.jsxs)("div",{style:{flex:n?"1 1 100%":"0.6",minWidth:n?"100%":180,width:n?"100%":"auto",marginRight:n?0:12},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:8,display:"block",fontSize:n?14:16},children:"Site ID"}),(0,u.jsx)("input",{name:"connectionName",value:x.connectionName,onChange:fe,required:!0,style:{padding:n?"14px 16px":"12px 14px",borderRadius:8,border:"1.5px solid #cbd5e1",width:"100%",fontSize:16,background:"#f8fafc",marginBottom:0,boxSizing:"border-box"},placeholder:"Myoffice"})]}),(0,u.jsxs)("div",{style:{flex:n?"1 1 100%":"0.8",minWidth:n?"100%":300,width:n?"100%":"auto",marginRight:n?0:12},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"TallyDex"===x.accessType?"#94a3b8":"#1e293b",marginBottom:8,display:"block",fontSize:n?14:16},children:"IP Address or Hostname"}),(0,u.jsx)("input",{name:"ip",value:x.ip,onChange:fe,required:"TallyDex"!==x.accessType,disabled:"TallyDex"===x.accessType,style:{padding:n?"14px 16px":"12px 14px",borderRadius:8,border:"1.5px solid #cbd5e1",width:"100%",fontSize:16,background:"TallyDex"===x.accessType?"#f1f5f9":"#f8fafc",marginBottom:0,opacity:"TallyDex"===x.accessType?.6:1,cursor:"TallyDex"===x.accessType?"not-allowed":"text",boxSizing:"border-box"},placeholder:"TallyDex"===x.accessType?"Not required for TallyDex":"192.168.1.100 or example.com"})]}),(0,u.jsxs)("div",{style:{flex:n?"1 1 100%":"0.4",minWidth:n?"100%":90,width:n?"100%":"auto",marginRight:n?0:12},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"TallyDex"===x.accessType?"#94a3b8":"#1e293b",marginBottom:8,display:"block",fontSize:n?14:16},children:"Port"}),(0,u.jsx)("input",{name:"port",value:x.port,onChange:fe,required:!1,disabled:"TallyDex"===x.accessType,style:{padding:n?"14px 16px":"12px 14px",borderRadius:8,border:"1.5px solid #cbd5e1",width:"100%",fontSize:16,background:"TallyDex"===x.accessType?"#f1f5f9":"#f8fafc",marginBottom:0,opacity:"TallyDex"===x.accessType?.6:1,cursor:"TallyDex"===x.accessType?"not-allowed":"text",boxSizing:"border-box"},placeholder:"TallyDex"===x.accessType?"Not required":"9009"})]}),(0,u.jsxs)("button",{type:"submit",disabled:b,style:{padding:n?"16px 24px":"14px 24px",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:16,minWidth:n?"100%":140,width:n?"100%":"auto",cursor:"pointer",opacity:b?.7:1,boxShadow:"0 2px 8px 0 rgba(59,130,246,0.20)",whiteSpace:"nowrap",transition:"transform 0.2s, box-shadow 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:8,minHeight:n?48:"auto",boxSizing:"border-box"},onMouseEnter:e=>{b||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px 0 rgba(59,130,246,0.30)")},onMouseLeave:e=>{b||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 8px 0 rgba(59,130,246,0.20)")},onTouchStart:e=>{b||(e.currentTarget.style.transform="scale(0.98)",e.currentTarget.style.opacity="0.9")},onTouchEnd:e=>{b||(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.opacity="1")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?20:18},children:b?"sync":"add"}),b?"Creating...":"Create Connection"]})]}),v&&(0,u.jsxs)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:n?14:16,marginTop:n?14:16,display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#dc2626",fontSize:n?18:20,flexShrink:0},children:"error"}),(0,u.jsx)("div",{style:{color:"#dc2626",fontSize:n?13:14,fontWeight:500,lineHeight:1.5},children:v})]}),S&&(0,u.jsxs)("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:n?14:16,marginTop:n?14:16,display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#16a34a",fontSize:n?18:20,flexShrink:0},children:"check_circle"}),(0,u.jsx)("div",{style:{color:"#16a34a",fontSize:n?13:14,fontWeight:500,lineHeight:1.5},children:S})]}),("TallyDex"===x.accessType||"Tally+TallyDex"===x.accessType)&&(0,u.jsxs)("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:n?14:16,marginTop:n?14:16,display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#16a34a",fontSize:n?18:20,flexShrink:0},children:"info"}),(0,u.jsxs)("div",{style:{color:"#16a34a",fontSize:n?13:14,fontWeight:500,lineHeight:1.5},children:[(0,u.jsx)("strong",{children:"Note:"})," TallyDex data will be stored in MySQLDB"]})]})]}),(0,u.jsx)("div",{style:{height:n?20:32}}),(0,u.jsxs)("div",{className:"tallyconfig-mobile-table",style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:n?16:32,marginTop:0,width:"100%",margin:"0 auto",minHeight:n?"auto":360,boxSizing:"border-box",overflowX:"hidden",maxWidth:"100%"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:n?16:24,paddingBottom:n?12:16,borderBottom:"1px solid #f1f5f9"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?20:24,color:"#3b82f6"},children:"list_alt"}),(0,u.jsx)("h3",{style:{color:"#1e293b",fontWeight:700,margin:0,fontSize:n?18:20},children:"Tally Connections"})]}),i&&(0,u.jsxs)("div",{style:{textAlign:"center",padding:n?40:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:n?"12px 0":"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?40:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:n?14:16,fontWeight:500},children:"Loading connections..."})]}),k&&(0,u.jsxs)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:n?14:20,marginBottom:16,display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#dc2626",fontSize:n?20:24,flexShrink:0},children:"error"}),(0,u.jsx)("div",{style:{color:"#dc2626",fontSize:n?13:14,fontWeight:500,lineHeight:1.5},children:k})]}),!i&&0===o.length&&!k&&(0,u.jsxs)("div",{style:{textAlign:"center",padding:n?40:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:n?"12px 0":"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:n?48:64,color:"#cbd5e1",marginBottom:16,display:"block"},children:"account_tree"}),(0,u.jsx)("div",{style:{fontSize:n?16:18,fontWeight:600,marginBottom:8},children:"No connections found"}),(0,u.jsx)("div",{style:{fontSize:n?13:14},children:"Create your first connection above to get started"})]}),!i&&o.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"tallyconfig-desktop-table",style:{display:n?"none":"block",overflowX:"hidden",width:"100%",boxSizing:"border-box"},children:(0,u.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14,tableLayout:"fixed"},children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"},children:[(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"12%"},children:"Site ID"}),(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"28%"},children:"IP Address"}),(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"8%"},children:"Port"}),(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"12%"},children:"Access Type"}),(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"20%"},children:"Status"}),(0,u.jsx)("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1e293b",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0",width:"20%"},children:"Actions"})]})}),(0,u.jsx)("tbody",{children:o.map((e,t)=>{const n=e.connectionName||e.name||e.conn_name||e.ip||"",a=N[n]||[];return(0,u.jsxs)("tr",{style:{borderBottom:"1px solid #f1f5f9",height:"auto",minHeight:"60px",background:t%2===0?"#fff":"#f8fafc",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="#f0f9ff",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px 0 rgba(59,130,246,0.10)"},onMouseLeave:e=>{e.target.style.background=t%2===0?"#fff":"#f8fafc",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,u.jsx)("td",{style:{padding:"10px 12px",fontWeight:600,color:"#1e293b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"top"},children:e.name}),(0,u.jsxs)("td",{style:{padding:"10px 12px",color:"#64748b",overflow:"hidden",verticalAlign:"top"},children:[(0,u.jsx)("div",{style:{fontFamily:"monospace",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.ip}),(0,u.jsx)("div",{style:{fontSize:12,color:"#475569",display:"flex",alignItems:"flex-start",flexWrap:"wrap",gap:6,width:"100%",maxWidth:"100%",lineHeight:1.5},title:a.length>0?a.map(e=>"".concat(e.company).concat(e.accessType?" (".concat(e.accessType,")"):"")).join(", "):z?"Checking companies\u2026":"No active companies",children:z?(0,u.jsx)("span",{style:{color:"#94a3b8"},children:"Checking companies\u2026"}):a.length>0?(0,u.jsx)(u.Fragment,{children:a.map((e,t)=>(0,u.jsxs)(s.Fragment,{children:[t>0&&(0,u.jsx)("span",{style:{color:"#cbd5f5",marginRight:2},children:"\u2022"}),(0,u.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4,flexShrink:0},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:12,color:"#3b82f6"},children:"apartment"}),(0,u.jsx)("span",{style:{color:"#0f172a",fontWeight:600,wordBreak:"break-word"},children:e.company})]})]},e.guid))}):(0,u.jsx)("span",{style:{color:"#94a3b8"},children:"No active companies"})})]}),(0,u.jsx)("td",{style:{padding:"10px 12px",color:"#64748b",fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"top"},children:e.port}),(0,u.jsx)("td",{style:{padding:"10px 12px",overflow:"hidden",verticalAlign:"top"},children:(0,u.jsx)("span",{style:{padding:"3px 6px",borderRadius:"8px",fontSize:"12px",fontWeight:600,background:"#e0f2fe",color:"#0c4a6e",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:e.accessType||"Tally"})}),(0,u.jsx)("td",{style:{padding:"10px 12px",overflow:"hidden",verticalAlign:"top"},children:(0,u.jsx)("span",{style:{padding:"3px 6px",borderRadius:"8px",fontSize:"12px",fontWeight:600,background:"active"===e.status?"#dcfce7":"pending"===e.status?"#fef3c7":"rejected"===e.status?"#fef2f2":"approved"===e.status?"#dcfce7":"#f1f5f9",color:"active"===e.status?"#166534":"pending"===e.status?"#92400e":"rejected"===e.status?"#dc2626":"approved"===e.status?"#166534":"#64748b",display:"inline-block",maxWidth:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:e.statusMessage||e.status,children:e.statusMessage||e.status})}),(0,u.jsx)("td",{style:{padding:"10px 12px",verticalAlign:"top",overflow:"hidden"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:"active"===e.status||"approved"===e.status||"inactive"===e.status?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{onClick:()=>me(e.id,!e.isActive),style:{borderRadius:"50%",border:"none",fontSize:"32px",cursor:"pointer",background:"transparent",color:e.isActive?"#3b82f6":"#64748b",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",width:48,height:48},title:e.isActive?"Deactivate":"Activate",onMouseEnter:t=>{t.target.style.transform="scale(1.1)",t.target.style.color=e.isActive?"#1e40af":"#3b82f6"},onMouseLeave:t=>{t.target.style.transform="scale(1)",t.target.style.color=e.isActive?"#3b82f6":"#64748b"},children:(0,u.jsx)("span",{className:"material-icons",children:e.isActive?"toggle_on":"toggle_off"})}),a.length>0&&(0,u.jsxs)("button",{onClick:()=>he(e),style:{background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",padding:"8px 12px",cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s",color:"#0369a1",fontSize:"13px",fontWeight:600},title:"Configure company settings",onMouseEnter:e=>{e.target.style.background="#0ea5e9",e.target.style.color="#fff"},onMouseLeave:e=>{e.target.style.background="#f0f9ff",e.target.style.color="#0369a1"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px"},children:"settings"}),"Configurations"]})]}):(0,u.jsx)("span",{style:{color:"#94a3b8",fontSize:"14px",fontWeight:500,display:"inline-block",lineHeight:"48px",height:"48px"},children:"pending"===e.status?"Pending":"rejected"===e.status?"Rejected":"Inactive"})})})]},e.id)})})]})}),(0,u.jsx)("div",{style:{display:n?"block":"none",width:"100%"},children:(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:o.map(e=>{const t=e.connectionName||e.name||e.conn_name||e.ip||"",n=N[t]||[],a=e.isActive,o=e.status||(a?"active":"inactive");return(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px 0 rgba(31,38,135,0.08)",padding:16,border:"1px solid #f1f5f9",transition:"all 0.2s ease",WebkitTapHighlightColor:"transparent"},onTouchStart:e=>{e.currentTarget.style.transform="scale(0.99)",e.currentTarget.style.boxShadow="0 4px 16px 0 rgba(31,38,135,0.12)"},onTouchEnd:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 12px 0 rgba(31,38,135,0.08)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16,gap:12},children:[(0,u.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,u.jsx)("div",{style:{fontWeight:700,fontSize:16,color:"#1e293b",marginBottom:6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:1.3},children:e.name}),(0,u.jsx)("div",{style:{fontSize:12,color:"#64748b",fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:1.4},children:e.ip})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flexShrink:0},children:[(0,u.jsxs)("span",{style:{padding:"8px 12px",borderRadius:"16px",fontSize:"12px",fontWeight:600,background:"active"===o||"approved"===o?"#dcfce7":"pending"===o?"#fef3c7":"rejected"===o?"#fef2f2":"#f1f5f9",color:"active"===o||"approved"===o?"#166534":"pending"===o?"#92400e":"rejected"===o?"#dc2626":"#64748b",display:"flex",alignItems:"center",gap:5,whiteSpace:"nowrap",boxShadow:"active"===o||"approved"===o?"0 1px 3px rgba(22, 101, 52, 0.2)":"none"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"active"===o||"approved"===o?"check_circle":"rejected"===o?"cancel":"help_outline"}),(0,u.jsx)("span",{style:{maxWidth:"80px",overflow:"hidden",textOverflow:"ellipsis"},children:e.statusMessage||o})]}),(0,u.jsx)("button",{onClick:()=>me(e.id,!e.isActive),style:{borderRadius:"50%",border:"none",fontSize:"36px",cursor:"pointer",background:"transparent",color:e.isActive?"#3b82f6":"#64748b",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",width:44,height:44,padding:0,minWidth:44,minHeight:44},title:e.isActive?"Deactivate":"Activate",onTouchStart:e=>{e.currentTarget.style.transform="scale(0.85)",e.currentTarget.style.opacity="0.8"},onTouchEnd:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.opacity="1"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32},children:e.isActive?"toggle_on":"toggle_off"})})]})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:14,padding:"14px 0",borderTop:"1px solid #f1f5f9"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16},children:[(0,u.jsxs)("div",{style:{flex:1,minWidth:"120px"},children:[(0,u.jsxs)("div",{style:{fontSize:11,color:"#64748b",fontWeight:600,marginBottom:6,textTransform:"uppercase",letterSpacing:"0.5px",display:"flex",alignItems:"center",gap:4},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#94a3b8"},children:"dns"}),"Port"]}),(0,u.jsx)("div",{style:{fontSize:14,color:"#475569",fontFamily:"monospace",fontWeight:600,padding:"6px 10px",background:"#f8fafc",borderRadius:8,display:"inline-block",border:"1px solid #e2e8f0"},children:e.port||"N/A"})]}),(0,u.jsxs)("div",{style:{flex:1,minWidth:"120px"},children:[(0,u.jsxs)("div",{style:{fontSize:11,color:"#64748b",fontWeight:600,marginBottom:6,textTransform:"uppercase",letterSpacing:"0.5px",display:"flex",alignItems:"center",gap:4},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#94a3b8"},children:"category"}),"Access Type"]}),(0,u.jsx)("span",{style:{padding:"6px 12px",borderRadius:"10px",fontSize:"12px",fontWeight:600,background:"linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%)",color:"#0c4a6e",display:"inline-block",border:"1px solid #7dd3fc",boxShadow:"0 1px 3px rgba(14, 165, 233, 0.2)"},children:e.accessType||"Tally"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{fontSize:11,color:"#64748b",fontWeight:600,marginBottom:8,textTransform:"uppercase",letterSpacing:"0.5px",display:"flex",alignItems:"center",gap:4},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#94a3b8"},children:"apartment"}),"Companies ",n.length>0&&"(".concat(n.length,")")]}),(0,u.jsx)("div",{style:{fontSize:12,color:"#475569",display:"flex",flexWrap:"wrap",alignItems:"center",gap:8,minHeight:24},children:z?(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,color:"#94a3b8",padding:"6px 12px",background:"#f8fafc",borderRadius:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,animation:"spin 1s linear infinite"},children:"sync"}),(0,u.jsx)("span",{children:"Checking companies\u2026"})]}):n.length>0?(0,u.jsx)(u.Fragment,{children:n.map((e,t)=>(0,u.jsx)(s.Fragment,{children:(0,u.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"6px 12px",borderRadius:"10px",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",border:"1px solid #bae6fd",boxShadow:"0 1px 3px rgba(14, 165, 233, 0.15)",maxWidth:"100%",boxSizing:"border-box"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#3b82f6",flexShrink:0},children:"apartment"}),(0,u.jsx)("span",{style:{color:"#0f172a",fontWeight:600,fontSize:12,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:e.company})]})},e.guid))}):(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,color:"#94a3b8",padding:"8px 12px",background:"#f8fafc",borderRadius:8,fontSize:12,fontStyle:"italic"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"info"}),(0,u.jsx)("span",{children:"No active companies"})]})})]}),("active"===e.status||"approved"===e.status||"inactive"===e.status)&&n.length>0&&(0,u.jsx)("div",{style:{marginTop:4},children:(0,u.jsxs)("button",{onClick:()=>he(e),style:{background:"linear-gradient(135deg, #F27020 0%, #ea580c 100%)",border:"none",borderRadius:"12px",padding:"14px 18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8,transition:"all 0.2s",color:"#fff",fontSize:"14px",fontWeight:600,width:"100%",WebkitTapHighlightColor:"transparent",boxShadow:"0 2px 8px rgba(242, 112, 32, 0.3)",minHeight:48},title:"Configure company settings",onTouchStart:e=>{e.currentTarget.style.transform="scale(0.97)",e.currentTarget.style.opacity="0.9",e.currentTarget.style.boxShadow="0 1px 4px rgba(242, 112, 32, 0.4)"},onTouchEnd:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.opacity="1",e.currentTarget.style.boxShadow="0 2px 8px rgba(242, 112, 32, 0.3)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px"},children:"settings"}),(0,u.jsx)("span",{children:"Configure Company Settings"})]})})]})]},e.id)})})})]})]})]}),A&&R&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:20},onClick:e=>{e.target===e.currentTarget&&T(!1)},children:(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 20px 40px 0 rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"900px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column",margin:"0 20px"},onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{style:{padding:"24px 28px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(90deg, #1e40af 0%, #3b82f6 100%)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)"},children:[(0,u.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",gap:16},children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h3",{style:{margin:0,fontSize:24,fontWeight:700,color:"#fff",display:"flex",alignItems:"center",gap:12,textShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:28},children:"tune"}),"Company Configurations"]}),(0,u.jsxs)("div",{style:{fontSize:14,color:"rgba(255, 255, 255, 0.9)",marginTop:6,display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"cloud"}),R.name||R.connectionName||"Connection"]})]}),W.length>0&&(0,u.jsx)("select",{value:B,onChange:e=>P(Number(e.target.value)),style:{padding:"10px 40px 10px 16px",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"10px",background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(10px)",color:"#fff",fontSize:15,fontWeight:600,cursor:"pointer",outline:"none",minWidth:"220px",maxWidth:"300px",appearance:"none",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%23ffffff' d='M8 11L3 6h10z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 14px center",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.25)",e.target.style.borderColor="rgba(255, 255, 255, 0.4)",e.target.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.15)",e.target.style.borderColor="rgba(255, 255, 255, 0.3)",e.target.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"},onFocus:e=>{e.target.style.background="rgba(255, 255, 255, 0.25)",e.target.style.borderColor="rgba(255, 255, 255, 0.5)",e.target.style.boxShadow="0 0 0 3px rgba(255, 255, 255, 0.2)"},onBlur:e=>{e.target.style.background="rgba(255, 255, 255, 0.15)",e.target.style.borderColor="rgba(255, 255, 255, 0.3)",e.target.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"},children:W.map((e,t)=>(0,u.jsx)("option",{value:t,style:{color:"#1e293b",background:"#fff",padding:"8px"},children:e.company},e.guid))})]}),(0,u.jsx)("button",{onClick:()=>T(!1),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",fontSize:24,color:"#fff",cursor:"pointer",padding:8,borderRadius:8,transition:"all 0.2s",width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.3)",e.target.style.transform="rotate(90deg)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.2)",e.target.style.transform="rotate(0deg)"},children:"\xd7"})]}),(0,u.jsx)("div",{style:{padding:"28px",overflowY:"auto",flex:1,minHeight:0,boxSizing:"border-box",background:"linear-gradient(to bottom, #f8fafc 0%, #ffffff 100%)"},children:W.length>0&&(()=>{const e=W[B],t=M[null===e||void 0===e?void 0:e.guid]||{};if(t.loading)return(0,u.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500},children:"Loading configurations..."})]});if(t.error)return(0,u.jsxs)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:20,display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#dc2626",fontSize:24},children:"error"}),(0,u.jsx)("div",{style:{color:"#dc2626",fontSize:14,fontWeight:500},children:t.error})]});if(!t.configs||0===t.configs.length)return(0,u.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:64,color:"#cbd5e1",marginBottom:16,display:"block"},children:"settings"}),(0,u.jsx)("div",{style:{fontSize:18,fontWeight:600,marginBottom:8},children:"No configurations available"}),(0,u.jsx)("div",{style:{fontSize:14},children:"Configurations will appear here once they are set up"})]});const n={};t.configs.forEach(e=>{const t=e.parent_name||"Other";n[t]||(n[t]={parentName:t,parentSortOrder:e.parent_sort_order||999,configs:[]}),n[t].configs.push(e)}),Object.keys(n).forEach(e=>{n[e].configs.sort((e,t)=>(e.sort_order||999)-(t.sort_order||999))});const s=Object.values(n).sort((e,t)=>e.parentSortOrder-t.parentSortOrder);return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"28px",padding:"8px 0"},children:s.map(t=>(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",background:"#fff",borderRadius:16,padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",border:"1px solid #e2e8f0",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.1)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.06)",e.currentTarget.style.transform="translateY(0)"},children:[(0,u.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"#1e293b",marginBottom:4,paddingBottom:12,borderBottom:"2px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,background:"linear-gradient(135deg, #1e40af15 0%, #3b82f615 100%)",padding:"8px 14px",borderRadius:10},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22,color:"#1e40af"},children:"folder"}),(0,u.jsx)("span",{children:t.parentName})]}),"Link Account"===t.parentName&&(0,u.jsxs)("button",{type:"button",onClick:()=>{ne(!0);const e=localStorage.getItem("google_access_token");e&&(se(e),ke(e))},style:{padding:"8px 16px",fontSize:13,fontWeight:600,color:"#fff",background:"linear-gradient(135deg, #F27020 0%, #ea580c 100%)",border:"none",borderRadius:8,cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px rgba(242, 112, 32, 0.3)"},onMouseEnter:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 12px rgba(242, 112, 32, 0.4)"},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 8px rgba(242, 112, 32, 0.3)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"link"}),"Action"]})]}),t.configs.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase())?(0,u.jsx)(m,{companyGuid:e.guid,companyFields:G[e.guid]||{},companyArrays:X[e.guid]||{},activeTable:q,onTableChange:V,onAddField:t=>((e,t)=>{H(n=>{const s=n[e]||{},o=s[t]||[],r={id:"field_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),fieldName:"",formula:""};return(0,a.A)((0,a.A)({},n),{},{[e]:(0,a.A)((0,a.A)({},s),{},{[t]:[...o,r]})})})})(e.guid,t),onRemoveField:(t,n)=>((e,t,n)=>{H(s=>{const o=s[e]||{},r=o[t]||[];return(0,a.A)((0,a.A)({},s),{},{[e]:(0,a.A)((0,a.A)({},o),{},{[t]:r.filter(e=>e.id!==n)})})})})(e.guid,t,n),onUpdateField:(t,n,s,o)=>((e,t,n,s,o)=>{H(r=>{const i=r[e]||{},l=i[t]||[];return(0,a.A)((0,a.A)({},r),{},{[e]:(0,a.A)((0,a.A)({},i),{},{[t]:l.map(e=>e.id===n?(0,a.A)((0,a.A)({},e),{},{[s]:o}):e)})})})})(e.guid,t,n,s,o),onAddArray:t=>((e,t)=>{K(n=>{const s=n[e]||{},o=s[t]||[],r={id:"array_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),arrayName:"",fields:[]};return(0,a.A)((0,a.A)({},n),{},{[e]:(0,a.A)((0,a.A)({},s),{},{[t]:[...o,r]})})})})(e.guid,t),onRemoveArray:(t,n)=>((e,t,n)=>{K(s=>{const o=s[e]||{},r=o[t]||[];return(0,a.A)((0,a.A)({},s),{},{[e]:(0,a.A)((0,a.A)({},o),{},{[t]:r.filter(e=>e.id!==n)})})})})(e.guid,t,n),onUpdateArray:(t,n,s,o)=>((e,t,n,s,o)=>{K(r=>{const i=r[e]||{},l=i[t]||[];return(0,a.A)((0,a.A)({},r),{},{[e]:(0,a.A)((0,a.A)({},i),{},{[t]:l.map(e=>e.id===n?(0,a.A)((0,a.A)({},e),{},{[s]:o}):e)})})})})(e.guid,t,n,s,o),onAddArrayField:(t,n)=>((e,t,n)=>{K(s=>{const o=s[e]||{},r=o[t]||[];return(0,a.A)((0,a.A)({},s),{},{[e]:(0,a.A)((0,a.A)({},o),{},{[t]:r.map(e=>{if(e.id===n){const t={id:"field_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),fieldName:"",formula:""};return(0,a.A)((0,a.A)({},e),{},{fields:[...e.fields||[],t]})}return e})})})})})(e.guid,t,n),onRemoveArrayField:(t,n,s)=>((e,t,n,s)=>{K(o=>{const r=o[e]||{},i=r[t]||[];return(0,a.A)((0,a.A)({},o),{},{[e]:(0,a.A)((0,a.A)({},r),{},{[t]:i.map(e=>e.id===n?(0,a.A)((0,a.A)({},e),{},{fields:(e.fields||[]).filter(e=>e.id!==s)}):e)})})})})(e.guid,t,n,s),onUpdateArrayField:(t,n,s,o,r)=>((e,t,n,s,o,r)=>{K(i=>{const l=i[e]||{},d=l[t]||[];return(0,a.A)((0,a.A)({},i),{},{[e]:(0,a.A)((0,a.A)({},l),{},{[t]:d.map(e=>e.id===n?(0,a.A)((0,a.A)({},e),{},{fields:(e.fields||[]).map(e=>e.id===s?(0,a.A)((0,a.A)({},e),{},{[o]:r}):e)}):e)})})})})(e.guid,t,n,s,o,r)}):t.configs.filter(e=>"voucher_udf"!==(e.config_key||"").toLowerCase()).map(n=>{const a=!0===n.is_enabled||1===n.is_enabled,s="Link Account"===t.parentName;return(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"16px 18px",background:a?"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)":"#f8fafc",border:"2px solid ".concat(a?"#0ea5e9":"#e2e8f0"),borderRadius:12,transition:"all 0.3s ease",boxSizing:"border-box",width:"100%",userSelect:"none",position:"relative",overflow:"hidden"},onMouseEnter:e=>{a&&(e.currentTarget.style.borderColor="#0284c7",e.currentTarget.style.boxShadow="0 2px 8px rgba(14, 165, 233, 0.2)")},onMouseLeave:e=>{e.currentTarget.style.borderColor=a?"#0ea5e9":"#e2e8f0",e.currentTarget.style.boxShadow="none"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1,gap:16},children:[(0,u.jsx)("div",{onClick:()=>{const t=!0===n.is_enabled||1===n.is_enabled;ve(e.guid,n.config_id||n.id,"is_enabled",!t)},style:{width:24,height:24,border:"2px solid #d1d5db",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",background:a?"linear-gradient(135deg, #F27020 0%, #ea580c 100%)":"transparent",borderColor:a?"#F27020":"#d1d5db",transition:"all 0.3s ease",flexShrink:0,cursor:"pointer",opacity:1,boxShadow:a?"0 2px 6px rgba(242, 112, 32, 0.3)":"none"},onMouseEnter:e=>{a||(e.target.style.borderColor="#9ca3af",e.target.style.background="#f3f4f6")},onMouseLeave:e=>{a||(e.target.style.borderColor="#d1d5db",e.target.style.background="transparent")},children:a&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#fff",fontWeight:"bold"},children:"check"})}),(0,u.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,u.jsx)("div",{style:{color:a?"#1e40af":"#374151",fontWeight:a?600:500,fontSize:15,lineHeight:1.5,marginBottom:n.config_description||n.description?6:0},children:n.display_name||n.config_name||n.name||"Config ".concat(n.config_id||n.id)}),(n.config_description||n.description)&&(0,u.jsx)("div",{style:{color:"#64748b",fontSize:13,lineHeight:1.4,fontWeight:400},children:n.config_description||n.description})]})]}),a&&(n.config_type||n.permission_type||n.value_type||"bank_details"===(n.config_key||"").toLowerCase()||"upi_details"===(n.config_key||"").toLowerCase())&&(0,u.jsx)("div",{style:{marginLeft:"16px",minWidth:"220px",maxWidth:"300px"},children:(()=>{const t=(n.config_key||"").toLowerCase(),a=Z[null===e||void 0===e?void 0:e.guid];if("bank_details"===t&&a){const t=a.banks||[];return(0,u.jsxs)("select",{value:n.permission_value||n.config_value||n.value||"",onChange:t=>!s&&ve(e.guid,n.config_id||n.id,"permission_value",t.target.value),disabled:s||a.loading,style:{width:"100%",padding:"10px 12px",border:"2px solid ".concat(s?"#e2e8f0":"#d1d5db"),borderRadius:8,fontSize:13,outline:"none",background:s?"#f3f4f6":"#fff",color:s?"#6b7280":"#374151",cursor:s||a.loading?"not-allowed":"pointer",transition:"all 0.2s",fontWeight:500},onFocus:e=>!s&&!a.loading&&(e.target.style.borderColor="#3b82f6"),onBlur:e=>e.target.style.borderColor="#d1d5db",children:[(0,u.jsx)("option",{value:"",children:a.loading?"Loading...":"Select Bank"}),t.map((e,t)=>{const n=e.accountno?"".concat(e.name," - ").concat(e.accountno):e.name,a=e.accountno?"".concat(e.name,"|").concat(e.accountno):e.name;return(0,u.jsx)("option",{value:a,children:n},t)})]})}if("upi_details"===t&&a){const t=a.upis||[];return(0,u.jsxs)("select",{value:n.permission_value||n.config_value||n.value||"",onChange:t=>!s&&ve(e.guid,n.config_id||n.id,"permission_value",t.target.value),disabled:s||a.loading,style:{width:"100%",padding:"10px 12px",border:"2px solid ".concat(s?"#e2e8f0":"#d1d5db"),borderRadius:8,fontSize:13,outline:"none",background:s?"#f3f4f6":"#fff",color:s?"#6b7280":"#374151",cursor:s||a.loading?"not-allowed":"pointer",transition:"all 0.2s",fontWeight:500},onFocus:e=>!s&&!a.loading&&(e.target.style.borderColor="#3b82f6"),onBlur:e=>e.target.style.borderColor="#d1d5db",children:[(0,u.jsx)("option",{value:"",children:a.loading?"Loading...":"Select UPI"}),t.map((e,t)=>{const n=e.merchantid?"".concat(e.name," - ").concat(e.merchantid):e.name,a=e.merchantid?"".concat(e.name,"|").concat(e.merchantid):e.name;return(0,u.jsx)("option",{value:a,children:n},t)})]})}return"select"===n.config_type||"select"===n.permission_type||"select"===n.value_type?(0,u.jsxs)("select",{value:n.permission_value||n.config_value||n.value||"",onChange:t=>!s&&ve(e.guid,n.config_id||n.id,"permission_value",t.target.value),disabled:s,style:{width:"100%",padding:"10px 12px",border:"2px solid ".concat(s?"#e2e8f0":"#d1d5db"),borderRadius:8,fontSize:13,outline:"none",background:s?"#f3f4f6":"#fff",color:s?"#6b7280":"#374151",cursor:s?"not-allowed":"pointer",transition:"all 0.2s",fontWeight:500},onFocus:e=>!s&&(e.target.style.borderColor="#3b82f6"),onBlur:e=>e.target.style.borderColor="#d1d5db",children:[(0,u.jsx)("option",{value:"",children:"Select option"}),(n.config_options||n.permission_options||n.options||[])&&(n.config_options||n.permission_options||n.options||[]).map((e,t)=>(0,u.jsx)("option",{value:e,children:e},t))]}):(0,u.jsx)("input",{type:"number"===n.config_type||"number"===n.permission_type||"number"===n.value_type?"number":"text",value:n.permission_value||n.config_value||n.value||"",onChange:t=>!s&&ve(e.guid,n.config_id||n.id,"permission_value",t.target.value),readOnly:s,placeholder:s?"Will be displayed here":"number"===n.config_type||"number"===n.permission_type||"number"===n.value_type?"Enter number":"Enter value",style:{width:"100%",padding:"10px 12px",border:"2px solid ".concat(s?"#e2e8f0":"#d1d5db"),borderRadius:8,fontSize:13,outline:"none",background:s?"#f3f4f6":"#fff",color:s?"#6b7280":"#374151",cursor:s?"not-allowed":"text",transition:"all 0.2s",fontWeight:500},onFocus:e=>!s&&(e.target.style.borderColor="#3b82f6"),onBlur:e=>e.target.style.borderColor="#d1d5db"})})()})]},n.config_id||n.id)})]},t.parentName))}),t.configs.filter(e=>e.is_enabled).length>0&&(0,u.jsxs)("div",{style:{marginTop:"24px",padding:"16px 20px",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",border:"2px solid #0ea5e9",borderRadius:"12px",fontSize:"14px",color:"#0369a1",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(14, 165, 233, 0.15)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px",background:"#0ea5e9",color:"#fff",borderRadius:"50%",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:"check_circle"}),(0,u.jsxs)("span",{style:{fontWeight:600},children:[(0,u.jsx)("strong",{style:{fontSize:"16px"},children:t.configs.filter(e=>e.is_enabled).length})," configuration",1!==t.configs.filter(e=>e.is_enabled).length?"s":""," enabled"]})]})]})})()}),(0,u.jsxs)("div",{style:{padding:"24px 28px",borderTop:"1px solid #e2e8f0",display:"flex",gap:12,justifyContent:"flex-end",background:"linear-gradient(to bottom, #f8fafc 0%, #ffffff 100%)",boxShadow:"0 -2px 8px rgba(0, 0, 0, 0.04)"},children:[(0,u.jsxs)("button",{onClick:()=>T(!1),style:{padding:"12px 24px",border:"2px solid #d1d5db",borderRadius:10,background:"#fff",color:"#374151",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#f3f4f6",e.target.style.borderColor="#9ca3af",e.target.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.target.style.background="#fff",e.target.style.borderColor="#d1d5db",e.target.style.transform="translateY(0)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"close"}),"Close"]}),W.length>0&&(null===(e=M[null===(t=W[B])||void 0===t?void 0:t.guid])||void 0===e?void 0:e.configs)&&(0,u.jsx)("button",{onClick:()=>(async e=>{const t=M[e];if(t&&t.configs&&0!==t.configs.length){O(!0);try{const n=G[e]||{},s=X[e]||{},o={};let r=!1;J.forEach(e=>{const t=n[e]||[],a=s[e]||[];if(t.length>0||a.length>0){r=!0;const n={};t.forEach(e=>{e.fieldName&&e.formula&&(n[e.fieldName]=e.formula)}),a.forEach(e=>{if(e.arrayName&&e.fields&&e.fields.length>0){const t={};e.fields.forEach(e=>{e.fieldName&&e.formula&&(t[e.fieldName]=e.formula)}),Object.keys(t).length>0&&(n[e.arrayName]=[t])}}),Object.keys(n).length>0&&(o[{voucher:"vouchers",ledgerentries:"ledgerentries",billallocations:"billallocations",inventoryentries:"inventoryentries",batchallocations:"batchallocations"}[e]||e]=[n])}});const i=[];if(r&&Object.keys(o).length>0){const e=t.configs.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase());i.push({config_id:(null===e||void 0===e?void 0:e.config_id)||(null===e||void 0===e?void 0:e.id)||null,is_enabled:void 0===(null===e||void 0===e?void 0:e.is_enabled)||!0===e.is_enabled||1===e.is_enabled,permission_value:(null===e||void 0===e?void 0:e.permission_value)||"",permission_value_json:o})}else{const e=t.configs.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase());e&&i.push({config_id:e.config_id||e.id,is_enabled:!0===e.is_enabled||1===e.is_enabled,permission_value:e.permission_value||"",permission_value_json:e.permission_value_json||{}})}const l=t.configs.filter(e=>{const t=(e.config_key||"").toLowerCase();return"voucher_udf"!==t&&!t.startsWith("voucher_udf_")}).map(e=>{const t=e.permission_value||e.config_value||"";return(0,a.A)({config_id:e.config_id||e.id,is_enabled:!0===e.is_enabled||1===e.is_enabled,permission_value:t,config_value:t},e.permission_value_json&&{permission_value_json:e.permission_value_json})}),c=[...l,...i],p={tallyloc_id:t.tallyloc_id,co_guid:t.co_guid,co_name:t.co_name,configurations:c};console.log("\ud83d\udcbe Saving configurations:",{tallyloc_id:p.tallyloc_id,co_guid:p.co_guid,configsCount:p.configurations.length,voucherUdfConfig:p.configurations.find(e=>{const n=t.configs.find(e=>"voucher_udf"===(e.config_key||"").toLowerCase());return e.config_id===((null===n||void 0===n?void 0:n.config_id)||(null===n||void 0===n?void 0:n.id))}),googleTokenConfig:p.configurations.find(e=>{var n,a;return e.config_id===((null===(n=t.configs.find(e=>"google_token"===e.config_key))||void 0===n?void 0:n.config_id)||(null===(a=t.configs.find(e=>"google_token"===e.config_key))||void 0===a?void 0:a.id))})});const g=await(0,d.apiPost)("/api/cmpconfig/update",p);if(!g||!g.success)throw new Error((null===g||void 0===g?void 0:g.message)||"Failed to save configurations");{const n=W.find(n=>n.guid===e&&n.tallyloc_id===t.tallyloc_id);n&&await be(n,R,!1),w("Configurations saved successfully for ".concat(t.co_name)),T(!1),P(0)}}catch(n){console.error("Error saving config:",n),j(n.message||"Failed to save configurations")}finally{O(!1)}}})(W[B].guid),disabled:Y,style:{padding:"12px 24px",border:"none",borderRadius:10,background:Y?"#9ca3af":"linear-gradient(135deg, #F27020 0%, #ea580c 100%)",color:"#fff",fontSize:14,fontWeight:600,cursor:Y?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:8,boxShadow:Y?"none":"0 4px 12px rgba(242, 112, 32, 0.3)"},onMouseEnter:e=>{Y||(e.target.style.background="linear-gradient(135deg, #ea580c 0%, #dc2626 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(242, 112, 32, 0.4)")},onMouseLeave:e=>{Y||(e.target.style.background="linear-gradient(135deg, #F27020 0%, #ea580c 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(242, 112, 32, 0.3)")},children:Y?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,animation:"spin 1s linear infinite"},children:"sync"}),"Saving..."]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"save"}),"Save Configurations"]})})]})]})}),te&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},onClick:e=>{e.target===e.currentTarget&&ne(!1)},children:(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 20px 40px 0 rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"900px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column",margin:"0 20px",animation:"slideUp 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"},children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h3",{style:{margin:0,fontSize:20,fontWeight:700,color:"#1e40af",display:"flex",alignItems:"center",gap:10},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"link"}),"Link Account"]}),(0,u.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"#64748b"},children:"Connect your external accounts to enable additional features"})]}),(0,u.jsx)("button",{onClick:()=>ne(!1),style:{background:"none",border:"none",fontSize:28,color:"#64748b",cursor:"pointer",padding:4,borderRadius:4,transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#f1f5f9",e.target.style.color="#dc2626"},onMouseLeave:e=>{e.target.style.background="none",e.target.style.color="#64748b"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:"40px",overflowY:"auto",flex:1,minHeight:0},children:[(0,u.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"12px",padding:"24px",marginBottom:"24px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,u.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #4285f4 0%, #1a73e8 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(66, 133, 244, 0.25)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"28px",color:"#fff"},children:"account_circle"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{style:{fontSize:"18px",fontWeight:600,color:"#1e293b",marginBottom:"4px"},children:"Google Account"}),(0,u.jsx)("p",{style:{fontSize:"14px",color:"#64748b"},children:"Connect your Google account to enable document upload and Google Drive integration"}),(0,p.isExternalUser)()&&(0,u.jsxs)("p",{style:{fontSize:"13px",color:"#dc2626",marginTop:"8px",padding:"8px 12px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"6px",display:"flex",alignItems:"center",gap:"6px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"info"}),"You are configuring your personal Google account. Only you can access this account. Email must match: ",sessionStorage.getItem("email")||"your registered email"]})]})]}),ae&&(0,u.jsxs)("div",{style:{padding:"6px 12px",background:"#f0fdf4",border:"1px solid #86efac",borderRadius:"8px",display:"flex",alignItems:"center",gap:"6px",color:"#16a34a",fontSize:"13px",fontWeight:600},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px"},children:"check_circle"}),oe?"Connected as ".concat(oe):"Connected"]})]}),!(0,l.isGoogleDriveFullyConfigured)().configured&&(0,u.jsxs)("div",{style:{padding:"12px 16px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#dc2626",fontSize:"14px",marginBottom:"16px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px",verticalAlign:"middle",marginRight:"8px"},children:"warning"}),"Google Drive API credentials need to be configured in environment variables."]}),(0,u.jsx)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:ae?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("button",{onClick:async()=>{const e=localStorage.getItem("google_access_token");if(e&&window.google&&window.google.accounts)try{window.google.accounts.oauth2.revoke(e,()=>{console.log("Token revoked for account switch")})}catch(t){console.log("Token revocation error (non-critical):",t)}if(localStorage.removeItem("google_access_token"),localStorage.removeItem("google_access_token_timestamp"),se(null),re(null),await _e("",""),R&&W.length>0){const e=W[B];e&&await be(e,R,!1)}setTimeout(()=>{Ne(!0)},300)},disabled:de,style:{padding:"12px 24px",background:de?"#e5e7eb":"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:de?"#9ca3af":"#fff",border:"none",borderRadius:"10px",fontWeight:600,fontSize:"15px",cursor:de?"not-allowed":"pointer",boxShadow:de?"none":"0 4px 12px 0 rgba(245,158,11,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.3s ease",minWidth:"180px"},onMouseEnter:e=>{de||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(245,158,11,0.35)")},onMouseLeave:e=>{de||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(245,158,11,0.25)")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px"},children:"swap_horiz"}),"Switch Account"]}),(0,u.jsxs)("button",{onClick:async()=>{try{const t=localStorage.getItem("google_access_token");if(t&&window.google&&window.google.accounts)try{window.google.accounts.oauth2.revoke(t,()=>{console.log("Token revoked successfully")})}catch(e){console.log("Token revocation error (non-critical):",e)}}catch(e){console.log("Error during token revocation:",e)}if(localStorage.removeItem("google_access_token"),localStorage.removeItem("google_access_token_timestamp"),se(null),re(null),await _e("",""),R&&W.length>0){const e=W[B];e&&await be(e,R,!1)}le({type:"info",message:"Google account disconnected successfully. You can now link a different account."})},style:{padding:"12px 24px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"#fff",border:"none",borderRadius:"10px",fontWeight:600,fontSize:"15px",cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(239,68,68,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.3s ease",minWidth:"180px"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(239,68,68,0.35)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(239,68,68,0.25)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px"},children:"link_off"}),"Disconnect"]})]}):(0,u.jsx)("button",{onClick:()=>Ne(!1),disabled:de||!(0,l.isGoogleDriveFullyConfigured)().configured,style:{padding:"12px 24px",background:de||!(0,l.isGoogleDriveFullyConfigured)().configured?"#e5e7eb":"linear-gradient(135deg, #4285f4 0%, #1a73e8 100%)",color:de||!(0,l.isGoogleDriveFullyConfigured)().configured?"#9ca3af":"#fff",border:"none",borderRadius:"10px",fontWeight:600,fontSize:"15px",cursor:de||!(0,l.isGoogleDriveFullyConfigured)().configured?"not-allowed":"pointer",boxShadow:de||!(0,l.isGoogleDriveFullyConfigured)().configured?"none":"0 4px 12px 0 rgba(66,133,244,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.3s ease",minWidth:"180px"},onMouseEnter:e=>{!de&&(0,l.isGoogleDriveFullyConfigured)().configured&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(66,133,244,0.35)")},onMouseLeave:e=>{!de&&(0,l.isGoogleDriveFullyConfigured)().configured&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(66,133,244,0.25)")},children:de?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px",animation:"spin 1s linear infinite"},children:"refresh"}),"Connecting..."]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"20px"},children:"login"}),"Link with Google"]})})}),ie&&(0,u.jsxs)("div",{style:{marginTop:"16px",padding:"12px 16px",borderRadius:"8px",background:"success"===ie.type?"#f0fdf4":"error"===ie.type?"#fef2f2":"#eff6ff",border:"1px solid ".concat("success"===ie.type?"#86efac":"error"===ie.type?"#fecaca":"#bfdbfe"),color:"success"===ie.type?"#16a34a":"error"===ie.type?"#dc2626":"#2563eb",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"18px"},children:"success"===ie.type?"check_circle":"error"===ie.type?"error":"info"}),ie.message]}),ae&&(0,u.jsxs)("div",{style:{marginTop:"16px",padding:"12px 16px",background:"#f0fdf4",borderRadius:"8px",fontSize:"13px",color:"#16a34a"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:"16px",verticalAlign:"middle",marginRight:"6px"},children:"check_circle"}),"Your Google account is connected. The connection will remain active until you unlink or switch accounts."]})]}),(0,u.jsx)("div",{style:{padding:"24px",textAlign:"center",color:"#94a3b8",fontSize:"14px",fontStyle:"italic"},children:"More account linking options coming soon..."})]})]})})]})};var b=n(757),y=n(75445);const v=function(e){let{isOpen:t,onClose:n,onSuccess:a}=e;const[o,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(1),[p,g]=(0,s.useState)(!1),[x,f]=(0,s.useState)(200),[m,h]=(0,s.useState)("monthly");(0,r.Zp)(),(0,s.useEffect)(()=>{t&&v()},[t]);const v=async()=>{g(!0);try{const t=await(0,b.AR)();if(i(t),t){h(t.billingCycle||"monthly");try{const e=await(0,d.Vg)("/api/subscription/plans");if(null!==e&&void 0!==e&&e.plans&&e.plans.length>0){const n=e.plans.find(e=>e.id===t.planId);n&&f(n.perUserAddOn||200)}}catch(e){console.error("Error fetching plans:",e)}}}catch(e){console.error("Error fetching subscription:",e)}finally{g(!1)}},j=e=>{const t=Math.max(1,l+e);c(t)};if(!t)return null;const S="annual"===m?x*l*12:x*l,w=(null===o||void 0===o?void 0:o.total_user_limit)||0,k=w+l;return(0,u.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",animation:"fadeIn 0.3s ease-out"},onClick:n,children:[(0,u.jsx)("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes slideUp {\n          from { \n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to { \n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "}),(0,u.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:20,padding:32,maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",animation:"slideUp 0.3s ease-out",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("button",{onClick:n,style:{position:"absolute",top:16,right:16,background:"none",border:"none",cursor:"pointer",padding:8,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background 0.2s",color:"#64748b"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9"},onMouseLeave:e=>{e.currentTarget.style.background="none"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"close"})}),(0,u.jsxs)("div",{style:{marginBottom:24,textAlign:"center"},children:[(0,u.jsx)("div",{style:{width:64,height:64,borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32,color:"#fff"},children:"person_add"})}),(0,u.jsx)("h2",{style:{margin:0,fontSize:28,fontWeight:700,color:"#1e293b",marginBottom:8},children:"Purchase Additional Users"}),(0,u.jsx)("p",{style:{margin:0,fontSize:16,color:"#64748b"},children:"You've reached your user limit. Add more users to continue."})]}),p?(0,u.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",animation:"spin 1s linear infinite"},children:"sync"})}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{style:{background:"#fef2f2",borderRadius:12,padding:20,marginBottom:24,border:"1px solid #fecaca"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#dc2626"},children:"warning"}),(0,u.jsx)("span",{style:{fontWeight:600,color:"#dc2626",fontSize:16},children:"User Limit Reached"})]}),(0,u.jsxs)("div",{style:{fontSize:14,color:"#78350f",lineHeight:1.6,marginBottom:8},children:["You have used all ",(0,u.jsxs)("strong",{children:[w," user slots"]})," in your current subscription. You cannot create more users until you purchase additional user slots."]}),(0,u.jsxs)("div",{style:{fontSize:13,color:"#92400e",padding:"8px 12px",background:"#fef3c7",borderRadius:6,border:"1px solid #fde68a"},children:[(0,u.jsx)("strong",{children:"Note:"})," After payment, your user limit will be increased immediately, and you'll be able to create the new users right away."]})]}),(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px rgba(31,38,135,0.08)",padding:24,marginBottom:24},children:[(0,u.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18,fontWeight:700,color:"#1e293b"},children:"Select Number of Users"}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:20},children:[(0,u.jsx)("button",{onClick:()=>j(-1),disabled:1===l,style:{width:48,height:48,borderRadius:"50%",border:"2px solid #e2e8f0",background:1===l?"#f1f5f9":"#fff",cursor:1===l?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:1===l?"#cbd5e1":"#64748b",transition:"all 0.2s"},onMouseEnter:e=>{l>1&&(e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.background="#f0f9ff")},onMouseLeave:e=>{l>1&&(e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.background="#fff")},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"remove"})}),(0,u.jsxs)("div",{style:{minWidth:120,textAlign:"center"},children:[(0,u.jsx)("div",{style:{fontSize:36,fontWeight:700,color:"#1e293b",marginBottom:4},children:l}),(0,u.jsx)("div",{style:{fontSize:14,color:"#64748b"},children:1===l?"user":"users"})]}),(0,u.jsx)("button",{onClick:()=>j(1),style:{width:48,height:48,borderRadius:"50%",border:"2px solid #3b82f6",background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#3b82f6",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#f0f9ff",e.currentTarget.style.transform="scale(1.05)"},onMouseLeave:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.transform="scale(1)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"add"})})]}),(0,u.jsxs)("div",{style:{padding:16,background:"#f0f9ff",borderRadius:12,border:"1px solid #bae6fd"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,u.jsx)("span",{style:{fontSize:14,color:"#64748b"},children:"Price per user:"}),(0,u.jsxs)("span",{style:{fontSize:14,fontWeight:600,color:"#1e293b"},children:["\u20b9",x,"/","annual"===m?"year":"month"]})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,u.jsx)("span",{style:{fontSize:14,color:"#64748b"},children:"Number of users:"}),(0,u.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"#1e293b"},children:l})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:12,borderTop:"2px solid #bae6fd",marginTop:8},children:[(0,u.jsx)("span",{style:{fontSize:18,fontWeight:700,color:"#1e293b"},children:"Total Amount:"}),(0,u.jsx)("span",{style:{fontSize:24,fontWeight:700,color:"#1e40af"},children:(0,b.vv)(S)})]}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b",textAlign:"right",marginTop:4},children:["per ","annual"===m?"year":"month"]})]}),(0,u.jsx)("div",{style:{marginTop:16,padding:12,background:"#f0fdf4",borderRadius:8,border:"1px solid #86efac"},children:(0,u.jsxs)("div",{style:{fontSize:14,color:"#166534",display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),(0,u.jsxs)("span",{children:["After purchase, your user limit will increase from ",(0,u.jsx)("strong",{children:w})," to ",(0,u.jsx)("strong",{children:k})]})]})})]}),(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(y.A,{subscriptionData:{planId:(null===o||void 0===o?void 0:o.planId)||null,billingCycle:m,addOnUsers:((null===o||void 0===o?void 0:o.addOnUsers)||0)+l,isUpgrade:!1,currentPlanId:(null===o||void 0===o?void 0:o.planId)||null,addUsersOnly:!0,additionalUsersCount:l},onSuccess:async()=>{a&&a(),n()},onError:e=>{console.error("Payment error:",e)},buttonText:"Pay ".concat((0,b.vv)(S)," & Add ").concat(l," User").concat(l>1?"s":""),buttonStyle:{padding:"16px 48px",fontSize:18,fontWeight:700,minWidth:300}}),(0,u.jsx)("button",{onClick:n,style:{marginTop:16,padding:"12px 24px",background:"transparent",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:10,fontWeight:600,fontSize:14,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Cancel"})]})]}),(0,u.jsx)("style",{children:"\n          @keyframes spin {\n            from { transform: rotate(0deg); }\n            to { transform: rotate(360deg); }\n          }\n        "})]})]})};const j=function(){const e=(0,r.Zp)(),[t,n]=(0,s.useState)([]),[o,i]=(0,s.useState)([]),[l,c]=(0,s.useState)([]),[g,x]=(0,s.useState)(!1),[f,m]=(0,s.useState)(!1),[h,y]=(0,s.useState)(!1),[j,S]=(0,s.useState)(!1),[w,k]=(0,s.useState)(""),[_,N]=(0,s.useState)(!1),[C,z]=(0,s.useState)(null),[I,A]=(0,s.useState)([]),[T,R]=(0,s.useState)({}),[E,W]=(0,s.useState)(!1),[L,B]=(0,s.useState)(null),[P,M]=(0,s.useState)([]),[F,D]=(0,s.useState)([]),[U,Y]=(0,s.useState)([]),[O,G]=(0,s.useState)([]),[H,q]=(0,s.useState)([]),[V,J]=(0,s.useState)([]),[X,K]=(0,s.useState)(!1),[Z,$]=(0,s.useState)(!1),[Q,ee]=(0,s.useState)(""),[te,ne]=(0,s.useState)(""),[ae,se]=(0,s.useState)(""),[oe,re]=(0,s.useState)([]),[ie,le]=(0,s.useState)([]),[de,ce]=(0,s.useState)(""),[pe,ge]=(0,s.useState)("ledger"),[ue,xe]=(0,s.useState)("form"),[fe,me]=(0,s.useState)({roleId:"",companyGuids:[],userName:"",email:"",mobile:"",isExternalUser:!1}),[he,be]=(0,s.useState)(!1),[ye,ve]=(0,s.useState)(""),[je,Se]=(0,s.useState)(""),[we,ke]=(0,s.useState)(""),[_e,Ne]=(0,s.useState)(!1),[Ce,ze]=(0,s.useState)(""),[Ie,Ae]=(0,s.useState)(!1),[Te,Re]=(0,s.useState)({total_user_limit:0}),[Ee,We]=(0,s.useState)({count:0}),[Le,Be]=(sessionStorage.getItem("token"),(0,s.useState)({})),[Pe,Me]=(0,s.useState)({}),[Fe,De]=(0,s.useState)([]),[Ue,Ye]=(0,s.useState)(!1),[Oe,Ge]=(0,s.useState)(""),[He,qe]=(0,s.useState)(0),[Ve,Je]=(0,s.useState)(!1),[Xe,Ke]=(0,s.useState)(""),[Ze,$e]=(0,s.useState)(""),[Qe,et]=(0,s.useState)(""),[tt,nt]=(0,s.useState)(""),[at,st]=(0,s.useState)(""),[ot,rt]=(0,s.useState)("keyword"),[it,lt]=(0,s.useState)([]),[dt,ct]=(0,s.useState)([]),[pt,gt]=(0,s.useState)(!1),[ut,xt]=(0,s.useState)({}),[ft,mt]=(0,s.useState)(!1),[ht,bt]=(0,s.useState)([]),[yt,vt]=(0,s.useState)(!1),[jt,St]=(0,s.useState)(null),[wt,kt]=(0,s.useState)(""),[_t,Nt]=(0,s.useState)(""),[Ct,zt]=(0,s.useState)(""),[It,At]=(0,s.useState)(""),[Tt,Rt]=(0,s.useState)(""),[Et,Wt]=(0,s.useState)("keyword"),[Lt,Bt]=(0,s.useState)([]),[Pt,Mt]=(0,s.useState)({}),[Ft,Dt]=(0,s.useState)(!1),[Ut,Yt]=(0,s.useState)([]),[Ot,Gt]=(0,s.useState)(!1),[Ht,qt]=(0,s.useState)(null),[Vt,Jt]=(0,s.useState)(""),[Xt,Kt]=(0,s.useState)(""),[Zt,$t]=(0,s.useState)(!1),[Qt,en]=(0,s.useState)(!1),[tn,nn]=(0,s.useState)(null),[an,sn]=(0,s.useState)(null),[on,rn]=(0,s.useState)(""),[ln,dn]=(0,s.useState)([]),[cn,pn]=(0,s.useState)(!1),[gn,un]=(0,s.useState)(!1),[xn,fn]=(0,s.useState)(!1),[mn,hn]=(0,s.useState)(null),[bn,yn]=(0,s.useState)(!1),vn=async()=>{x(!0),ke("");try{const e=Date.now(),t=await(0,d.Vg)("/api/tally/user-connections?ts=".concat(e));if(t&&t.success){const e=Array.isArray(t.createdByMe)?t.createdByMe:[],a=Array.isArray(t.sharedWithMe)?t.sharedWithMe:[],s=[...e,...a],o=s.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type);n(o),sessionStorage.setItem("allConnections",JSON.stringify(s)),window.dispatchEvent(new CustomEvent("connectionsUpdated"))}else ke("Failed to fetch companies from server")}catch(e){ke("Error fetching companies from server"),console.error("Error fetching connections:",e)}finally{x(!1)}},jn=async()=>{m(!0);try{const e=Date.now(),t=await(0,d.Vg)("/api/tally/internal-users?ts=".concat(e));t&&t.users&&i(t.users)}catch(e){console.error("Error fetching internal users:",e)}finally{m(!1)}},Sn=async e=>{console.log("\ud83d\udd0d Opening group modal for company:",e),console.log("\ud83d\udd0d Current editingUser:",C),console.log("\ud83d\udd0d editingUser.id:",null===C||void 0===C?void 0:C.id);const n=(null===C||void 0===C?void 0:C.id)||(null===C||void 0===C?void 0:C.user_id)||(null===C||void 0===C?void 0:C.email)||(null===C||void 0===C?void 0:C.userId);console.log("\ud83d\udd0d Resolved userId:",n),B(e),W(!0),await(async e=>{K(!0);try{const n=t.find(t=>t.guid===e);if(console.log("\ud83d\udd0d Looking for company with GUID:",e),console.log("\ud83d\udd0d Available connections:",t),console.log("\ud83d\udd0d Found company:",n),!n)return console.error("\u274c Company not found for GUID:",e),M([]),void D([]);console.log("\ud83d\udd0d Company properties:",Object.keys(n)),console.log("\ud83d\udd0d Company.company:",n.company),console.log("\ud83d\udd0d Company.tallyloc_id:",n.tallyloc_id);const a=n.company||"Unknown Company",s={tallyloc_id:n.tallyloc_id,company:a,guid:e},o=Date.now();console.log("\ud83d\udce4 API Payload:",s),console.log("\ud83d\udce4 Cache Buster (ts):",o),console.log("\ud83d\udce1 Fetching ledger groups...");const r=await(0,d.apiPost)("/api/tally/ledgergroups?ts=".concat(o),s);console.log("\ud83d\udce1 Ledger groups response:",r);let i=[];r&&r.ledgerGroups?(i=r.ledgerGroups.map(e=>({id:e.MASTERID,name:e.NAME,description:"Ledger Group - ".concat(e.NAME)})),console.log("\u2705 Processed ledger groups:",i)):console.log("\u26a0\ufe0f No ledger groups in response or invalid response structure"),console.log("\ud83d\udce1 Fetching stock groups...");const l=await(0,d.apiPost)("/api/tally/stockgroups?ts=".concat(o),s);console.log("\ud83d\udce1 Stock groups response:",l);let c=[];l&&l.stockGroups?(c=l.stockGroups.map(e=>({id:e.MASTERID,name:e.NAME,description:"Stock Group - ".concat(e.NAME)})),console.log("\u2705 Processed stock groups:",c)):console.log("\u26a0\ufe0f No stock groups in response or invalid response structure"),console.log("\ud83d\udce1 Fetching stock categories...");const p=await(0,d.apiPost)("/api/tally/stockcategories?ts=".concat(o),s);console.log("\ud83d\udce1 Stock categories response:",p);let g=[];p&&p.stockCategories?(g=p.stockCategories.map(e=>({id:e.MASTERID,name:e.NAME,description:"Stock Category - ".concat(e.NAME)})),console.log("\u2705 Processed stock categories:",g)):console.log("\u26a0\ufe0f No stock categories in response or invalid response structure"),console.log("\ud83d\udce1 Fetching voucher types...");const u=await(0,d.apiPost)("/api/tally/vchauth/vouchertype?ts=".concat(o),s);console.log("\ud83d\udce1 Voucher types response:",u);let x=[];u&&u.voucherTypes?(x=u.voucherTypes.map(e=>({id:e.MASTERID,name:e.NAME,description:"Voucher Type - ".concat(e.NAME)})),console.log("\u2705 Processed voucher types:",x)):console.log("\u26a0\ufe0f No voucher types in response or invalid response structure"),0===i.length&&(console.log("\ud83e\uddea Using mock ledger groups for testing"),i=[{id:"7",name:"Branch / Divisions",description:"Ledger Group - Branch / Divisions"},{id:"16",name:"Sundry Creditors",description:"Ledger Group - Sundry Creditors"},{id:"20",name:"Sundry Debtors",description:"Ledger Group - Sundry Debtors"}]),0===c.length&&(console.log("\ud83e\uddea Using mock stock groups for testing"),c=[{id:"219",name:"Group A",description:"Stock Group - Group A"},{id:"220",name:"Group B",description:"Stock Group - Group B"},{id:"222",name:"Group D",description:"Stock Group - Group D"}]),0===g.length&&(console.log("\ud83e\uddea Using mock stock categories for testing"),g=[{id:"235",name:"Category 2",description:"Stock Category - Category 2"},{id:"234",name:"Category 1",description:"Stock Category - Category 1"}]),0===x.length&&(console.log("\ud83e\uddea Using mock voucher types for testing"),x=[{id:"1",name:"Sales",description:"Voucher Type - Sales"},{id:"2",name:"Purchase",description:"Voucher Type - Purchase"},{id:"3",name:"Payment",description:"Voucher Type - Payment"}]),M(i),D(c),Y(g),re(x),console.log("\ud83c\udfaf Final state - Ledger groups:",i.length),console.log("\ud83c\udfaf Final state - Stock groups:",c.length),console.log("\ud83c\udfaf Final state - Stock categories:",g.length),console.log("\ud83c\udfaf Final state - Voucher types:",x.length)}catch(n){console.error("\u274c Error fetching groups:",n),M([]),D([]),Y([]),re([])}finally{K(!1)}})(e.guid),C&&n?(console.log("\ud83d\udd0d Fetching existing groups for user:",n,"company:",e),await(async(e,t)=>{try{const n={userid:e,tallyloc_id:t.tallyloc_id,company_name:t.company,guid:t.guid};console.log("\ud83d\udce5 Fetching existing group assignments..."),console.log("\ud83d\udce5 Payload:",n);const a=Date.now(),s=await(0,d.apiPost)("/api/tally/user-groups/get?ts=".concat(a),n);if(console.log("\ud83d\udce5 Existing groups response:",s),s&&s.success&&s.data&&s.data.groups){const e=(s.data.groups.ledger_groups||[]).map(e=>e.masterid),t=(s.data.groups.stock_groups||[]).map(e=>e.masterid),n=(s.data.groups.stock_categories||[]).map(e=>e.masterid),a=(s.data.groups.voucher_types||[]).map(e=>e.masterid);console.log("\ud83d\udce5 Setting selected ledger groups:",e),console.log("\ud83d\udce5 Setting selected stock groups:",t),console.log("\ud83d\udce5 Setting selected stock categories:",n),console.log("\ud83d\udce5 Setting selected voucher types:",a),G(e),q(t),J(n),le(a)}else console.log("\ud83d\udce5 No existing groups found or invalid response"),G([]),q([]),J([]),le([])}catch(n){console.error("\u274c Error fetching user company groups:",n),G([]),q([]),J([]),le([])}})(n,e)):console.log("\u26a0\ufe0f No valid userId, skipping fetchUserCompanyGroups")},wn=()=>{W(!1),B(null),M([]),D([]),Y([]),re([]),G([]),q([]),J([]),le([]),ee(""),ne(""),se(""),ce(""),ge("ledger")},kn=P.filter(e=>e.name.toLowerCase().includes(Q.toLowerCase())||e.description&&e.description.toLowerCase().includes(Q.toLowerCase())),_n=F.filter(e=>e.name.toLowerCase().includes(te.toLowerCase())||e.description&&e.description.toLowerCase().includes(te.toLowerCase())),Nn=U.filter(e=>e.name.toLowerCase().includes(ae.toLowerCase())||e.description&&e.description.toLowerCase().includes(ae.toLowerCase())),Cn=oe.filter(e=>e.name.toLowerCase().includes(de.toLowerCase())||e.description&&e.description.toLowerCase().includes(de.toLowerCase()));(0,s.useEffect)(()=>{const e=JSON.parse(sessionStorage.getItem("allConnections")||"[]").filter(e=>"Connected"===e.status&&"Full Access"===e.access_type);e.length>0?(n(e),console.log("Initial load from session storage:",e.length,"companies")):vn(),jn(),(async()=>{y(!0);try{const e=await(0,d.Vg)("/api/access-control/roles/all");e&&e.roles&&c(e.roles)}catch(e){console.error("Error fetching roles:",e),c([{id:1,display_name:"Admin",description:"Full system access"},{id:2,display_name:"Manager",description:"Management level access"},{id:3,display_name:"User",description:"Standard user access"},{id:4,display_name:"Viewer",description:"Read-only access"}])}finally{y(!1)}})(),Un()},[]),(0,s.useEffect)(()=>{const e=()=>{vn()};return window.addEventListener("storage",e),window.addEventListener("connectionsUpdated",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("connectionsUpdated",e)}},[]),(0,s.useEffect)(()=>{(async()=>{try{const e=await(0,b.AR)(),t=null;Re(e||(e=>e||{total_user_limit:0})),We(t||{count:o.length||0})}catch(e){console.error("Error fetching subscription info:",e),Re(e=>e||{total_user_limit:0}),We({count:o.length||0})}})()},[]),(0,s.useEffect)(()=>{o.length>0&&(!Ee||0===Ee.count)&&We(e=>({count:o.length||(null===e||void 0===e?void 0:e.count)||0}))},[o.length]),(0,s.useEffect)(()=>{o.length>0&&(async()=>{try{const t=o.filter(e=>(e.companies||[]).some(e=>e.isExternalUser));if(0===t.length)return;const n={},a={};for(const s of t){a[s.email]=!0;try{const e=Date.now(),t=await(0,d.Vg)("/api/tally/external-user-cache-enabled?email=".concat(encodeURIComponent(s.email),"&ts=").concat(e));n[s.email]=(null===t||void 0===t?void 0:t.enabled)||!1}catch(e){console.error("Error loading cache setting for ".concat(s.email,":"),e),n[s.email]=!1}finally{a[s.email]=!1}}Be(n),Me(a)}catch(e){console.error("Error loading user cache settings:",e)}})()},[o]);const zn=async(e,t)=>{Me(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!0}));try{const n=Date.now(),s=await(0,d.apiPost)("/api/tally/external-user-cache-enabled?ts=".concat(n),{email:e,enabled:t});s&&!1!==s.success?(Be(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t})),(0,p.eF)(e),console.log("Cache setting saved for ".concat(e,":"),t)):(console.error("Failed to save user cache setting"),alert("Failed to save setting. Please try again."))}catch(n){console.error("Error saving user cache setting:",n),alert("Error saving setting. Please try again.")}finally{Me(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!1}))}},In=e=>{me((0,a.A)((0,a.A)({},fe),{},{[e.target.name]:e.target.value})),ve(""),Se(""),_e&&Ne(!1)},An=()=>{N(!1),z(null),A([]),R({})},Tn=e=>{A(t=>t.includes(e)?(R(t=>{const n=(0,a.A)({},t);return delete n[e],n}),t.filter(t=>t!==e)):(R(t=>(0,a.A)((0,a.A)({},t),{},{[e]:t[e]||{roleId:"",isExternalUser:!1}})),[...t,e]))},Rn=(0,s.useMemo)(()=>{const e=t.map(e=>({guid:e.guid,company:e.company||e.companyName,tallyloc_id:e.tallyloc_id||e.tallylocId})),n=new Set(e.map(e=>e.guid)),a=((null===C||void 0===C?void 0:C.companies)||[]).filter(e=>(e.companyGuid||e.guid)&&!n.has(e.companyGuid||e.guid)).map(e=>({guid:e.companyGuid||e.guid,company:e.companyName||e.company,tallyloc_id:e.tallylocId||e.tallyloc_id})),s=[...e,...a].filter(e=>e&&e.guid&&(e.company||"").length>=0);return s.sort((e,t)=>(e.company||"").toLowerCase().localeCompare((t.company||"").toLowerCase())),s},[t,C]),En=async()=>{gt(!0);try{const a=localStorage.getItem("route_customers_version");if(a==="2.0"){const t=localStorage.getItem("route_customers");if(t)try{const e=JSON.parse(t);if(e.length>0&&e[0].companyName)return ct(e),gt(!1),void console.log("\u2705 Customers loaded from cache:",e.length);console.log("\u26a0\ufe0f Cached data missing companyName, fetching fresh data"),localStorage.removeItem("route_customers")}catch(e){console.warn("Failed to parse cached customers:",e)}}else console.log("\u26a0\ufe0f Cache version mismatch, clearing old cache"),localStorage.removeItem("route_customers");if(t.length>0){const e=[],a=t.map(async e=>{const t=e.company||e.companyName||e.name||"Unknown Company",n={tallyloc_id:e.tallyloc_id,company:t,guid:e.guid};try{console.log("\ud83d\udce1 Fetching customers from API for company:",t,"Full company object:",e);const a=await(0,d.apiPost)("/api/tally/ledgerlist-w-addrs?ts=".concat(Date.now()),n);return a&&a.ledgers&&Array.isArray(a.ledgers)?a.ledgers.map(e=>({customer_id:e.MASTERID||e.NAME,name:e.NAME,pincode:e.PINCODE||"",address:e.ADDRESS||"",companyName:t,latitude:e.latitude||null,longitude:e.longitude||null})):[]}catch(a){return console.error("Error fetching customers for company ".concat(t,":"),a),[]}});(await Promise.all(a)).forEach(t=>{e.push(...t)});try{localStorage.setItem("route_customers",JSON.stringify(e)),localStorage.setItem("route_customers_version","2.0"),console.log("\u2705 Cached customers with company names")}catch(n){console.warn("Failed to cache customers:",n.message)}ct(e),console.log("\u2705 Customers loaded from API (".concat(t.length," companies):"),e.length),e.length>0&&console.log("\ud83d\udccb Sample customer:",e[0])}else console.warn("\u26a0\ufe0f No connections available to fetch customers"),ct([])}catch(a){console.error("Error loading customers:",a),ct([])}finally{gt(!1)}},Wn=(0,s.useMemo)(()=>{const e=new Set;return dt.forEach(t=>{t.companyName&&""!==t.companyName.trim()&&e.add(t.companyName.trim())}),Array.from(e).sort()},[dt]);(0,s.useEffect)(()=>{Wn.length>0?bt(e=>{if(0===e.length)return[...Wn];return[...e.filter(e=>Wn.includes(e)),...Wn.filter(t=>!e.includes(t))]}):bt([])},[Wn]),(0,s.useEffect)(()=>{yt&&Wn.length>0&&Yt([...Wn])},[yt,Wn]),(0,s.useMemo)(()=>{const e=new Set;return dt.forEach(t=>{t.pincode&&""!==t.pincode.trim()&&e.add(t.pincode.trim())}),Array.from(e).sort()},[dt]);const Ln=(0,s.useMemo)(()=>{const e=new Set;return dt.filter(e=>{const t=e.companyName||"Unknown Company";return ht.includes(t)}).forEach(t=>{t.pincode&&""!==t.pincode.trim()&&e.add(t.pincode.trim())}),Array.from(e).sort()},[dt,ht]),Bn=(0,s.useMemo)(()=>{if(!Qe.trim())return[];const e=Qe.trim().toLowerCase();return Ln.filter(t=>t.toLowerCase().includes(e)).slice(0,10)},[Qe,Ln]),Pn=(0,s.useMemo)(()=>{const e=dt.filter(e=>{const t=e.companyName||"Unknown Company";return ht.includes(t)});if("pincode"===ot)return tt?e.filter(e=>e.pincode&&e.pincode.trim()===tt).map(e=>{const t=e.customer_id,n=ut[t]||{latitude:e.latitude||null,longitude:e.longitude||null};return{id:t,name:e.name,pincode:e.pincode||"",address:e.address||"",companyName:e.companyName||"Unknown Company",latitude:n.latitude,longitude:n.longitude}}):[];if("keyword"===ot){if(!at.trim())return[];const t=at.trim().toLowerCase();return e.filter(e=>[e.name||"",e.pincode||"",e.address||"",e.companyName||"",e.customer_id||""].some(e=>e.toLowerCase().includes(t))).map(e=>{const t=e.customer_id,n=ut[t]||{latitude:e.latitude||null,longitude:e.longitude||null};return{id:t,name:e.name,pincode:e.pincode||"",address:e.address||"",companyName:e.companyName||"Unknown Company",latitude:n.latitude,longitude:n.longitude}})}return[]},[dt,tt,at,ot,ut,ht]),Mn=(0,s.useMemo)(()=>{const e=new Set;return dt.filter(e=>{const t=e.companyName||"Unknown Company";return Ut.includes(t)}).forEach(t=>{t.pincode&&""!==t.pincode.trim()&&e.add(t.pincode.trim())}),Array.from(e).sort()},[dt,Ut]),Fn=(0,s.useMemo)(()=>{if(!Ct.trim())return[];const e=Ct.trim().toLowerCase();return Mn.filter(t=>t.toLowerCase().includes(e)).slice(0,10)},[Ct,Mn]),Dn=(0,s.useMemo)(()=>{const e=dt.filter(e=>{const t=e.companyName||"Unknown Company";return Ut.includes(t)});if("pincode"===Et)return It?e.filter(e=>e.pincode&&e.pincode.trim()===It).map(e=>{const t=e.customer_id,n=Pt[t]||{latitude:e.latitude||null,longitude:e.longitude||null};return{id:t,name:e.name,pincode:e.pincode||"",address:e.address||"",companyName:e.companyName||"Unknown Company",latitude:n.latitude,longitude:n.longitude}}):[];if("keyword"===Et){if(!Tt.trim())return[];const t=Tt.trim().toLowerCase();return e.filter(e=>[e.name||"",e.pincode||"",e.address||"",e.companyName||"",e.customer_id||""].some(e=>e.toLowerCase().includes(t))).map(e=>{const t=e.customer_id,n=Pt[t]||{latitude:e.latitude||null,longitude:e.longitude||null};return{id:t,name:e.name,pincode:e.pincode||"",address:e.address||"",companyName:e.companyName||"Unknown Company",latitude:n.latitude,longitude:n.longitude}})}return[]},[dt,It,Tt,Et,Pt,Ut]),Un=async()=>{Ye(!0);try{const e=JSON.parse(localStorage.getItem("routes")||"[]"),t=JSON.parse(localStorage.getItem("route_assignments")||"[]");if(e.length>0){const n=e.map(e=>{var n;const s=t.find(t=>t.route_id===e.id);return(0,a.A)((0,a.A)({},e),{},{assignedTo:(null===s||void 0===s?void 0:s.user_id)||null,customerCount:(null===(n=e.customer_ids)||void 0===n?void 0:n.length)||e.customerCount||0})});De(n)}else De([])}catch(e){console.error("Error fetching routes:",e),De([])}finally{Ye(!1)}},Yn=async e=>{if(St(e),kt(e.name||""),Nt(e.description||""),Bt(e.customer_ids||[]),zt(""),At(""),Rt(""),Wt("keyword"),e.customer_coordinates&&Array.isArray(e.customer_coordinates)){var t;const n={};null===(t=e.customer_ids)||void 0===t||t.forEach((t,a)=>{e.customer_coordinates[a]&&(n[t]={latitude:e.customer_coordinates[a].latitude,longitude:e.customer_coordinates[a].longitude})}),Mt(n)}else Mt({});0===dt.length&&await En(),vt(!0)},On=e=>{if(!e||!e.companies||0===e.companies.length)return!1;return e.companies.map(e=>e.roleId).filter(e=>null!==e&&void 0!==e).some(e=>{const t=l.find(t=>t.id===e);return t&&t.display_name&&"salesperson"===t.display_name.toLowerCase()})},Gn=o.filter(e=>e.name.toLowerCase().includes(Ce.toLowerCase())||e.email.toLowerCase().includes(Ce.toLowerCase())),Hn=window.innerWidth<=768;return(0,u.jsxs)("div",{className:"user-management-wrapper",style:{margin:"0",padding:Hn?"16px 12px":"24px",width:"100%",maxWidth:"1200px",marginLeft:"auto",marginRight:"auto",boxSizing:"border-box",minHeight:"100vh",fontFamily:"Segoe UI, Roboto, Arial, sans-serif",overflowX:"hidden"},children:[(0,u.jsx)("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes fadeIn {\n          from { opacity: 0; transform: translateY(10px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n        @keyframes slideIn {\n          from { opacity: 0; transform: translateX(-10px); }\n          to { opacity: 1; transform: translateX(0); }\n        }\n      "}),(0,u.jsx)("style",{children:"\n        @media (max-width: 768px) {\n          .user-management-header {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n            gap: 16px !important;\n            padding: 20px 16px 20px 60px !important;\n            margin-top: 20px !important;\n            margin-bottom: 24px !important;\n            position: relative !important;\n          }\n          .user-management-header-title {\n            font-size: 24px !important;\n          }\n          .user-management-header-icon {\n            width: 44px !important;\n            height: 44px !important;\n          }\n          .user-management-header-icon .material-icons {\n            font-size: 24px !important;\n          }\n          .user-management-header-subtitle {\n            font-size: 14px !important;\n            margin-left: 0 !important;\n            margin-top: 8px !important;\n          }\n          .user-management-companies-badge {\n            width: 100% !important;\n            max-width: 100% !important;\n            justify-content: center !important;\n            padding: 10px 16px !important;\n            font-size: 13px !important;\n            margin-top: 0 !important;\n            white-space: normal !important;\n            text-align: center !important;\n            box-sizing: border-box !important;\n            word-wrap: break-word !important;\n            overflow-wrap: break-word !important;\n          }\n          .user-management-companies-badge span {\n            display: inline-flex !important;\n            align-items: center !important;\n            gap: 6px !important;\n            flex-wrap: wrap !important;\n            justify-content: center !important;\n          }\n          .user-management-companies-badge .material-icons {\n            font-size: 18px !important;\n            flex-shrink: 0 !important;\n          }\n          .user-management-tabs {\n            flex-direction: column !important;\n            gap: 6px !important;\n            padding: 6px !important;\n          }\n          .user-management-tab-button {\n            padding: 12px 16px !important;\n            font-size: 13px !important;\n            min-height: 48px !important;\n          }\n          .user-management-tab-button .material-icons {\n            font-size: 18px !important;\n          }\n          \n          /* Form Container */\n          .user-form-container {\n            padding: 20px 16px !important;\n            margin-bottom: 20px !important;\n            border-radius: 16px !important;\n          }\n          \n          /* Form Header */\n          .user-form-header {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n            gap: 12px !important;\n            margin-bottom: 24px !important;\n            padding-bottom: 16px !important;\n          }\n          .user-form-header h3 {\n            font-size: 20px !important;\n          }\n          .user-form-header-icon {\n            width: 40px !important;\n            height: 40px !important;\n          }\n          .user-form-header-icon .material-icons {\n            font-size: 24px !important;\n          }\n          \n          /* Form Grid Fields */\n          .user-form-grid {\n            grid-template-columns: 1fr !important;\n            gap: 16px !important;\n            margin-bottom: 20px !important;\n          }\n          \n          /* Form Labels */\n          .user-form-label {\n            font-size: 13px !important;\n            margin-bottom: 8px !important;\n          }\n          .user-form-label .material-icons {\n            font-size: 16px !important;\n          }\n          \n          /* Form Inputs */\n          .user-form-input,\n          .user-form-select {\n            padding: 12px 14px !important;\n            font-size: 14px !important;\n            border-radius: 10px !important;\n          }\n          \n          /* Company Selection Section */\n          .company-selection-header {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n            gap: 12px !important;\n            padding: 12px 16px !important;\n          }\n          .company-selection-header h4 {\n            font-size: 16px !important;\n          }\n          .company-selection-grid {\n            grid-template-columns: 1fr !important;\n            gap: 12px !important;\n            padding: 16px !important;\n          }\n          \n          /* External User Checkbox */\n          .external-user-checkbox {\n            padding: 16px !important;\n            margin-top: 16px !important;\n            margin-bottom: 16px !important;\n          }\n          \n          /* Submit Button */\n          .user-form-submit-button {\n            width: 100% !important;\n            padding: 14px 20px !important;\n            font-size: 14px !important;\n            min-width: auto !important;\n          }\n          \n          /* Form Messages */\n          .user-form-message {\n            padding: 14px 16px !important;\n            font-size: 13px !important;\n            margin-top: 16px !important;\n          }\n          .user-form-message .material-icons {\n            font-size: 18px !important;\n          }\n          \n          /* Users Table Container */\n          .users-table-container {\n            padding: 20px 16px !important;\n            margin-top: 0 !important;\n            border-radius: 16px !important;\n          }\n          \n          /* Users Table Header */\n          .users-table-header {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n            gap: 16px !important;\n            margin-bottom: 20px !important;\n            padding-bottom: 16px !important;\n          }\n          .users-table-header h3 {\n            font-size: 20px !important;\n          }\n          .users-table-header-icon {\n            width: 40px !important;\n            height: 40px !important;\n          }\n          .users-table-header-icon .material-icons {\n            font-size: 24px !important;\n          }\n          \n          /* Search Input */\n          .users-search-input {\n            width: 100% !important;\n            padding: 10px 14px !important;\n            font-size: 14px !important;\n          }\n          .users-search-input input {\n            width: 100% !important;\n            font-size: 14px !important;\n          }\n          \n          /* Users Table */\n          .users-table-wrapper {\n            overflow-x: auto !important;\n            -webkit-overflow-scrolling: touch !important;\n            border-radius: 12px !important;\n          }\n          .users-table {\n            min-width: 800px !important;\n            font-size: 13px !important;\n          }\n          .users-table th {\n            padding: 12px 14px !important;\n            font-size: 11px !important;\n          }\n          .users-table td {\n            padding: 16px 14px !important;\n            font-size: 13px !important;\n          }\n          \n          /* Action Buttons */\n          .user-action-button {\n            padding: 8px 12px !important;\n            font-size: 12px !important;\n            min-width: auto !important;\n          }\n          .user-action-button .material-icons {\n            font-size: 16px !important;\n          }\n          \n          /* Users Table Action Buttons */\n          .users-table-actions {\n            flex-direction: column !important;\n            gap: 8px !important;\n            width: 100% !important;\n          }\n          .users-table-actions button {\n            width: 100% !important;\n            padding: 10px 12px !important;\n            font-size: 12px !important;\n          }\n          .users-table-actions .material-icons {\n            font-size: 14px !important;\n          }\n          \n          /* Empty/Loading States */\n          .users-empty-state,\n          .users-loading-state {\n            padding: 40px 20px !important;\n          }\n          .users-empty-state .material-icons,\n          .users-loading-state .material-icons {\n            font-size: 40px !important;\n          }\n          \n          /* Routes Tab Container */\n          .routes-container {\n            padding: 20px 16px !important;\n            margin-top: 20px !important;\n            border-radius: 16px !important;\n          }\n          \n          /* Routes Header */\n          .routes-header {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n            gap: 16px !important;\n            margin-bottom: 20px !important;\n            padding-bottom: 16px !important;\n          }\n          .routes-header h3 {\n            font-size: 20px !important;\n          }\n          .routes-header-icon {\n            width: 40px !important;\n            height: 40px !important;\n          }\n          .routes-header-icon .material-icons {\n            font-size: 24px !important;\n          }\n          \n          /* Routes Search and Create */\n          .routes-search-create {\n            flex-direction: column !important;\n            gap: 12px !important;\n            width: 100% !important;\n          }\n          .routes-search-input {\n            width: 100% !important;\n            padding: 10px 14px !important;\n          }\n          .routes-search-input input {\n            width: 100% !important;\n            font-size: 14px !important;\n          }\n          .routes-create-button {\n            width: 100% !important;\n            padding: 12px 20px !important;\n            font-size: 13px !important;\n            justify-content: center !important;\n          }\n          \n          /* Routes Table */\n          .routes-table-wrapper {\n            overflow-x: auto !important;\n            -webkit-overflow-scrolling: touch !important;\n            border-radius: 12px !important;\n          }\n          .routes-table {\n            min-width: 900px !important;\n            font-size: 13px !important;\n          }\n          .routes-table th {\n            padding: 12px 14px !important;\n            font-size: 11px !important;\n          }\n          .routes-table td {\n            padding: 16px 14px !important;\n            font-size: 13px !important;\n          }\n          \n          /* Routes Empty/Loading States */\n          .routes-empty-state,\n          .routes-loading-state {\n            padding: 40px 20px !important;\n          }\n          .routes-empty-state .material-icons,\n          .routes-loading-state .material-icons {\n            font-size: 40px !important;\n          }\n        }\n        \n        @media (max-width: 480px) {\n          .user-management-wrapper {\n            padding: 16px 12px !important;\n          }\n          .user-management-tab-button {\n            padding: 10px 12px !important;\n            font-size: 12px !important;\n            gap: 6px !important;\n          }\n          .user-management-tab-button .material-icons {\n            font-size: 16px !important;\n          }\n          \n          /* Form Container */\n          .user-form-container {\n            padding: 16px 12px !important;\n            border-radius: 12px !important;\n          }\n          \n          /* Form Header */\n          .user-form-header h3 {\n            font-size: 18px !important;\n          }\n          .user-form-header-icon {\n            width: 36px !important;\n            height: 36px !important;\n          }\n          .user-form-header-icon .material-icons {\n            font-size: 20px !important;\n          }\n          \n          /* Form Grid Fields */\n          .user-form-grid {\n            gap: 12px !important;\n          }\n          \n          /* Form Labels */\n          .user-form-label {\n            font-size: 12px !important;\n          }\n          \n          /* Form Inputs */\n          .user-form-input,\n          .user-form-select {\n            padding: 10px 12px !important;\n            font-size: 13px !important;\n          }\n          \n          /* Company Selection */\n          .company-selection-header {\n            padding: 10px 12px !important;\n          }\n          .company-selection-header h4 {\n            font-size: 14px !important;\n          }\n          .company-selection-grid {\n            padding: 12px !important;\n            gap: 10px !important;\n          }\n          \n          /* External User Checkbox */\n          .external-user-checkbox {\n            padding: 12px !important;\n          }\n          \n          /* Submit Button */\n          .user-form-submit-button {\n            padding: 12px 16px !important;\n            font-size: 13px !important;\n          }\n          \n          /* Users Table Container */\n          .users-table-container {\n            padding: 16px 12px !important;\n          }\n          \n          /* Users Table Header */\n          .users-table-header h3 {\n            font-size: 18px !important;\n          }\n          .users-table-header-icon {\n            width: 36px !important;\n            height: 36px !important;\n          }\n          .users-table-header-icon .material-icons {\n            font-size: 20px !important;\n          }\n          \n          /* Users Table */\n          .users-table {\n            min-width: 700px !important;\n            font-size: 12px !important;\n          }\n          .users-table th {\n            padding: 10px 12px !important;\n            font-size: 10px !important;\n          }\n          .users-table td {\n            padding: 12px !important;\n            font-size: 12px !important;\n          }\n          \n          /* Action Buttons */\n          .user-action-button {\n            padding: 6px 10px !important;\n            font-size: 11px !important;\n          }\n          \n          /* Users Table Action Buttons */\n          .users-table-actions button {\n            padding: 8px 10px !important;\n            font-size: 11px !important;\n          }\n          .users-table-actions .material-icons {\n            font-size: 12px !important;\n          }\n          \n          /* Routes Tab Container */\n          .routes-container {\n            padding: 16px 12px !important;\n          }\n          \n          /* Routes Header */\n          .routes-header h3 {\n            font-size: 18px !important;\n          }\n          .routes-header-icon {\n            width: 36px !important;\n            height: 36px !important;\n          }\n          .routes-header-icon .material-icons {\n            font-size: 20px !important;\n          }\n          \n          /* Routes Search and Create */\n          .routes-create-button {\n            padding: 10px 16px !important;\n            font-size: 12px !important;\n          }\n          \n          /* Routes Table */\n          .routes-table {\n            min-width: 800px !important;\n            font-size: 12px !important;\n          }\n          .routes-table th {\n            padding: 10px 12px !important;\n            font-size: 10px !important;\n          }\n          .routes-table td {\n            padding: 12px !important;\n            font-size: 12px !important;\n          }\n        }\n      "}),(0,u.jsxs)("div",{style:{marginBottom:"32px",borderBottom:"2px solid #e5e7eb",paddingBottom:"24px",paddingTop:Hn?"70px":"24px",paddingLeft:"0"},children:[(0,u.jsxs)("h1",{style:{fontSize:Hn?"22px":"28px",fontWeight:700,color:"#1e293b",margin:0,display:"flex",alignItems:"center",gap:Hn?"8px":"12px",flexWrap:Hn?"wrap":"nowrap"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"24px":"32px",color:"#3b82f6"},children:"people"}),"User Management"]}),(0,u.jsx)("p",{style:{fontSize:Hn?"14px":"16px",color:"#64748b",marginTop:"8px",marginLeft:Hn?"0":"44px"},children:"Grant access to users and manage routes"})]}),(0,u.jsxs)("div",{className:"user-management-tabs",style:{background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid rgba(59, 130, 246, 0.1)",marginBottom:24,padding:"8px",display:"flex",gap:8},children:[(0,u.jsxs)("button",{className:"user-management-tab-button",onClick:()=>xe("form"),style:{flex:1,padding:"14px 24px",borderRadius:14,border:"none",background:"form"===ue?"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)":"transparent",color:"form"===ue?"#fff":"#64748b",fontSize:15,fontWeight:"form"===ue?700:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10,transition:"all 0.3s ease",boxShadow:"form"===ue?"0 4px 12px rgba(59, 130, 246, 0.3)":"none",whiteSpace:"nowrap"},onMouseEnter:e=>{"form"!==ue&&(e.currentTarget.style.background="#f1f5f9")},onMouseLeave:e=>{"form"!==ue&&(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"18px":"20px"},children:"person_add"}),(0,u.jsx)("span",{children:"User Access Form"})]}),(0,u.jsxs)("button",{className:"user-management-tab-button",onClick:()=>xe("users"),style:{flex:1,padding:Hn?"10px 16px":"12px 20px",borderRadius:"8px",border:"none",background:"users"===ue?"#3b82f6":"transparent",color:"users"===ue?"#fff":"#64748b",fontSize:Hn?"13px":"14px",fontWeight:"users"===ue?600:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:Hn?"6px":"8px",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:e=>{"users"!==ue&&(e.currentTarget.style.background="#f1f5f9")},onMouseLeave:e=>{"users"!==ue&&(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"18px":"20px"},children:"group"}),(0,u.jsxs)("span",{children:["Users (",Gn.length,")"]})]}),(0,u.jsxs)("button",{className:"user-management-tab-button",onClick:()=>xe("routes"),style:{flex:1,padding:Hn?"10px 16px":"12px 20px",borderRadius:"8px",border:"none",background:"routes"===ue?"#3b82f6":"transparent",color:"routes"===ue?"#fff":"#64748b",fontSize:Hn?"13px":"14px",fontWeight:"routes"===ue?600:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:Hn?"6px":"8px",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:e=>{"routes"!==ue&&(e.currentTarget.style.background="#f1f5f9")},onMouseLeave:e=>{"routes"!==ue&&(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"18px":"20px"},children:"route"}),(0,u.jsxs)("span",{children:["Routes (",Fe.filter(e=>{var t,n;return""===Oe||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Oe.toLowerCase()))||(null===(n=e.assignedTo)||void 0===n?void 0:n.toLowerCase().includes(Oe.toLowerCase()))}).length,")"]})]})]}),(0,u.jsxs)("div",{style:{position:"relative",minHeight:400},children:["form"===ue&&(0,u.jsx)("div",{style:{animation:"fadeIn 0.3s ease-out"},children:(0,u.jsxs)("div",{className:"user-form-container",style:{background:"#fff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",padding:Hn?"20px 16px":"24px",marginBottom:Hn?"20px":"24px",width:"100%",boxSizing:"border-box",border:"1px solid #e5e7eb"},children:[(0,u.jsxs)("div",{className:"user-form-header",style:{marginBottom:Hn?"20px":"24px",paddingBottom:Hn?"16px":"20px",borderBottom:"2px solid #e5e7eb"},children:[(0,u.jsxs)("h3",{style:{color:"#1e293b",fontWeight:600,margin:0,fontSize:Hn?"18px":"20px",display:"flex",alignItems:"center",gap:Hn?"8px":"10px",marginBottom:"8px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"20px":"24px",color:"#3b82f6"},children:"person_add"}),"User Access Form"]}),(0,u.jsx)("p",{style:{color:"#64748b",fontSize:Hn?"13px":"14px",margin:0,marginLeft:Hn?"0":"34px"},children:"Create new user access and assign permissions"}),Te&&Te.planId&&Te.total_user_limit&&0!==Te.total_user_limit?Te&&Ee&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 14px",background:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#fef2f2":((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=.8*((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#fef3c7":"#f0fdf4",border:"1px solid ".concat(((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#fecaca":((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=.8*((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#fde68a":"#86efac"),borderRadius:20,cursor:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"pointer":"default",transition:"all 0.2s",whiteSpace:"nowrap",marginLeft:"auto"},onClick:()=>{((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?Ae(!0):e("/admin-dashboard?view=subscription")},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},title:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"User limit reached. Click to purchase more users.":"Click to manage subscription",children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#dc2626":((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=.8*((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#d97706":"#16a34a"},children:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"warning":"people"}),(0,u.jsxs)("span",{style:{fontSize:13,fontWeight:600,color:((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#dc2626":((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=.8*((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)?"#d97706":"#16a34a"},children:[(null===Ee||void 0===Ee?void 0:Ee.count)||o.length||0," / ",null===Te||void 0===Te?void 0:Te.total_user_limit," users"]}),((null===Ee||void 0===Ee?void 0:Ee.count)||0)>=((null===Te||void 0===Te?void 0:Te.total_user_limit)||0)&&(null===Te||void 0===Te?void 0:Te.total_user_limit)>0&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#dc2626"},children:"add_circle"})]}):(0,u.jsxs)("button",{onClick:()=>e("/admin-dashboard?view=subscription"),style:{display:"flex",alignItems:"center",gap:8,padding:"8px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:20,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap",marginLeft:"auto",fontSize:14,fontWeight:600,boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)"},title:"Subscribe to unlock user management features",children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"subscriptions"}),(0,u.jsx)("span",{children:"Subscribe"})]})]}),(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),be(!0),ve(""),Se(""),Ne(!0),!fe.roleId)return ve("Please select a role before submitting the form."),void be(!1);try{if(!(await(0,b.vq)()).canCreate)return Ae(!0),void be(!1)}catch(n){console.error("Error checking subscription limit:",n)}try{const e=fe.companyGuids.map(e=>{const n=t.find(t=>t.guid===e);return console.log("Selected connection:",n),{tallyloc_id:n.tallyloc_id,company:n.company,guid:n.guid,roleId:parseInt(fe.roleId),isExternalUser:fe.isExternalUser}}),a={email:fe.email,name:fe.userName,mobileno:fe.mobile,isExternalUser:fe.isExternalUser,companies:e};console.log("API Payload:",a),console.log("Companies being sent:",e);const s=Date.now(),o=await(0,d.apiPost)("/api/tally/internal-user-access?ts=".concat(s),a);if(console.log("API Response:",o),!o||"success"!==o.status&&"no_changes"!==o.status)throw o&&"error"===o.status?new Error(o.message||"Failed to create access"):new Error("Invalid response from server");if(o.results&&o.results.errors&&o.results.errors.length>0)ve(o.results.errors.join(", ")||"Some errors occurred while creating access");else{const e=o.message||"Access granted successfully";Se(e),me({roleId:"",companyGuids:[],userName:"",email:"",mobile:"",isExternalUser:!1}),Ne(!1);try{const e=await(0,b.AR)();Re(e),We(null)}catch(n){console.error("Error refreshing subscription info:",n)}jn(),setTimeout(()=>{Se("")},3e3)}}catch(a){ve(a.message)}finally{be(!1)}},children:[(0,u.jsxs)("div",{style:{marginBottom:32,position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{className:"user-form-grid",style:{display:"grid",gridTemplateColumns:window.innerWidth<=700?"1fr":"repeat(4, 1fr)",gap:24,marginBottom:24},children:[(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("label",{className:"user-form-label",style:{fontWeight:700,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:14},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"badge"}),"Role ",(0,u.jsx)("span",{style:{color:"#dc2626"},children:"*"})]}),(0,u.jsxs)("select",{name:"roleId",value:fe.roleId,onChange:In,required:!0,disabled:h,className:"user-form-select",style:{padding:"14px 18px",borderRadius:12,border:"2px solid ".concat(_e&&!fe.roleId?"#dc2626":"#e5e7eb"),width:"100%",fontSize:15,background:"#fff",marginBottom:0,cursor:h?"not-allowed":"pointer",transition:"all 0.3s ease",boxSizing:"border-box",opacity:h?.6:1,fontWeight:500,boxShadow:_e&&!fe.roleId?"0 0 0 3px rgba(220, 38, 38, 0.1)":"0 2px 8px rgba(0,0,0,0.04)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)",e.target.style.transform="translateY(-1px)"},onBlur:e=>{e.target.style.borderColor=_e&&!fe.roleId?"#dc2626":"#e5e7eb",e.target.style.boxShadow=_e&&!fe.roleId?"0 0 0 3px rgba(220, 38, 38, 0.1)":"0 2px 8px rgba(0,0,0,0.04)",e.target.style.transform="translateY(0)"},children:[(0,u.jsx)("option",{value:"",children:h?"Loading roles...":"Select a role"}),l.map(e=>(0,u.jsx)("option",{value:e.id,children:e.display_name},e.id))]})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("label",{className:"user-form-label",style:{fontWeight:700,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:14},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"person"}),"User Name"]}),(0,u.jsx)("input",{name:"userName",type:"text",value:fe.userName,onChange:In,required:!0,className:"user-form-input",style:{padding:"14px 18px",borderRadius:12,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",marginBottom:0,cursor:"text",transition:"all 0.3s ease",boxSizing:"border-box",fontWeight:500,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},placeholder:"Enter user name",onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)",e.target.style.transform="translateY(-1px)"},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)",e.target.style.transform="translateY(0)"}})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("label",{className:"user-form-label",style:{fontWeight:700,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:14},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"email"}),"Email ID"]}),(0,u.jsx)("input",{name:"email",type:"email",value:fe.email,onChange:In,required:!0,className:"user-form-input",style:{padding:"14px 18px",borderRadius:12,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",marginBottom:0,cursor:"text",transition:"all 0.3s ease",boxSizing:"border-box",fontWeight:500,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},placeholder:"user@example.com",onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)",e.target.style.transform="translateY(-1px)"},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)",e.target.style.transform="translateY(0)"}})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("label",{className:"user-form-label",style:{fontWeight:700,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:14},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"phone"}),"Mobile"]}),(0,u.jsx)("input",{name:"mobile",type:"tel",value:fe.mobile,onChange:In,required:!0,className:"user-form-input",style:{padding:"14px 18px",borderRadius:12,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",marginBottom:0,cursor:"text",transition:"all 0.3s ease",boxSizing:"border-box",fontWeight:500,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},placeholder:"9876543210",onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)",e.target.style.transform="translateY(-1px)"},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)",e.target.style.transform="translateY(0)"}})]})]}),(0,u.jsx)("div",{className:"external-user-checkbox",style:{marginTop:Hn?"16px":"20px",marginBottom:Hn?"16px":"20px",padding:Hn?"16px":"20px",background:"#f0f9ff",borderRadius:"12px",border:"1px solid #bae6fd",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="rgba(59, 130, 246, 0.4)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="rgba(59, 130, 246, 0.2)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:(0,u.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:16,cursor:"pointer",fontSize:15,lineHeight:1.6},children:[(0,u.jsx)("div",{style:{width:24,height:24,borderRadius:6,border:"2px solid ".concat(fe.isExternalUser?"#3b82f6":"#cbd5e1"),background:fe.isExternalUser?"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)":"#fff",display:"flex",alignItems:"center",justifyContent:"center",marginTop:2,transition:"all 0.2s ease",flexShrink:0},children:fe.isExternalUser&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#fff"},children:"check"})}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsxs)("div",{style:{color:"#1e293b",fontWeight:700,fontSize:15,marginBottom:4,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#3b82f6"},children:"person_outline"}),"External Users"]}),(0,u.jsx)("div",{style:{color:"#64748b",fontWeight:500,fontSize:13,lineHeight:1.5},children:"Access only to Ledgers where Email matches in Ledger Master"})]}),(0,u.jsx)("input",{type:"checkbox",name:"isExternalUser",checked:fe.isExternalUser,onChange:e=>me((0,a.A)((0,a.A)({},fe),{},{isExternalUser:e.target.checked})),style:{position:"absolute",opacity:0,width:0,height:0}})]})})]}),(0,u.jsxs)("div",{style:{marginBottom:32,position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{className:"company-selection-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:Hn?"16px":"20px",padding:Hn?"12px 16px":"16px 20px",background:"#f0f9ff",borderRadius:"12px",border:"1px solid #bae6fd"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:Hn?"12px":"16px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"20px":"24px",color:"#3b82f6"},children:"business"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{style:{color:"#1e293b",fontWeight:600,margin:0,fontSize:Hn?"16px":"18px",marginBottom:fe.companyGuids.length>0?"4px":"0"},children:"Company Access"}),fe.companyGuids.length>0&&(0,u.jsxs)("div",{style:{fontSize:Hn?"12px":"13px",color:"#0369a1",display:"flex",alignItems:"center",gap:6,fontWeight:500},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"check_circle"}),fe.companyGuids.length," company",fe.companyGuids.length>1?"ies":""," selected"]})]})]}),t.length>0&&(0,u.jsxs)("button",{type:"button",onClick:()=>{if(fe.companyGuids.length===t.length)me((0,a.A)((0,a.A)({},fe),{},{companyGuids:[]}));else{const e=t.map(e=>e.guid);me((0,a.A)((0,a.A)({},fe),{},{companyGuids:e}))}ve(""),Se("")},style:{padding:Hn?"8px 16px":"10px 20px",background:fe.companyGuids.length===t.length?"#ef4444":"#3b82f6",color:"#fff",border:"none",borderRadius:"8px",fontSize:Hn?"12px":"13px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:Hn?"6px":"8px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.opacity="0.9"},onMouseLeave:e=>{e.target.style.opacity="1"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"16px":"18px"},children:fe.companyGuids.length===t.length?"check_box":"check_box_outline_blank"}),fe.companyGuids.length===t.length?"Deselect All":"Select All"]})]}),(0,u.jsx)("div",{style:{padding:Hn?"16px":"20px",background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:t.length>0?(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{className:"company-selection-grid",style:{display:"grid",gridTemplateColumns:window.innerWidth<=700?"1fr":"repeat(auto-fill, minmax(250px, 1fr))",gap:16,marginBottom:12,maxHeight:"280px",overflowY:"auto",paddingRight:"8px",alignItems:"start"},children:t.map(e=>{const t=fe.companyGuids.includes(e.guid);return(0,u.jsxs)("div",{onClick:()=>(e=>{const t=fe.companyGuids.includes(e)?fe.companyGuids.filter(t=>t!==e):[...fe.companyGuids,e];me((0,a.A)((0,a.A)({},fe),{},{companyGuids:t})),ve(""),Se("")})(e.guid),style:{padding:"16px 20px",borderRadius:14,background:t?"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",color:t?"#ffffff":"#374151",border:t?"none":"2px solid #e5e7eb",cursor:"pointer",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",gap:12,transition:"all 0.3s ease",boxShadow:t?"0 6px 20px rgba(59, 130, 246, 0.35)":"0 2px 8px rgba(0,0,0,0.08)",width:"100%",whiteSpace:"normal",wordWrap:"break-word",boxSizing:"border-box",position:"relative",overflow:"hidden"},onMouseEnter:e=>{t?(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(59, 130, 246, 0.45)"):(e.currentTarget.style.background="linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.transform="translateY(-3px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(59, 130, 246, 0.2)")},onMouseLeave:e=>{t?(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 6px 20px rgba(59, 130, 246, 0.35)"):(e.currentTarget.style.background="linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.08)")},children:[(0,u.jsx)("div",{style:{width:32,height:32,borderRadius:8,background:t?"rgba(255,255,255,0.2)":"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:t?"none":"0 2px 8px rgba(59, 130, 246, 0.25)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#fff"},children:t?"check_circle":"business"})}),(0,u.jsx)("div",{style:{fontWeight:700,fontSize:14,color:t?"#ffffff":"#1e293b",textShadow:t?"0 1px 2px rgba(0,0,0,0.2)":"none",flex:1,lineHeight:1.4},children:e.company||"Unknown Company"}),t&&(0,u.jsx)("div",{style:{position:"absolute",top:4,right:4,width:20,height:20,borderRadius:"50%",background:"rgba(255,255,255,0.3)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,color:"#fff"},children:"check"})})]},e.guid)})})}):(0,u.jsxs)("div",{style:{textAlign:"center",color:"#6b7280",fontSize:15,padding:"40px 20px",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",borderRadius:12,border:"2px dashed #cbd5e1"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,marginBottom:12,display:"block",color:"#cbd5e1"},children:"business_center"}),(0,u.jsx)("div",{style:{fontWeight:600,marginBottom:4},children:"No companies available"}),(0,u.jsx)("div",{style:{fontSize:13},children:"Please create connections first"})]})})]}),(0,u.jsx)("div",{style:{display:"flex",justifyContent:"center",paddingTop:16,position:"relative",zIndex:1},children:(0,u.jsxs)("button",{type:"submit",disabled:he||0===fe.companyGuids.length,className:"user-form-submit-button",style:{padding:"18px 48px",background:0===fe.companyGuids.length?"linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)":"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",color:"#fff",border:"none",borderRadius:14,fontWeight:800,fontSize:17,cursor:0===fe.companyGuids.length?"not-allowed":"pointer",opacity:he?.7:1,boxShadow:0===fe.companyGuids.length?"none":"0 6px 24px rgba(34,197,94,0.35)",whiteSpace:"nowrap",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:12,minWidth:200,letterSpacing:"0.3px",position:"relative",overflow:"hidden"},onMouseEnter:e=>{!he&&fe.companyGuids.length>0&&(e.currentTarget.style.transform="translateY(-3px) scale(1.02)",e.currentTarget.style.boxShadow="0 8px 28px rgba(34,197,94,0.45)")},onMouseLeave:e=>{!he&&fe.companyGuids.length>0&&(e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 6px 24px rgba(34,197,94,0.35)")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.2))"},children:he?"sync":"person_add"}),he?"Granting Access...":"Grant Access"]})})]}),ye&&(0,u.jsxs)("div",{className:"user-form-message",style:{background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",border:"2px solid #fecaca",borderRadius:14,padding:"18px 20px",marginTop:20,display:"flex",alignItems:"center",gap:14,boxShadow:"0 4px 12px rgba(220, 38, 38, 0.15)",animation:"slideIn 0.3s ease-out",position:"relative",zIndex:1},children:[(0,u.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:22},children:"error"})}),(0,u.jsx)("div",{style:{color:"#dc2626",fontSize:15,fontWeight:600,flex:1},children:ye})]}),je&&(0,u.jsxs)("div",{className:"user-form-message",style:{background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",border:"2px solid #bbf7d0",borderRadius:14,padding:"18px 20px",marginTop:20,display:"flex",alignItems:"center",gap:14,boxShadow:"0 4px 12px rgba(22, 163, 74, 0.15)",animation:"slideIn 0.3s ease-out",position:"relative",zIndex:1},children:[(0,u.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:"0 4px 12px rgba(22, 163, 74, 0.3)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:22},children:"check_circle"})}),(0,u.jsx)("div",{style:{color:"#16a34a",fontSize:15,fontWeight:600,flex:1},children:je})]})]})}),"users"===ue&&(0,u.jsx)("div",{style:{animation:"fadeIn 0.3s ease-out"},children:(0,u.jsxs)("div",{className:"users-table-container",style:{background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.12)",padding:window.innerWidth<=700?24:40,marginTop:0,width:"100%",margin:"0 auto",minHeight:200,boxSizing:"border-box",border:"1px solid rgba(59, 130, 246, 0.1)",animation:"fadeIn 0.7s ease-out",position:"relative",overflow:"hidden"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"250px",height:"250px",background:"radial-gradient(circle, rgba(59, 130, 246, 0.06) 0%, transparent 70%)",borderRadius:"50%",transform:"translate(-20%, -20%)",pointerEvents:"none"}}),(0,u.jsxs)("div",{className:"users-table-header",style:{marginBottom:Hn?"20px":"24px",paddingBottom:Hn?"16px":"20px",borderBottom:"2px solid #e5e7eb"},children:[(0,u.jsxs)("h3",{style:{color:"#1e293b",fontWeight:600,margin:0,fontSize:Hn?"18px":"20px",display:"flex",alignItems:"center",gap:Hn?"8px":"10px",marginBottom:"8px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"20px":"24px",color:"#3b82f6"},children:"group"}),"Users ",(0,u.jsxs)("span",{style:{color:"#64748b",fontWeight:500},children:["(",Gn.length,")"]})]}),(0,u.jsx)("p",{style:{color:"#64748b",fontSize:Hn?"13px":"14px",margin:0,marginLeft:Hn?"0":"34px"},children:"Manage user access and permissions"}),(0,u.jsxs)("div",{className:"users-search-input",style:{display:"flex",alignItems:"center",gap:12,background:"#fff",padding:"10px 16px",borderRadius:12,border:"2px solid #e5e7eb",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#3b82f6",fontSize:22},children:"search"}),(0,u.jsx)("input",{type:"text",value:Ce,onChange:e=>ze(e.target.value),placeholder:"Search users...",style:{border:"none",outline:"none",fontSize:15,fontWeight:500,width:220,background:"transparent",color:"#1e293b"}})]})]}),f&&(0,u.jsxs)("div",{className:"users-loading-state",style:{textAlign:"center",padding:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500},children:"Loading internal users..."})]}),!f&&0===Gn.length&&(0,u.jsxs)("div",{className:"users-empty-state",style:{textAlign:"center",padding:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:64,color:"#cbd5e1",marginBottom:16,display:"block"},children:"group"}),(0,u.jsx)("div",{style:{fontSize:18,fontWeight:600,marginBottom:8},children:Ce?"No users found matching your search":"No users found"}),(0,u.jsx)("div",{style:{fontSize:14},children:Ce?"Try adjusting your search term":"Create access using the form above"})]}),!f&&Gn.length>0&&(0,u.jsx)("div",{className:"users-table-wrapper",style:{overflowX:"auto",maxHeight:"600px",overflowY:"auto",border:"2px solid rgba(59, 130, 246, 0.15)",borderRadius:16,background:"#fff",boxShadow:"0 4px 16px rgba(0,0,0,0.06)",position:"relative",zIndex:1},children:(0,u.jsxs)("table",{className:"users-table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0,fontSize:14},children:[(0,u.jsx)("thead",{style:{position:"sticky",top:0,zIndex:10},children:(0,u.jsxs)("tr",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)"},children:[(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"User Details"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Company Access"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Role"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"User Type"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Cache"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Status"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Actions"})]})}),(0,u.jsx)("tbody",{children:Gn.map((e,t)=>(0,u.jsxs)("tr",{style:{background:t%2===0?"#fff":"#f8fafc",borderBottom:"1px solid #e2e8f0",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",e.currentTarget.style.transform="scale(1.01)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.background=t%2===0?"#fff":"#f8fafc",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="none"},children:[(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:14},children:[(0,u.jsx)("div",{style:{width:44,height:44,borderRadius:12,background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:"0 4px 12px rgba(59, 130, 246, 0.25)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22,color:"#fff"},children:"person"})}),(0,u.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#1e293b",marginBottom:6,fontSize:15},children:e.name}),(0,u.jsxs)("div",{style:{fontSize:13,color:"#64748b",marginBottom:4,display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#94a3b8"},children:"email"}),e.email]}),e.mobileno&&(0,u.jsxs)("div",{style:{fontSize:13,color:"#64748b",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#94a3b8"},children:"phone"}),e.mobileno]})]})]})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:(0,u.jsxs)("span",{style:{padding:"8px 14px",background:"linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%)",color:"#0369a1",borderRadius:10,fontSize:13,fontWeight:700,border:"1px solid #7dd3fc",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px rgba(59, 130, 246, 0.15)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"business"}),e.companies.length," companies"]})})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(()=>{const t=(e=>{if(!e||0===e.length)return{display:"-",style:"none"};const t=e.map(e=>e.roleId).filter(e=>null!==e&&void 0!==e),n=[...new Set(t)];if(0===n.length)return{display:"-",style:"none"};if(1===n.length){var a;const e=n[0];return{display:(null===(a=l.find(t=>t.id===e))||void 0===a?void 0:a.display_name)||"Role ".concat(e),style:"single"}}return{display:"Multi",style:"multi"}})(e.companies);let n,a,s;switch(t.style){case"single":n="#f0f9ff",a="#1e40af",s="#dbeafe";break;case"multi":n="#fef3c7",a="#92400e",s="#fde68a";break;default:n="#f1f5f9",a="#64748b",s="#e2e8f0"}return(0,u.jsx)("span",{style:{padding:"4px 12px",background:n,color:a,borderRadius:12,fontSize:12,fontWeight:500,border:"1px solid ".concat(s),width:"fit-content"},children:t.display})})()})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(()=>{const t=(e=>{if(!e||0===e.length)return{display:"-",style:"none"};const t=e.map(e=>e.isExternalUser),n=[...new Set(t)];if(1===n.length){const e=n[0];return{display:e?"External":"Internal",style:e?"external":"internal"}}return{display:"Multi",style:"multi"}})(e.companies);let n,a,s;switch(t.style){case"external":n="#fef3c7",a="#92400e",s="#fde68a";break;case"internal":n="#dcfce7",a="#166534",s="#bbf7d0";break;case"multi":n="#f3e8ff",a="#7c3aed",s="#ddd6fe";break;default:n="#f1f5f9",a="#64748b",s="#e2e8f0"}return(0,u.jsx)("span",{style:{padding:"4px 12px",background:n,color:a,borderRadius:12,fontSize:12,fontWeight:500,border:"1px solid ".concat(s),width:"fit-content"},children:t.display})})()})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(e.companies||[]).some(e=>e.isExternalUser)?Pe[e.email]?(0,u.jsx)("span",{style:{fontSize:12,color:"#64748b"},children:"Loading..."}):(0,u.jsxs)("label",{style:{position:"relative",display:"inline-block",width:44,height:24,cursor:"pointer"},title:Le[e.email]?"Cache enabled":"Cache disabled",children:[(0,u.jsx)("input",{type:"checkbox",checked:Le[e.email]||!1,onChange:t=>{zn(e.email,t.target.checked)},style:{opacity:0,width:0,height:0}}),(0,u.jsx)("span",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:Le[e.email]?"#10b981":"#9ca3af",borderRadius:12,transition:"all 0.3s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:(0,u.jsx)("span",{style:{position:"absolute",top:2,left:Le[e.email]?22:2,width:20,height:20,borderRadius:"50%",backgroundColor:"#fff",transition:"all 0.3s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.2)"}})})]}):(0,u.jsx)("span",{style:{padding:"4px 12px",background:"#f1f5f9",color:"#64748b",borderRadius:12,fontSize:12,fontWeight:500,border:"1px solid #e2e8f0",width:"fit-content"},children:"N/A"})})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,u.jsxs)("span",{style:{padding:"6px 12px",background:e.userActive?"linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)":"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",color:e.userActive?"#166534":"#dc2626",borderRadius:10,fontSize:12,fontWeight:700,border:"1px solid ".concat(e.userActive?"#86efac":"#fca5a5"),width:"fit-content",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:e.userActive?"check_circle":"cancel"}),e.userActive?"Active":"Inactive"]})})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsxs)("div",{className:"users-table-actions",style:{display:"flex",flexDirection:"column",gap:6,alignItems:"flex-start",width:"100%"},children:[(0,u.jsxs)("div",{style:{display:"flex",gap:6,width:"100%"},children:[(0,u.jsxs)("button",{className:"user-action-button",style:{padding:"7px 14px",background:"#4285F4",color:"#fff",border:"none",borderRadius:8,fontSize:12,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:5,boxShadow:"0 2px 4px rgba(66, 133, 244, 0.25)",whiteSpace:"nowrap",minWidth:0},onMouseEnter:e=>{e.currentTarget.style.background="#357ae8",e.currentTarget.style.boxShadow="0 3px 6px rgba(66, 133, 244, 0.35)",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="#4285F4",e.currentTarget.style.boxShadow="0 2px 4px rgba(66, 133, 244, 0.25)",e.currentTarget.style.transform="translateY(0)"},onClick:()=>(e=>{z(e);const t=(e.companies||[]).map(e=>e.companyGuid||e.guid).filter(Boolean);A(t);const n={};(e.companies||[]).forEach(e=>{const t=e.companyGuid||e.guid;t&&(n[t]={roleId:e.roleId||"",isExternalUser:e.isExternalUser||!1})}),R(n),N(!0)})(e),children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"edit"}),"Edit"]}),(0,u.jsxs)("button",{className:"user-action-button",style:{padding:"7px 14px",background:w===e.email?"#9ca3af":"#EA4335",color:"#fff",border:"none",borderRadius:8,fontSize:12,fontWeight:600,cursor:w===e.email?"not-allowed":"pointer",opacity:w===e.email?.8:1,flex:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:5,boxShadow:w===e.email?"none":"0 2px 4px rgba(234, 67, 53, 0.25)",whiteSpace:"nowrap",minWidth:0},onMouseEnter:t=>{w!==e.email&&(t.currentTarget.style.background="#d33b2c",t.currentTarget.style.boxShadow="0 3px 6px rgba(234, 67, 53, 0.35)",t.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:t=>{w!==e.email&&(t.currentTarget.style.background="#EA4335",t.currentTarget.style.boxShadow="0 2px 4px rgba(234, 67, 53, 0.25)",t.currentTarget.style.transform="translateY(0)")},disabled:w===e.email,onClick:()=>(async e=>{if(!e||!e.email)return;if(window.confirm("Remove access for shared companies?")){k(e.email);try{const t=Date.now(),n={email:e.email},a=await(0,d.apiPost)("/api/tally/internal-user-access/remove-all?ts=".concat(t),n);a&&"success"===a.status?await jn():alert(a&&a.message||"Failed to remove access")}catch(t){console.error("Remove access error:",t),alert(t.message||"Error while removing access")}finally{k("")}}})(e),children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"delete"}),w===e.email?"Removing...":"Delete"]})]}),On(e)&&(0,u.jsxs)("button",{style:{padding:"8px 18px",background:"linear-gradient(135deg, #2563eb 0%, #1e3a8a 100%)",color:"#fb9602",border:"none",borderRadius:8,fontSize:12,fontWeight:700,cursor:"pointer",width:"100%",boxSizing:"border-box",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:6,marginTop:6,boxShadow:"0 2px 8px rgba(30, 58, 138, 0.35)",whiteSpace:"nowrap",letterSpacing:"0.3px",position:"relative",overflow:"hidden"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%)",e.currentTarget.style.boxShadow="0 4px 12px rgba(30, 58, 138, 0.45)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1e3a8a 100%)",e.currentTarget.style.boxShadow="0 2px 8px rgba(30, 58, 138, 0.35)",e.currentTarget.style.transform="translateY(0)"},onClick:()=>(e=>{hn(e),yn(!1),fn(!0)})(e),children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:17,color:"#fb9602",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.2))"},children:"settings"}),"Route Actions"]})]})})]},"".concat(e.userId,"-").concat(e.email)))})]})})]})}),"routes"===ue&&(0,u.jsx)("div",{style:{animation:"fadeIn 0.3s ease-out"},children:(0,u.jsxs)("div",{className:"routes-container",style:{background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.12)",padding:window.innerWidth<=700?24:40,marginTop:32,minHeight:200,boxSizing:"border-box",border:"1px solid rgba(59, 130, 246, 0.1)",animation:"fadeIn 0.8s ease-out",position:"relative",overflow:"hidden"},children:[(0,u.jsx)("div",{style:{position:"absolute",bottom:0,right:0,width:"250px",height:"250px",background:"radial-gradient(circle, rgba(59, 130, 246, 0.06) 0%, transparent 70%)",borderRadius:"50%",transform:"translate(20%, 20%)",pointerEvents:"none"}}),(0,u.jsxs)("div",{className:"routes-header",style:{marginBottom:Hn?"20px":"24px",paddingBottom:Hn?"16px":"20px",borderBottom:"2px solid #e5e7eb"},children:[(0,u.jsxs)("h3",{style:{color:"#1e293b",fontWeight:600,margin:0,fontSize:Hn?"18px":"20px",display:"flex",alignItems:"center",gap:Hn?"8px":"10px",marginBottom:"8px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:Hn?"20px":"24px",color:"#3b82f6"},children:"route"}),"Routes ",(0,u.jsxs)("span",{style:{color:"#64748b",fontWeight:500},children:["(",Fe.filter(e=>{var t,n;return""===Oe||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Oe.toLowerCase()))||(null===(n=e.assignedTo)||void 0===n?void 0:n.toLowerCase().includes(Oe.toLowerCase()))}).length,")"]})]}),(0,u.jsx)("p",{style:{color:"#64748b",fontSize:Hn?"13px":"14px",margin:0,marginLeft:Hn?"0":"34px"},children:"Manage delivery routes and assignments"}),(0,u.jsxs)("div",{className:"routes-search-create",style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsxs)("div",{className:"routes-search-input",style:{display:"flex",alignItems:"center",gap:12,background:"#fff",padding:"10px 16px",borderRadius:12,border:"2px solid #e5e7eb",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#3b82f6",fontSize:22},children:"search"}),(0,u.jsx)("input",{type:"text",value:Oe,onChange:e=>Ge(e.target.value),placeholder:"Search routes...",style:{border:"none",outline:"none",fontSize:15,fontWeight:500,width:220,background:"transparent",color:"#1e293b"}})]}),(0,u.jsxs)("button",{className:"routes-create-button",style:{padding:"12px 24px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",border:"none",borderRadius:12,fontSize:14,fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",gap:8,transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(59, 130, 246, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(59, 130, 246, 0.3)"},onClick:()=>{Ke(""),$e(""),et(""),nt(""),st(""),rt("keyword"),lt([]),xt({}),En(),bt([]),Je(!0)},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"add"}),"Create new route"]})]})]}),Ue&&(0,u.jsxs)("div",{className:"routes-loading-state",style:{textAlign:"center",padding:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500},children:"Loading routes..."})]}),!Ue&&0===Fe.filter(e=>{var t,n;return""===Oe||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Oe.toLowerCase()))||(null===(n=e.assignedTo)||void 0===n?void 0:n.toLowerCase().includes(Oe.toLowerCase()))}).length&&(0,u.jsxs)("div",{className:"routes-empty-state",style:{textAlign:"center",padding:60,color:"#64748b",background:"#f8fafc",borderRadius:12,margin:"16px 0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:64,color:"#cbd5e1",marginBottom:16,display:"block"},children:"route"}),(0,u.jsx)("div",{style:{fontSize:18,fontWeight:600,marginBottom:8},children:Oe?"No routes found matching your search":"No routes found"}),(0,u.jsx)("div",{style:{fontSize:14},children:Oe?"Try adjusting your search term":"Create a new route using the button above"})]}),!Ue&&Fe.filter(e=>{var t,n;return""===Oe||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Oe.toLowerCase()))||(null===(n=e.assignedTo)||void 0===n?void 0:n.toLowerCase().includes(Oe.toLowerCase()))}).length>0&&(0,u.jsx)("div",{className:"routes-table-wrapper",style:{overflowX:"auto",maxHeight:"600px",overflowY:"auto",border:"2px solid rgba(16, 185, 129, 0.15)",borderRadius:16,background:"#fff",boxShadow:"0 4px 16px rgba(0,0,0,0.06)",position:"relative",zIndex:1},children:(0,u.jsxs)("table",{className:"routes-table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0,fontSize:14},children:[(0,u.jsx)("thead",{style:{position:"sticky",top:0,zIndex:10},children:(0,u.jsxs)("tr",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"},children:[(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Route Name"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Customers"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Pincodes"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Currently Assigned To"}),(0,u.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:700,color:"#fff",fontSize:13,textTransform:"uppercase",letterSpacing:"0.8px",borderBottom:"none",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Actions"})]})}),(0,u.jsx)("tbody",{children:Fe.filter(e=>{var t,n;return""===Oe||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Oe.toLowerCase()))||(null===(n=e.assignedTo)||void 0===n?void 0:n.toLowerCase().includes(Oe.toLowerCase()))}).map((e,t)=>{var n;return(0,u.jsxs)("tr",{style:{background:t%2===0?"#ffffff":"#f8fafc",borderBottom:"1px solid #e2e8f0",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",e.currentTarget.style.transform="scale(1.01)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.background=t%2===0?"#ffffff":"#f8fafc",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="none"},children:[(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsxs)("div",{style:{fontWeight:600,color:"#1e293b",fontSize:14,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("div",{style:{width:32,height:32,borderRadius:6,background:"#e0f2fe",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"route"})}),e.name||"Unnamed Route"]})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:e.customer_names&&e.customer_names.length>0?e.customer_names.map((e,t)=>(0,u.jsx)("div",{style:{padding:"6px 12px",background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",color:"#1e40af",borderRadius:8,fontSize:12,fontWeight:600,border:"1px solid #93c5fd",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.15)"},children:e},t)):(0,u.jsx)("div",{style:{color:"#94a3b8",fontSize:13,fontStyle:"italic"},children:"No customers"})}),(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",gap:6},children:(0,u.jsxs)("span",{style:{padding:"6px 12px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#ffffff",borderRadius:8,fontSize:12,fontWeight:700,border:"none",display:"inline-flex",alignItems:"center",gap:4,boxShadow:"0 2px 8px rgba(59, 130, 246, 0.25)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"people"}),e.customerCount||(null===(n=e.customer_names)||void 0===n?void 0:n.length)||0," total"]})})]})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:(()=>{const t=e.customer_ids||[],n=new Set;if(t.forEach(e=>{const t=dt.find(t=>t.customer_id===e);t&&t.pincode&&n.add(t.pincode)}),t.length>0&&0===n.size){const e=JSON.parse(localStorage.getItem("route_customers")||"[]");t.forEach(t=>{const a=e.find(e=>e.customer_id===t);a&&a.pincode&&n.add(a.pincode)})}const a=Array.from(n).sort();return a.length>0?a.map((e,t)=>(0,u.jsxs)("div",{style:{padding:"6px 12px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",color:"#92400e",borderRadius:8,fontSize:12,fontWeight:700,border:"1px solid #fcd34d",display:"inline-flex",alignItems:"center",gap:4,boxShadow:"0 2px 4px rgba(245, 158, 11, 0.15)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"location_on"}),e]},t)):(0,u.jsx)("div",{style:{color:"#94a3b8",fontSize:13,fontStyle:"italic"},children:"No pincodes"})})()})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:e.assignedTo?(()=>{const t=o.find(t=>t.email===e.assignedTo),n=t?t.name:e.assignedTo;return(0,u.jsxs)("div",{style:{padding:"6px 12px",background:"linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)",color:"#166534",borderRadius:8,fontSize:13,fontWeight:700,border:"1px solid #86efac",display:"inline-flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px rgba(16, 185, 129, 0.2)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#10b981"},children:"check_circle"}),n]})})():(0,u.jsxs)("div",{style:{padding:"6px 12px",background:"linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%)",color:"#64748b",borderRadius:8,fontSize:13,fontWeight:600,border:"1px solid #cbd5e1",display:"inline-flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#94a3b8"},children:"cancel"}),(0,u.jsx)("span",{style:{fontStyle:"italic"},children:"Not assigned"})]})})}),(0,u.jsx)("td",{style:{padding:"20px",verticalAlign:"top"},children:(0,u.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,u.jsxs)("button",{style:{padding:"8px 16px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",border:"none",borderRadius:10,fontSize:13,fontWeight:700,cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px rgba(59, 130, 246, 0.25)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1e40af 100%)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.35)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(59, 130, 246, 0.25)"},onClick:()=>Yn(e),children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"edit"}),"Edit"]}),(0,u.jsxs)("button",{style:{padding:"8px 16px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"#fff",border:"none",borderRadius:10,fontSize:13,fontWeight:700,cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px rgba(239, 68, 68, 0.25)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(239, 68, 68, 0.35)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(239, 68, 68, 0.25)"},onClick:()=>(async e=>{if(window.confirm('Are you sure you want to delete route "'.concat(e.name,'"?')))try{let a=!1;try{const t=await(0,d.apiPost)("/api/routes/delete",{route_id:e.id});t&&!1!==t.success&&(a=!0,console.log("\u2705 Route deleted via API"))}catch(t){console.log("\u26a0\ufe0f API not available, using localStorage:",t)}if(!a){const t=JSON.parse(localStorage.getItem("routes")||"[]").filter(t=>t.id!==e.id);localStorage.setItem("routes",JSON.stringify(t)),console.log("\u2705 Route deleted from localStorage. Remaining routes:",t.length)}try{const t=JSON.parse(localStorage.getItem("route_assignments")||"[]").filter(t=>t.route_id!==e.id);localStorage.setItem("route_assignments",JSON.stringify(t)),console.log("\u2705 Route assignments cleaned up")}catch(n){console.error("Error cleaning up route assignments:",n)}await Un(),qe(e=>e+1),alert("Route deleted successfully")}catch(n){console.error("Error deleting route:",n),alert("Failed to delete route. Please try again.")}})(e),children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"delete"}),"Delete"]})]})})]},e.id||t)})})]})})]})})]}),_&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:(0,u.jsxs)("div",{style:{width:"90%",maxWidth:900,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.2)",overflow:"hidden"},children:[(0,u.jsxs)("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#1e40af"},children:"edit"}),(0,u.jsx)("div",{style:{fontWeight:700,color:"#0f172a"},children:"Edit Company Access"})]}),(0,u.jsx)("button",{onClick:An,style:{border:"none",background:"transparent",cursor:"pointer"},children:(0,u.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,u.jsxs)("div",{style:{padding:20},children:[(0,u.jsxs)("div",{style:{marginBottom:12,color:"#475569",fontSize:14,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,u.jsx)("div",{children:C?"".concat(C.name," \u2022 ").concat(C.email):""}),C&&(0,u.jsxs)("span",{style:{padding:"6px 12px",background:"#e0f2fe",color:"#0369a1",borderRadius:12,fontSize:13,fontWeight:600,border:"1px solid #bae6fd",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"business"}),(C.companies||[]).length," companies"]})]}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#334155",fontSize:16},children:"Company Access & Settings"}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b"},children:["Selected: ",I.length," / ",Rn.length]})]}),!!Rn.length&&(0,u.jsx)("button",{type:"button",onClick:()=>{const e=Rn;e.length&&(I.length===e.length?A([]):A(e.map(e=>e.guid)))},style:{padding:"6px 12px",background:"#1e40af",color:"#fff",border:"none",borderRadius:16,fontSize:12,fontWeight:600,cursor:"pointer"},children:I.length===Rn.length?"Deselect All":"Select All"})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 16px",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderRadius:"8px 8px 0 0",fontSize:12,fontWeight:600,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,u.jsx)("div",{style:{width:20}}),(0,u.jsx)("div",{style:{flex:1},children:"Company"}),(0,u.jsx)("div",{style:{minWidth:220},children:"Role *"}),(0,u.jsx)("div",{style:{minWidth:100},children:"User Type"}),(0,u.jsx)("div",{style:{minWidth:100},children:"Cache"})]}),(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:2,maxHeight:400,overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:"0 0 8px 8px",background:"#fafbfc"},children:Rn.map(e=>{const t=I.includes(e.guid),n=T[e.guid]||{roleId:"",isExternalUser:!1};return(0,u.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",background:t?"#eff6ff":"#fff",transition:"all 0.2s"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,minHeight:48},children:[(0,u.jsx)("span",{className:"material-icons",onClick:()=>Tn(e.guid),style:{color:t?"#1e40af":"#94a3b8",fontSize:20,cursor:"pointer"},children:t?"check_box":"check_box_outline_blank"}),(0,u.jsxs)("div",{onClick:()=>Tn(e.guid),style:{fontWeight:600,color:t?"#1e40af":"#374151",fontSize:14,display:"flex",alignItems:"center",gap:6,cursor:"pointer",flex:1},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"business"}),e.company||e.companyName]}),(0,u.jsx)("div",{style:{minWidth:220},children:t?(0,u.jsxs)("select",{value:n.roleId,onChange:t=>R(s=>(0,a.A)((0,a.A)({},s),{},{[e.guid]:(0,a.A)((0,a.A)({},n),{},{roleId:t.target.value})})),disabled:h,required:!0,style:{padding:"6px 8px",borderRadius:4,border:"1px solid ".concat(n.roleId?"#d1d5db":"#dc2626"),width:"100%",fontSize:12,background:"#fff",cursor:h?"not-allowed":"pointer",boxSizing:"border-box",height:"32px"},onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("option",{value:"",children:"Select Role *"}),l.map(e=>(0,u.jsx)("option",{value:e.id,children:e.display_name},e.id))]}):(0,u.jsx)("div",{style:{height:"32px"}})}),(0,u.jsx)("div",{style:{minWidth:100},children:t?(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,u.jsxs)("label",{onClick:e=>e.stopPropagation(),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",fontSize:12,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",height:"32px",boxSizing:"border-box"},children:[(0,u.jsx)("input",{type:"checkbox",checked:n.isExternalUser,onChange:t=>R(s=>(0,a.A)((0,a.A)({},s),{},{[e.guid]:(0,a.A)((0,a.A)({},n),{},{isExternalUser:t.target.checked})})),style:{cursor:"pointer"}}),(0,u.jsx)("span",{style:{color:"#374151",fontWeight:400},children:"External"})]}),(0,u.jsx)("button",{onClick:t=>{t.stopPropagation(),Sn(e)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",transition:"all 0.2s ease",width:"24px",height:"24px"},onMouseEnter:e=>{e.target.style.background="#f1f5f9",e.target.style.color="#374151"},onMouseLeave:e=>{e.target.style.background="none",e.target.style.color="#64748b"},title:"Company Settings",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"settings"})})]}):(0,u.jsx)("div",{style:{height:"32px"}})}),(0,u.jsx)("div",{style:{minWidth:100},children:t&&n.isExternalUser&&C?(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Pe[C.email]?(0,u.jsx)("span",{style:{fontSize:12,color:"#64748b"},children:"Loading..."}):(0,u.jsxs)("label",{onClick:e=>e.stopPropagation(),style:{position:"relative",display:"inline-block",width:44,height:24,cursor:"pointer"},title:Le[C.email]?"Cache enabled for this user":"Cache disabled for this user",children:[(0,u.jsx)("input",{type:"checkbox",checked:Le[C.email]||!1,onChange:e=>{e.stopPropagation(),zn(C.email,e.target.checked)},style:{opacity:0,width:0,height:0}}),(0,u.jsx)("span",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:Le[C.email]?"#10b981":"#9ca3af",borderRadius:12,transition:"all 0.3s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:(0,u.jsx)("span",{style:{position:"absolute",top:2,left:Le[C.email]?22:2,width:20,height:20,borderRadius:"50%",backgroundColor:"#fff",transition:"all 0.3s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.2)"}})})]})}):(0,u.jsx)("div",{style:{height:"32px"}})})]})},e.guid)})})]})]}),(0,u.jsxs)("div",{style:{padding:"12px 16px",background:"#f0f9ff",borderTop:"1px solid #e5e7eb",fontSize:13,color:"#64748b",fontStyle:"italic",display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#3b82f6"},children:"info"}),(0,u.jsxs)("span",{children:[(0,u.jsx)("strong",{children:"Note:"})," External Users (Access only to Ledgers where Email matches in Ledger Master)"]})]}),(0,u.jsxs)("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[(0,u.jsx)("button",{onClick:An,style:{padding:"10px 16px",background:"#e5e7eb",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"Cancel"}),(0,u.jsx)("button",{onClick:async()=>{if(C){S(!0);try{const e=new Set(I),t=Rn.filter(t=>t&&t.guid&&e.has(t.guid)).map(e=>{const t=T[e.guid]||{roleId:"",isExternalUser:!1};return{tallyloc_id:e.tallyloc_id,company:e.company,guid:e.guid,roleId:t.roleId?parseInt(t.roleId):null,isExternalUser:t.isExternalUser}});if(0===t.length)return alert("Please select at least one company"),void S(!1);const n=t.filter(e=>!e.roleId);if(n.length>0){const e=n.map(e=>e.company).join(", ");return alert("Please select a role for the following companies: ".concat(e)),void S(!1)}const a={email:C.email,name:C.name,mobileno:C.mobileno,companies:t},s=Date.now(),o=await(0,d.apiPost)("/api/tally/internal-user-access/update?ts=".concat(s),a);!o||"success"!==o.status&&"no_changes"!==o.status?o&&"error"===o.status?(console.error("Edit save failed:",o.message),alert(o.message||"Failed to update access")):alert("Invalid response from server"):(await jn(),An())}catch(e){console.error("Error saving edit:",e),alert(e.message||"Error while saving")}finally{S(!1)}}},disabled:!C||j,style:{padding:"10px 16px",background:"#16a34a",color:"#fff",border:"none",borderRadius:8,fontWeight:700,cursor:j?"not-allowed":"pointer",opacity:j?.8:1},children:j?"Saving...":"Save"})]})]})}),E&&L&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:20},children:(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 20px 40px 0 rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"750px",height:"600px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,u.jsxs)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h3",{style:{margin:0,fontSize:20,fontWeight:600,color:"#1e40af",display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#F27020"},children:"group_work"}),"Assign Groups"]}),(0,u.jsxs)("p",{style:{margin:"4px 0 0 32px",fontSize:14,color:"#64748b"},children:[L.name," \u2022 ",(null===C||void 0===C?void 0:C.name)||(null===C||void 0===C?void 0:C.email)]}),(0,u.jsxs)("div",{style:{margin:"8px 0 0 32px",fontSize:13,color:"#0369a1",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"#0369a1"},children:"info"}),(0,u.jsxs)("span",{children:["ledger"===pe&&"Selected Groups of Ledgers will list at the time of Transactions and Reports","stock"===pe&&"Selected Group of Stockitems will list in the Transcations","stockcategory"===pe&&"Selected Category of Stockitems will list in the Transcations","vouchertype"===pe&&"This Configurations is used for Voucher Authorization - Default No TDL"]})]})]}),(0,u.jsx)("button",{onClick:wn,style:{background:"none",border:"none",fontSize:24,color:"#64748b",cursor:"pointer",padding:4},children:"\xd7"})]}),(0,u.jsx)("div",{style:{padding:"24px",overflowY:"auto",flex:1,minHeight:0,maxHeight:"calc(600px - 140px)"},children:X?(0,u.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#F27020",animation:"spin 1s linear infinite"},children:"refresh"}),(0,u.jsx)("p",{style:{margin:"16px 0 0 0"},children:"Loading groups..."})]}):(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",borderBottom:"2px solid #e2e8f0",marginBottom:24,background:"#f8fafc",borderRadius:"8px 8px 0 0"},children:[(0,u.jsxs)("button",{onClick:()=>ge("ledger"),style:{flex:1,padding:"12px 16px",border:"none",background:"ledger"===pe?"#fff":"transparent",color:"ledger"===pe?"#1e40af":"#64748b",fontWeight:"ledger"===pe?600:500,fontSize:14,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,borderRadius:"8px 0 0 0",borderBottom:"ledger"===pe?"2px solid #F27020":"2px solid transparent",transition:"all 0.2s ease",boxShadow:"ledger"===pe?"0 2px 4px rgba(0,0,0,0.1)":"none"},onMouseEnter:e=>{"ledger"!==pe&&(e.target.style.background="#f1f5f9",e.target.style.color="#374151")},onMouseLeave:e=>{"ledger"!==pe&&(e.target.style.background="transparent",e.target.style.color="#64748b")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"account_balance"}),(0,u.jsxs)("span",{style:{whiteSpace:"nowrap"},children:["Ledger Group (",kn.length,P.length!==kn.length?"/".concat(P.length):"",")"]})]}),(0,u.jsxs)("button",{onClick:()=>ge("stock"),style:{flex:1,padding:"12px 16px",border:"none",background:"stock"===pe?"#fff":"transparent",color:"stock"===pe?"#1e40af":"#64748b",fontWeight:"stock"===pe?600:500,fontSize:14,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,borderRadius:"0 0 0 0",borderBottom:"stock"===pe?"2px solid #F27020":"2px solid transparent",transition:"all 0.2s ease",boxShadow:"stock"===pe?"0 2px 4px rgba(0,0,0,0.1)":"none"},onMouseEnter:e=>{"stock"!==pe&&(e.target.style.background="#f1f5f9",e.target.style.color="#374151")},onMouseLeave:e=>{"stock"!==pe&&(e.target.style.background="transparent",e.target.style.color="#64748b")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"inventory_2"}),(0,u.jsxs)("span",{style:{whiteSpace:"nowrap"},children:["Stock Group (",_n.length,F.length!==_n.length?"/".concat(F.length):"",")"]})]}),(0,u.jsxs)("button",{onClick:()=>ge("stockcategory"),style:{flex:1,padding:"12px 16px",border:"none",background:"stockcategory"===pe?"#fff":"transparent",color:"stockcategory"===pe?"#1e40af":"#64748b",fontWeight:"stockcategory"===pe?600:500,fontSize:14,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,borderRadius:"0 0 0 0",borderBottom:"stockcategory"===pe?"2px solid #F27020":"2px solid transparent",transition:"all 0.2s ease",boxShadow:"stockcategory"===pe?"0 2px 4px rgba(0,0,0,0.1)":"none"},onMouseEnter:e=>{"stockcategory"!==pe&&(e.target.style.background="#f1f5f9",e.target.style.color="#374151")},onMouseLeave:e=>{"stockcategory"!==pe&&(e.target.style.background="transparent",e.target.style.color="#64748b")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"category"}),(0,u.jsxs)("span",{style:{whiteSpace:"nowrap"},children:["Categories (",Nn.length,U.length!==Nn.length?"/".concat(U.length):"",")"]})]}),(0,u.jsxs)("button",{onClick:()=>ge("vouchertype"),style:{flex:1,padding:"12px 16px",border:"none",background:"vouchertype"===pe?"#fff":"transparent",color:"vouchertype"===pe?"#1e40af":"#64748b",fontWeight:"vouchertype"===pe?600:500,fontSize:14,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,borderRadius:"0 8px 0 0",borderBottom:"vouchertype"===pe?"2px solid #F27020":"2px solid transparent",transition:"all 0.2s ease",boxShadow:"vouchertype"===pe?"0 2px 4px rgba(0,0,0,0.1)":"none"},onMouseEnter:e=>{"vouchertype"!==pe&&(e.target.style.background="#f1f5f9",e.target.style.color="#374151")},onMouseLeave:e=>{"vouchertype"!==pe&&(e.target.style.background="transparent",e.target.style.color="#64748b")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"receipt"}),(0,u.jsxs)("span",{style:{whiteSpace:"nowrap"},children:["VoucherType (",Cn.length,oe.length!==Cn.length?"/".concat(oe.length):"",")"]})]})]}),(0,u.jsxs)("div",{children:["ledger"===pe&&(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,padding:"12px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:Q,onChange:e=>ee(e.target.value),placeholder:"Search ledger groups...",style:{flex:1,padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:14,outline:"none",background:"#fff",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db"}),Q&&(0,u.jsx)("button",{onClick:()=>ee(""),style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",padding:"6px",borderRadius:"4px",display:"flex",alignItems:"center",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.background="#f1f5f9",onMouseLeave:e=>e.target.style.background="transparent",title:"Clear search",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"clear"})})]}),(0,u.jsx)("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,maxHeight:"320px",overflowY:"auto",background:"#fff"},children:0===kn.length?(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#cbd5e1",marginBottom:12,display:"block"},children:"account_balance"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500,marginBottom:4},children:Q?'No ledger groups found matching "'.concat(Q,'"'):"No ledger groups found"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:Q?"Try adjusting your search term":"No ledger groups are available for this company"})]}):kn.map(e=>(0,u.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"16px 20px",cursor:"pointer",borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s",background:O.includes(e.id)?"#f0f9ff":"transparent"},onMouseEnter:t=>{O.includes(e.id)||(t.target.style.background="#f8fafc")},onMouseLeave:t=>{O.includes(e.id)||(t.target.style.background="transparent")},children:[(0,u.jsx)("input",{type:"checkbox",checked:O.includes(e.id),onChange:t=>{t.target.checked?G(t=>[...t,e.id]):G(t=>t.filter(t=>t!==e.id))},style:{marginRight:16,cursor:"pointer",transform:"scale(1.2)",accentColor:"#F27020"}}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:O.includes(e.id)?"#1e40af":"#374151",fontSize:15,marginBottom:4},children:e.name}),e.description&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontStyle:"italic"},children:e.description})]}),O.includes(e.id)&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#F27020"},children:"check_circle"})]},e.id))}),O.length>0&&(0,u.jsxs)("div",{style:{fontSize:14,color:"#F27020",marginTop:12,fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),O.length," ledger group",1!==O.length?"s":""," selected"]})]}),"stock"===pe&&(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,padding:"12px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:te,onChange:e=>ne(e.target.value),placeholder:"Search stock groups...",style:{flex:1,padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:14,outline:"none",background:"#fff",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db"}),te&&(0,u.jsx)("button",{onClick:()=>ne(""),style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",padding:"6px",borderRadius:"4px",display:"flex",alignItems:"center",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.background="#f1f5f9",onMouseLeave:e=>e.target.style.background="transparent",title:"Clear search",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"clear"})})]}),(0,u.jsx)("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,maxHeight:"320px",overflowY:"auto",background:"#fff"},children:0===_n.length?(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#cbd5e1",marginBottom:12,display:"block"},children:"inventory_2"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500,marginBottom:4},children:te?'No stock groups found matching "'.concat(te,'"'):"No stock groups found"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:te?"Try adjusting your search term":"No stock groups are available for this company"})]}):_n.map(e=>(0,u.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"16px 20px",cursor:"pointer",borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s",background:H.includes(e.id)?"#f0f9ff":"transparent"},onMouseEnter:t=>{H.includes(e.id)||(t.target.style.background="#f8fafc")},onMouseLeave:t=>{H.includes(e.id)||(t.target.style.background="transparent")},children:[(0,u.jsx)("input",{type:"checkbox",checked:H.includes(e.id),onChange:t=>{t.target.checked?q(t=>[...t,e.id]):q(t=>t.filter(t=>t!==e.id))},style:{marginRight:16,cursor:"pointer",transform:"scale(1.2)",accentColor:"#F27020"}}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:H.includes(e.id)?"#1e40af":"#374151",fontSize:15,marginBottom:4},children:e.name}),e.description&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontStyle:"italic"},children:e.description})]}),H.includes(e.id)&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#F27020"},children:"check_circle"})]},e.id))}),H.length>0&&(0,u.jsxs)("div",{style:{fontSize:14,color:"#F27020",marginTop:12,fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),H.length," stock group",1!==H.length?"s":""," selected"]})]}),"stockcategory"===pe&&(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,padding:"12px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:ae,onChange:e=>se(e.target.value),placeholder:"Search stock categories...",style:{flex:1,padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:14,outline:"none",background:"#fff",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db"}),ae&&(0,u.jsx)("button",{onClick:()=>se(""),style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",padding:"6px",borderRadius:"4px",display:"flex",alignItems:"center",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.background="#f1f5f9",onMouseLeave:e=>e.target.style.background="transparent",title:"Clear search",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"clear"})})]}),(0,u.jsx)("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,maxHeight:"320px",overflowY:"auto",background:"#fff"},children:0===Nn.length?(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#cbd5e1",marginBottom:12,display:"block"},children:"category"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500,marginBottom:4},children:ae?'No stock categories found matching "'.concat(ae,'"'):"No stock categories found"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:ae?"Try adjusting your search term":"No stock categories are available for this company"})]}):Nn.map(e=>(0,u.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"16px 20px",cursor:"pointer",borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s",background:V.includes(e.id)?"#f0f9ff":"transparent"},onMouseEnter:t=>{V.includes(e.id)||(t.target.style.background="#f8fafc")},onMouseLeave:t=>{V.includes(e.id)||(t.target.style.background="transparent")},children:[(0,u.jsx)("input",{type:"checkbox",checked:V.includes(e.id),onChange:t=>{t.target.checked?J(t=>[...t,e.id]):J(t=>t.filter(t=>t!==e.id))},style:{marginRight:16,cursor:"pointer",transform:"scale(1.2)",accentColor:"#F27020"}}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:V.includes(e.id)?"#1e40af":"#374151",fontSize:15,marginBottom:4},children:e.name}),e.description&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontStyle:"italic"},children:e.description})]}),V.includes(e.id)&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#F27020"},children:"check_circle"})]},e.id))}),V.length>0&&(0,u.jsxs)("div",{style:{fontSize:14,color:"#F27020",marginTop:12,fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),V.length," stock categor",1!==V.length?"ies":"y"," selected"]})]}),"vouchertype"===pe&&(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,padding:"12px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:de,onChange:e=>ce(e.target.value),placeholder:"Search voucher types...",style:{flex:1,padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:14,outline:"none",background:"#fff",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db"}),de&&(0,u.jsx)("button",{onClick:()=>ce(""),style:{background:"none",border:"none",color:"#64748b",cursor:"pointer",padding:"6px",borderRadius:"4px",display:"flex",alignItems:"center",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.background="#f1f5f9",onMouseLeave:e=>e.target.style.background="transparent",title:"Clear search",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"clear"})})]}),(0,u.jsx)("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,maxHeight:"320px",overflowY:"auto",background:"#fff"},children:0===Cn.length?(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#cbd5e1",marginBottom:12,display:"block"},children:"receipt"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500,marginBottom:4},children:de?'No voucher types found matching "'.concat(de,'"'):"No voucher types found"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:de?"Try adjusting your search term":"No voucher types are available for this company"})]}):Cn.map(e=>(0,u.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"16px 20px",cursor:"pointer",borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s",background:ie.includes(e.id)?"#f0f9ff":"transparent"},onMouseEnter:t=>{ie.includes(e.id)||(t.target.style.background="#f8fafc")},onMouseLeave:t=>{ie.includes(e.id)||(t.target.style.background="transparent")},children:[(0,u.jsx)("input",{type:"checkbox",checked:ie.includes(e.id),onChange:t=>{t.target.checked?le(t=>[...t,e.id]):le(t=>t.filter(t=>t!==e.id))},style:{marginRight:16,cursor:"pointer",transform:"scale(1.2)",accentColor:"#F27020"}}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:ie.includes(e.id)?"#1e40af":"#374151",fontSize:15,marginBottom:4},children:e.name}),e.description&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontStyle:"italic"},children:e.description})]}),ie.includes(e.id)&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#F27020"},children:"check_circle"})]},e.id))}),ie.length>0&&(0,u.jsxs)("div",{style:{fontSize:14,color:"#F27020",marginTop:12,fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),ie.length," voucher type",1!==ie.length?"s":""," selected"]})]})]})]})}),(0,u.jsxs)("div",{style:{padding:"20px 24px",borderTop:"1px solid #e2e8f0",display:"flex",gap:12,justifyContent:"flex-end",background:"#f8fafc"},children:[(0,u.jsx)("button",{onClick:wn,style:{padding:"12px 24px",border:"1.5px solid #e2e8f0",borderRadius:8,background:"#fff",color:"#64748b",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.color="#374151"},onMouseLeave:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.color="#64748b"},children:"Cancel"}),(0,u.jsxs)("button",{onClick:async()=>{if(L&&C){console.log("\ud83d\udd0d Debug editingUser object:",C),console.log("\ud83d\udd0d editingUser.id:",C.id),console.log("\ud83d\udd0d editingUser keys:",Object.keys(C)),$(!0);try{const e=O.map(e=>{const t=P.find(t=>t.id===e);return{name:t?t.name:"",masterid:e}}),t=H.map(e=>{const t=F.find(t=>t.id===e);return{name:t?t.name:"",masterid:e}}),n=V.map(e=>{const t=U.find(t=>t.id===e);return{name:t?t.name:"",masterid:e}}),a=ie.map(e=>{const t=oe.find(t=>t.id===e);return{name:t?t.name:"",masterid:e}}),s={userid:C.id||C.user_id||C.email||C.userId,tallyloc_id:L.tallyloc_id,company_name:L.company,guid:L.guid,ledger_groups:e,stock_groups:t,stock_categories:n,voucher_types:a};console.log("\ud83d\udcbe Saving group assignments..."),console.log("\ud83d\udcbe Payload:",s);const o=Date.now(),r=await(0,d.apiPost)("/api/tally/user-groups?ts=".concat(o),s);console.log("\ud83d\udcbe Save response:",r),r&&(r.success||"success"===r.status)?(W(!1),console.log("\u2705 Group assignments saved successfully")):console.error("\u274c Failed to save group assignments:",r)}catch(e){console.error("\u274c Error saving group assignments:",e)}finally{$(!1)}}else console.error("\u274c Missing required data for saving:",{selectedCompanyForGroups:L,editingUser:C})},disabled:Z,style:{padding:"12px 24px",border:"none",borderRadius:8,background:"linear-gradient(135deg, #F27020 0%, #e55a00 100%)",color:"#fff",fontSize:14,fontWeight:600,cursor:Z?"not-allowed":"pointer",opacity:Z?.7:1,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{Z||(e.target.style.transform="scale(1.05)")},onMouseLeave:e=>{Z||(e.target.style.transform="scale(1)")},children:[Z&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,animation:"spin 1s linear infinite"},children:"refresh"}),Z?"Saving...":"Save Groups"]})]})]})}),Ve&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20,animation:"fadeIn 0.2s ease-in"},children:(0,u.jsxs)("div",{style:{width:"100%",maxWidth:900,maxHeight:"90vh",background:"#fff",borderRadius:20,boxShadow:"0 25px 60px rgba(0,0,0,0.25)",overflow:"hidden",display:"flex",flexDirection:"column",animation:"slideUp 0.3s ease-out"},children:[(0,u.jsxs)("div",{style:{padding:"24px 28px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:48,height:48,borderRadius:12,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:28},children:"route"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#fff",fontSize:22,marginBottom:2},children:"Create Route"}),(0,u.jsx)("div",{style:{fontSize:13,color:"rgba(255,255,255,0.8)",fontWeight:500},children:"Add a new route with customers"})]})]}),(0,u.jsx)("button",{onClick:()=>Je(!1),style:{border:"none",background:"rgba(255,255,255,0.2)",cursor:"pointer",fontSize:24,color:"#fff",width:36,height:36,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(255,255,255,0.3)",e.target.style.transform="rotate(90deg)"},onMouseLeave:e=>{e.target.style.background="rgba(255,255,255,0.2)",e.target.style.transform="rotate(0deg)"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:28,overflowY:"auto",flex:1,background:"#f8fafc"},children:[(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"label"}),"Route Name ",(0,u.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"text",value:Xe,onChange:e=>Ke(e.target.value),placeholder:"Enter route name",style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8"},children:"route"})]})]}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"description"}),"Description ",(0,u.jsx)("span",{style:{color:"#64748b",fontSize:13,fontWeight:400},children:"(Optional)"})]}),(0,u.jsx)("textarea",{value:Ze,onChange:e=>$e(e.target.value),placeholder:"Enter route description",rows:3,style:{padding:"14px 16px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}})]}),Wn.length>0&&(0,u.jsxs)("div",{style:{marginBottom:24,padding:20,background:"#fff",borderRadius:16,border:"1px solid #e2e8f0",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:12,display:"flex",alignItems:"center",gap:8,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"business"}),"Filter by Company",(0,u.jsxs)("span",{style:{marginLeft:"auto",fontSize:12,fontWeight:500,color:"#64748b",background:"#f1f5f9",padding:"4px 10px",borderRadius:12},children:[ht.length," of ",Wn.length," selected"]})]}),(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:Wn.map(e=>{const t=ht.includes(e);return(0,u.jsxs)("button",{onClick:()=>{bt(t?t=>t.filter(t=>t!==e):t=>[...t,e])},style:{padding:"10px 18px",borderRadius:10,border:"2px solid ".concat(t?"#3b82f6":"#e2e8f0"),background:t?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"#fff",color:t?"#fff":"#475569",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:8,boxShadow:t?"0 4px 12px rgba(59, 130, 246, 0.3)":"0 1px 3px rgba(0,0,0,0.05)",transform:t?"translateY(-1px)":"translateY(0)"},onMouseEnter:e=>{t?(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(59, 130, 246, 0.4)"):(e.target.style.borderColor="#3b82f6",e.target.style.background="#eff6ff",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)")},onMouseLeave:e=>{t?(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)"):(e.target.style.borderColor="#e2e8f0",e.target.style.background="#fff",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)")},children:[t&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),!t&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#cbd5e1"},children:"radio_button_unchecked"}),e]},e)})})]}),(0,u.jsxs)("div",{style:{marginBottom:24,padding:20,background:"#fff",borderRadius:16,border:"1px solid #e2e8f0",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",fontSize:15,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"keyword"===ot?"search":"location_on"}),"keyword"===ot?"Filter by Keyword":"Filter by Pincode",(0,u.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,background:"#f1f5f9",padding:"4px",borderRadius:10},children:[(0,u.jsx)("span",{style:{fontSize:12,color:"keyword"===ot?"#3b82f6":"#64748b",fontWeight:"keyword"===ot?600:400,padding:"4px 8px"},children:"Keyword"}),(0,u.jsxs)("label",{style:{position:"relative",display:"inline-block",width:48,height:26},children:[(0,u.jsx)("input",{type:"checkbox",checked:"pincode"===ot,onChange:e=>{const t=e.target.checked?"pincode":"keyword";rt(t),"pincode"===t?st(""):(et(""),nt(""))},style:{display:"none"}}),(0,u.jsx)("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"pincode"===ot?"#3b82f6":"#cbd5e1",borderRadius:26,transition:"all 0.3s",display:"flex",alignItems:"center",padding:"2px",boxShadow:"pincode"===ot?"0 2px 8px rgba(59, 130, 246, 0.3)":"none"},children:(0,u.jsx)("span",{style:{content:'""',position:"absolute",height:22,width:22,left:"pincode"===ot?"22px":"2px",bottom:"2px",backgroundColor:"#fff",borderRadius:"50%",transition:"all 0.3s",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"}})})]}),(0,u.jsx)("span",{style:{fontSize:12,color:"pincode"===ot?"#3b82f6":"#64748b",fontWeight:"pincode"===ot?600:400,padding:"4px 8px"},children:"Pincode"})]})]}),"pincode"===ot?(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"text",value:Qe,onChange:e=>{et(e.target.value),e.target.value.trim()||nt("")},placeholder:"Type pincode to search...",style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8"},children:"location_on"}),Bn.length>0&&(0,u.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,marginTop:8,maxHeight:240,overflowY:"auto",zIndex:1e3,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},children:Bn.map(e=>(0,u.jsxs)("div",{onClick:()=>{et(e),nt(e)},style:{padding:"14px 16px",cursor:"pointer",borderBottom:"1px solid #f1f5f9",transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#f0f9ff",e.target.style.paddingLeft="20px"},onMouseLeave:e=>{e.target.style.background="#fff",e.target.style.paddingLeft="16px"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"location_on"}),(0,u.jsx)("span",{style:{fontWeight:500},children:e})]},e))}),tt&&(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,padding:"12px 16px",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:10,border:"1px solid #bfdbfe"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"check_circle"}),(0,u.jsxs)("span",{style:{fontSize:14,color:"#1e40af",fontWeight:600},children:["Selected: ",tt]})]}),(0,u.jsx)("button",{onClick:()=>{et(""),nt("")},style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",cursor:"pointer",fontSize:12,fontWeight:600,padding:"6px 12px",borderRadius:6,transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(59, 130, 246, 0.2)"},onMouseLeave:e=>{e.target.style.background="rgba(59, 130, 246, 0.1)"},children:"Clear"})]})]}):(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"text",value:at,onChange:e=>{st(e.target.value)},placeholder:"Search by name, pincode, address, company, or any keyword...",style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8"},children:"search"})]}),at.trim()&&(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,padding:"12px 16px",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:10,border:"1px solid #bfdbfe"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"info"}),(0,u.jsxs)("span",{style:{fontSize:14,color:"#1e40af",fontWeight:600},children:[Pn.length," customer(s) found"]})]}),(0,u.jsx)("button",{onClick:()=>{st("")},style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",cursor:"pointer",fontSize:12,fontWeight:600,padding:"6px 12px",borderRadius:6,transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(59, 130, 246, 0.2)"},onMouseLeave:e=>{e.target.style.background="rgba(59, 130, 246, 0.1)"},children:"Clear"})]})]})]}),it.length>0&&(0,u.jsxs)("div",{style:{marginBottom:20,padding:16,background:"#f0f9ff",borderRadius:8,border:"1px solid #bae6fd"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#0369a1",fontSize:14},children:["Selected Customers (",it.length," total)"]}),(0,u.jsx)("button",{onClick:()=>lt([]),style:{background:"none",border:"none",color:"#0369a1",cursor:"pointer",fontSize:14,fontWeight:600,textDecoration:"underline"},children:"Clear All"})]}),(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:it.map(e=>{const t=dt.find(t=>t.customer_id===e);return t?(0,u.jsxs)("div",{style:{padding:"8px 12px",background:"#fff",border:"1px solid #7dd3fc",borderRadius:6,fontSize:13,color:"#0369a1",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{style:{fontWeight:600},children:t.name}),(0,u.jsxs)("span",{style:{color:"#64748b",fontSize:12},children:["(",t.pincode,")"]}),(0,u.jsx)("button",{onClick:()=>lt(t=>t.filter(t=>t!==e)),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",fontSize:16,padding:0,marginLeft:4,display:"flex",alignItems:"center"},title:"Remove",children:"\xd7"})]},e):null})})]}),("pincode"===ot&&tt||"keyword"===ot&&at.trim())&&(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",fontSize:14},children:"pincode"===ot?"Customers in Pincode ".concat(tt," (").concat(Pn.filter(e=>it.includes(e.id)).length," selected)"):"Search Results (".concat(Pn.filter(e=>it.includes(e.id)).length," selected)")})}),pt?(0,u.jsxs)("div",{style:{textAlign:"center",padding:40,color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500},children:"Loading customers..."})]}):0===Pn.length?(0,u.jsx)("div",{style:{textAlign:"center",padding:40,color:"#64748b",background:"#f8fafc",borderRadius:8},children:(0,u.jsx)("div",{style:{fontSize:14},children:"pincode"===ot?"No customers found for pincode ".concat(tt):'No customers found matching "'.concat(at,'"')})}):(0,u.jsx)("div",{style:{maxHeight:300,overflowY:"auto",border:"1px solid #e2e8f0",borderRadius:8,background:"#fff"},children:Pn.map(e=>{var t,n;const a=it.includes(e.id),s=null!==e.latitude&&null!==e.longitude;return(0,u.jsx)("div",{style:{padding:16,borderBottom:"1px solid #f1f5f9",background:a?"#f0f9ff":"#fff"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("div",{onClick:()=>{lt(a?t=>t.filter(t=>t!==e.id):t=>[...t,e.id])},style:{width:24,height:24,borderRadius:4,border:"2px solid ".concat(a?"#3b82f6":"#d1d5db"),background:a?"#3b82f6":"#fff",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",marginTop:2,flexShrink:0},children:a&&(0,u.jsx)("span",{style:{color:"#fff",fontSize:16,fontWeight:"bold"},children:"\u2713"})}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:a?"#1e40af":"#1e293b",marginBottom:4},children:e.name}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginBottom:4},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,verticalAlign:"middle",marginRight:4},children:"business"}),e.companyName]}),e.address&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",marginBottom:4},children:e.address}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#94a3b8"},children:["Pincode: ",e.pincode]}),s?(0,u.jsxs)("div",{style:{fontSize:12,color:"#10b981",marginTop:4,fontWeight:500},children:["\ud83d\udccd ",null===(t=e.latitude)||void 0===t?void 0:t.toFixed(6),", ",null===(n=e.longitude)||void 0===n?void 0:n.toFixed(6)]}):(0,u.jsx)("div",{style:{fontSize:12,color:"#f59e0b",marginTop:4,fontStyle:"italic"},children:"No coordinates set"})]}),(0,u.jsx)("button",{onClick:()=>(e=>{var t,n;qt(e),Jt((null===(t=e.latitude)||void 0===t?void 0:t.toString())||""),Kt((null===(n=e.longitude)||void 0===n?void 0:n.toString())||""),Gt(!0)})(e),style:{padding:"6px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer",flexShrink:0},children:"Edit"})]})},e.id)})})]})]}),(0,u.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e2e8f0",background:"#fff",display:"flex",justifyContent:"flex-end",gap:12,boxShadow:"0 -4px 12px rgba(0,0,0,0.04)"},children:[(0,u.jsx)("button",{onClick:()=>Je(!1),style:{padding:"12px 24px",background:"#f1f5f9",border:"none",borderRadius:12,fontWeight:600,cursor:"pointer",color:"#475569",fontSize:15,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#e2e8f0",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="#f1f5f9",e.target.style.transform="translateY(0)"},children:"Cancel"}),(0,u.jsxs)("button",{onClick:async()=>{if(!Xe.trim())return void alert("Please enter a route name");if(0===it.length)return void alert("Please select at least one customer");const e=sessionStorage.getItem("email");if(e){mt(!0);try{const n=it.map(e=>{const t=dt.find(t=>t.customer_id===e);return(null===t||void 0===t?void 0:t.name)||e}),a=it.map(e=>{var t,n,a,s;const o=dt.find(t=>t.customer_id===e),r=ut[e]||{latitude:null,longitude:null};return{latitude:null!==(t=null!==(n=r.latitude)&&void 0!==n?n:null===o||void 0===o?void 0:o.latitude)&&void 0!==t?t:null,longitude:null!==(a=null!==(s=r.longitude)&&void 0!==s?s:null===o||void 0===o?void 0:o.longitude)&&void 0!==a?a:null}}),s={id:Date.now().toString(),name:Xe.trim(),description:Ze.trim()||null,created_by:e,created_at:(new Date).toISOString(),customer_ids:it,customer_names:n,customer_coordinates:a,assignedTo:null,customerCount:it.length};let o=!1;try{const e=await(0,d.apiPost)("/api/routes",s);e&&!1!==e.success&&(o=!0,console.log("\u2705 Route saved via API"))}catch(t){console.log("\u26a0\ufe0f API not available, using localStorage:",t)}if(!o){const e=JSON.parse(localStorage.getItem("routes")||"[]");e.push(s),localStorage.setItem("routes",JSON.stringify(e)),console.log("\u2705 Route saved to localStorage. Total routes:",e.length),console.log("\ud83d\udccb Saved route:",s)}await Un();const r=JSON.parse(localStorage.getItem("routes")||"[]");console.log("\ud83d\udd04 Routes refreshed. Current routes count:",r.length),console.log("\ud83d\udccb All routes:",r.map(e=>({id:e.id,name:e.name,customers:e.customerCount}))),Ke(""),$e(""),nt(""),et(""),st(""),rt("keyword"),lt([]),Je(!1),alert("Route created successfully! Total routes: ".concat(r.length))}catch(n){console.error("Error creating route:",n),alert("Failed to create route. Please try again.")}finally{mt(!1)}}else alert("User information not available")},disabled:ft||!Xe.trim()||0===it.length,style:{padding:"12px 28px",background:ft||!Xe.trim()||0===it.length?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:700,cursor:ft||!Xe.trim()||0===it.length?"not-allowed":"pointer",opacity:ft?.8:1,display:"flex",alignItems:"center",gap:8,fontSize:15,boxShadow:ft||!Xe.trim()||0===it.length?"none":"0 4px 12px rgba(22, 163, 74, 0.3)",transition:"all 0.2s"},onMouseEnter:e=>{!ft&&Xe.trim()&&it.length>0&&(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(22, 163, 74, 0.4)")},onMouseLeave:e=>{!ft&&Xe.trim()&&it.length>0&&(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(22, 163, 74, 0.3)")},children:[ft&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,animation:"spin 1s linear infinite"},children:"sync"}),!ft&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"add_circle"}),ft?"Creating...":"Create Route"]})]})]})}),yt&&jt&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20,animation:"fadeIn 0.2s ease-in"},children:(0,u.jsxs)("div",{style:{width:"100%",maxWidth:900,maxHeight:"90vh",background:"#fff",borderRadius:20,boxShadow:"0 25px 60px rgba(0,0,0,0.25)",overflow:"hidden",display:"flex",flexDirection:"column",animation:"slideUp 0.3s ease-out"},children:[(0,u.jsxs)("div",{style:{padding:"24px 28px",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(139, 92, 246, 0.3)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:48,height:48,borderRadius:12,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:28},children:"edit"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#fff",fontSize:22,marginBottom:2},children:"Edit Route"}),(0,u.jsx)("div",{style:{fontSize:13,color:"rgba(255,255,255,0.8)",fontWeight:500},children:"Update route details and customers"})]})]}),(0,u.jsx)("button",{onClick:()=>{vt(!1),St(null),kt(""),Nt(""),At(""),zt(""),Rt(""),Wt("keyword"),Bt([]),Mt({}),Yt([])},style:{border:"none",background:"rgba(255,255,255,0.2)",cursor:"pointer",fontSize:24,color:"#fff",width:36,height:36,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(255,255,255,0.3)",e.target.style.transform="rotate(90deg)"},onMouseLeave:e=>{e.target.style.background="rgba(255,255,255,0.2)",e.target.style.transform="rotate(0deg)"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:28,overflowY:"auto",flex:1,background:"#f8fafc"},children:[(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#8b5cf6"},children:"label"}),"Route Name ",(0,u.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"text",value:wt,onChange:e=>kt(e.target.value),placeholder:"Enter route name",style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#8b5cf6",e.target.style.boxShadow="0 0 0 3px rgba(139, 92, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8"},children:"route"})]})]}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#8b5cf6"},children:"description"}),"Description ",(0,u.jsx)("span",{style:{color:"#64748b",fontSize:13,fontWeight:400},children:"(Optional)"})]}),(0,u.jsx)("textarea",{value:_t,onChange:e=>Nt(e.target.value),placeholder:"Enter route description",rows:3,style:{padding:"14px 16px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#8b5cf6",e.target.style.boxShadow="0 0 0 3px rgba(139, 92, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}})]}),Wn.length>0&&(0,u.jsxs)("div",{style:{marginBottom:16},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",marginBottom:8,display:"block",fontSize:14},children:"Filter by Company"}),(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Wn.map(e=>{const t=Ut.includes(e);return(0,u.jsxs)("button",{onClick:()=>{Yt(t?t=>t.filter(t=>t!==e):t=>[...t,e])},style:{padding:"8px 16px",borderRadius:6,border:"2px solid ".concat(t?"#3b82f6":"#e5e7eb"),background:t?"#3b82f6":"#fff",color:t?"#fff":"#374151",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:6},onMouseEnter:e=>{t||(e.target.style.borderColor="#3b82f6",e.target.style.background="#eff6ff")},onMouseLeave:e=>{t||(e.target.style.borderColor="#e5e7eb",e.target.style.background="#fff")},children:[t&&(0,u.jsx)("span",{style:{fontSize:14},children:"\u2713"}),e]},e)})})]}),(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",fontSize:14},children:"keyword"===Et?"Filter by Keyword":"Filter by Pincode"}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{style:{fontSize:12,color:"keyword"===Et?"#3b82f6":"#64748b",fontWeight:"keyword"===Et?600:400,padding:"4px 8px"},children:"Keyword"}),(0,u.jsxs)("label",{style:{position:"relative",display:"inline-block",width:44,height:24},children:[(0,u.jsx)("input",{type:"checkbox",checked:"pincode"===Et,onChange:e=>{const t=e.target.checked?"pincode":"keyword";Wt(t),"pincode"===t?Rt(""):(zt(""),At(""))},style:{display:"none"}}),(0,u.jsx)("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"pincode"===Et?"#3b82f6":"#cbd5e1",borderRadius:24,transition:"background-color 0.3s",display:"flex",alignItems:"center",padding:"2px"},children:(0,u.jsx)("span",{style:{content:'""',position:"absolute",height:20,width:20,left:"pincode"===Et?"22px":"2px",bottom:"2px",backgroundColor:"#fff",borderRadius:"50%",transition:"left 0.3s",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})})]}),(0,u.jsx)("span",{style:{fontSize:12,color:"pincode"===Et?"#3b82f6":"#64748b",fontWeight:"pincode"===Et?600:400,padding:"4px 8px"},children:"Pincode"})]})]}),"pincode"===Et?(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"text",value:Ct,onChange:e=>{zt(e.target.value),e.target.value.trim()||At("")},placeholder:"Type pincode to search...",style:{padding:"12px 16px",borderRadius:8,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box"}}),Fn.length>0&&(0,u.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,marginTop:4,maxHeight:200,overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:Fn.map(e=>(0,u.jsx)("div",{onClick:()=>{zt(e),At(e)},style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid #f1f5f9"},onMouseEnter:e=>e.target.style.background="#f8fafc",onMouseLeave:e=>e.target.style.background="#fff",children:e},e))}),It&&(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8,padding:"8px 12px",background:"#f0f9ff",borderRadius:6},children:[(0,u.jsxs)("span",{style:{fontSize:14,color:"#0369a1",fontWeight:600},children:["Selected: ",It]}),(0,u.jsx)("button",{onClick:()=>{zt(""),At("")},style:{background:"none",border:"none",color:"#0369a1",cursor:"pointer",fontSize:14,fontWeight:600,textDecoration:"underline"},children:"Clear"})]})]}):(0,u.jsxs)("div",{children:[(0,u.jsx)("input",{type:"text",value:Tt,onChange:e=>{Rt(e.target.value)},placeholder:"Search by name, pincode, address, company, or any keyword...",style:{padding:"12px 16px",borderRadius:8,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box"}}),Tt.trim()&&(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8,padding:"8px 12px",background:"#f0f9ff",borderRadius:6},children:[(0,u.jsxs)("span",{style:{fontSize:14,color:"#0369a1",fontWeight:600},children:[Dn.length," customer(s) found"]}),(0,u.jsx)("button",{onClick:()=>{Rt("")},style:{background:"none",border:"none",color:"#0369a1",cursor:"pointer",fontSize:14,fontWeight:600,textDecoration:"underline"},children:"Clear"})]})]})]}),Lt.length>0&&(0,u.jsxs)("div",{style:{marginBottom:20,padding:16,background:"#f0f9ff",borderRadius:8,border:"1px solid #bae6fd"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#0369a1",fontSize:14},children:["Selected Customers (",Lt.length," total)"]}),(0,u.jsx)("button",{onClick:()=>Bt([]),style:{background:"none",border:"none",color:"#0369a1",cursor:"pointer",fontSize:14,fontWeight:600,textDecoration:"underline"},children:"Clear All"})]}),(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Lt.map(e=>{const t=dt.find(t=>t.customer_id===e);return t?(0,u.jsxs)("div",{style:{padding:"8px 12px",background:"#fff",border:"1px solid #7dd3fc",borderRadius:6,fontSize:13,color:"#0369a1",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{style:{fontWeight:600},children:t.name}),(0,u.jsxs)("span",{style:{color:"#64748b",fontSize:12},children:["(",t.pincode,")"]}),(0,u.jsx)("button",{onClick:()=>Bt(t=>t.filter(t=>t!==e)),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",fontSize:16,padding:0,marginLeft:4,display:"flex",alignItems:"center"},title:"Remove",children:"\xd7"})]},e):null})})]}),("pincode"===Et&&It||"keyword"===Et&&Tt.trim())&&(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",fontSize:14},children:"pincode"===Et?"Customers in Pincode ".concat(It," (").concat(Dn.filter(e=>Lt.includes(e.id)).length," selected)"):"Search Results (".concat(Dn.filter(e=>Lt.includes(e.id)).length," selected)")})}),pt?(0,u.jsxs)("div",{style:{textAlign:"center",padding:40,color:"#64748b"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#3b82f6",marginBottom:16,display:"block"},children:"sync"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:500},children:"Loading customers..."})]}):0===Dn.length?(0,u.jsx)("div",{style:{textAlign:"center",padding:40,color:"#64748b",background:"#f8fafc",borderRadius:8},children:(0,u.jsx)("div",{style:{fontSize:14},children:"pincode"===Et?"No customers found for pincode ".concat(It):'No customers found matching "'.concat(Tt,'"')})}):(0,u.jsx)("div",{style:{maxHeight:300,overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:8},children:Dn.map(e=>{var t,n;const a=Lt.includes(e.id),s=e.latitude&&e.longitude;return(0,u.jsx)("div",{onClick:()=>{Bt(a?t=>t.filter(t=>t!==e.id):t=>[...t,e.id])},style:{padding:16,borderBottom:"1px solid #f1f5f9",cursor:"pointer",background:a?"#eff6ff":"#fff",transition:"background 0.2s"},onMouseEnter:e=>{a||(e.target.style.background="#f8fafc")},onMouseLeave:e=>{a||(e.target.style.background="#fff")},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[(0,u.jsx)("div",{style:{width:24,height:24,borderRadius:4,border:"2px solid ".concat(a?"#3b82f6":"#d1d5db"),background:a?"#3b82f6":"#fff",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",marginTop:2,flexShrink:0},children:a&&(0,u.jsx)("span",{style:{color:"#fff",fontSize:16,fontWeight:"bold"},children:"\u2713"})}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:a?"#1e40af":"#1e293b",marginBottom:4},children:e.name}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginBottom:4},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:14,verticalAlign:"middle",marginRight:4},children:"business"}),e.companyName]}),e.address&&(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",marginBottom:4},children:e.address}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#94a3b8"},children:["Pincode: ",e.pincode]}),s?(0,u.jsxs)("div",{style:{fontSize:12,color:"#10b981",marginTop:4,fontWeight:500},children:["\ud83d\udccd ",null===(t=e.latitude)||void 0===t?void 0:t.toFixed(6),", ",null===(n=e.longitude)||void 0===n?void 0:n.toFixed(6)]}):(0,u.jsx)("div",{style:{fontSize:12,color:"#f59e0b",marginTop:4,fontStyle:"italic"},children:"No coordinates set"})]}),(0,u.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{var t,n;qt(e),Jt((null===(t=e.latitude)||void 0===t?void 0:t.toString())||""),Kt((null===(n=e.longitude)||void 0===n?void 0:n.toString())||""),Gt(!0)})(e)},style:{padding:"6px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer",flexShrink:0},children:"Edit"})]})},e.id)})})]})]}),(0,u.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e2e8f0",background:"#fff",display:"flex",justifyContent:"flex-end",gap:12,boxShadow:"0 -4px 12px rgba(0,0,0,0.04)"},children:[(0,u.jsx)("button",{onClick:()=>{vt(!1),St(null),kt(""),Nt(""),At(""),zt(""),Bt([]),Mt({})},style:{padding:"12px 24px",background:"#f1f5f9",color:"#475569",border:"none",borderRadius:12,fontWeight:600,cursor:"pointer",fontSize:15,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#e2e8f0",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="#f1f5f9",e.target.style.transform="translateY(0)"},children:"Cancel"}),(0,u.jsxs)("button",{onClick:async()=>{if(wt.trim())if(0!==Lt.length){Dt(!0);try{sessionStorage.getItem("email");const t=Lt.map(e=>{const t=dt.find(t=>t.customer_id===e);return(null===t||void 0===t?void 0:t.name)||e}),n=Lt.map(e=>{var t,n,a,s;const o=dt.find(t=>t.customer_id===e),r=Pt[e]||{latitude:null,longitude:null};return{latitude:null!==(t=null!==(n=r.latitude)&&void 0!==n?n:null===o||void 0===o?void 0:o.latitude)&&void 0!==t?t:null,longitude:null!==(a=null!==(s=r.longitude)&&void 0!==s?s:null===o||void 0===o?void 0:o.longitude)&&void 0!==a?a:null}}),s=(0,a.A)((0,a.A)({},jt),{},{name:wt.trim(),description:_t.trim()||null,customer_ids:Lt,customer_names:t,customer_coordinates:n,customerCount:Lt.length,updated_at:(new Date).toISOString()});let o=!1;try{const e=await(0,d.mu)("/api/routes/".concat(jt.id),s);e&&!1!==e.success&&(o=!0,console.log("\u2705 Route updated via API"))}catch(e){console.log("\u26a0\ufe0f API not available, using localStorage:",e)}if(!o){const e=JSON.parse(localStorage.getItem("routes")||"[]").map(e=>e.id===jt.id?s:e);localStorage.setItem("routes",JSON.stringify(e)),console.log("\u2705 Route updated in localStorage")}await Un(),kt(""),Nt(""),At(""),zt(""),Rt(""),Wt("keyword"),Bt([]),Mt({}),St(null),vt(!1),alert("Route updated successfully")}catch(t){console.error("Error updating route:",t),alert("Failed to update route. Please try again.")}finally{Dt(!1)}}else alert("Please select at least one customer");else alert("Please enter a route name")},disabled:Ft||!wt.trim()||0===Lt.length,style:{padding:"12px 28px",background:Ft||!wt.trim()||0===Lt.length?"#cbd5e1":"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:700,cursor:Ft||!wt.trim()||0===Lt.length?"not-allowed":"pointer",opacity:Ft?.8:1,display:"flex",alignItems:"center",gap:8,fontSize:15,boxShadow:Ft||!wt.trim()||0===Lt.length?"none":"0 4px 12px rgba(139, 92, 246, 0.3)",transition:"all 0.2s"},onMouseEnter:e=>{!Ft&&wt.trim()&&Lt.length>0&&(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(139, 92, 246, 0.4)")},onMouseLeave:e=>{!Ft&&wt.trim()&&Lt.length>0&&(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(139, 92, 246, 0.3)")},children:[Ft&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,animation:"spin 1s linear infinite"},children:"sync"}),!Ft&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"save"}),Ft?"Updating...":"Update Route"]})]})]})}),Ot&&Ht&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:20},children:(0,u.jsxs)("div",{style:{width:"100%",maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden"},children:[(0,u.jsxs)("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#0f172a",fontSize:18},children:"Edit Coordinates"}),(0,u.jsx)("button",{onClick:()=>Gt(!1),style:{border:"none",background:"transparent",cursor:"pointer",fontSize:24,color:"#64748b"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:20},children:[(0,u.jsxs)("div",{style:{marginBottom:16},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#1e40af",marginBottom:4},children:Ht.name}),(0,u.jsx)("div",{style:{fontSize:14,color:"#64748b"},children:Ht.address})]}),(0,u.jsxs)("div",{style:{marginBottom:20,display:"flex",gap:8},children:[(0,u.jsxs)("button",{onClick:async()=>{if(Ht&&Ht.address){$t(!0);try{console.log("Fetching coordinates for address:",Ht.address);const e=await(async e=>{if(!e||!e.trim())return console.error("Geocoding: Empty address provided"),null;try{const a=e.trim();console.log("Geocoding address:",a);const s=["https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(a),"&limit=1&addressdetails=1"),a.includes(",")?"https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(a.split(",").slice(-2).join(",").trim()),"&limit=1&addressdetails=1"):null,a.includes(",")?"https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(a.split(",").pop().trim()),"&limit=1&addressdetails=1"):null].filter(Boolean);for(const e of s)try{console.log("Trying geocoding URL:",e);const n=new AbortController,o=setTimeout(()=>n.abort(),1e4);let r,i;try{r=await fetch(e,{method:"GET",headers:{"User-Agent":"DataLynkr/1.0 (Contact: support@datalynkr.com)",Accept:"application/json","Accept-Language":"en-US,en;q=0.9"},signal:n.signal,mode:"cors"})}catch(t){console.warn("Direct fetch failed, trying CORS proxy:",t);const a="https://api.allorigins.win/get?url=".concat(encodeURIComponent(e)),s=await fetch(a,{signal:n.signal,mode:"cors"});if(!s.ok)throw t;{const e=await s.json(),t=JSON.parse(e.contents);r={ok:!0,json:async()=>t}}}if(clearTimeout(o),r.json&&"function"===typeof r.json){if(!r.ok){console.warn("Geocoding response not OK:",r.status,r.statusText),await new Promise(e=>setTimeout(e,1e3));continue}i=await r.json()}else i=r;if(console.log("Geocoding response:",i),i&&Array.isArray(i)&&i.length>0){const e=i[0],t=parseFloat(e.lat),n=parseFloat(e.lon);if(!isNaN(t)&&!isNaN(n)&&t>=-90&&t<=90&&n>=-180&&n<=180)return console.log("Geocoding success:",{lat:t,lng:n,displayName:e.display_name}),{latitude:t,longitude:n,displayName:e.display_name||a};console.warn("Invalid coordinates returned:",{lat:t,lng:n})}else console.warn("No results found for address:",a);s.indexOf(e)<s.length-1&&await new Promise(e=>setTimeout(e,1e3))}catch(n){if(console.error("Geocoding fetch error:",n),"TypeError"===n.name||"AbortError"===n.name)continue;await new Promise(e=>setTimeout(e,1e3))}return console.error("All geocoding strategies failed for address:",a),null}catch(a){return console.error("Geocoding error:",a),null}})(Ht.address);e?(Jt(e.latitude.toString()),Kt(e.longitude.toString()),console.log("Coordinates successfully fetched:",e),alert("Coordinates fetched successfully!\nLocation: ".concat(e.displayName,"\nLat: ").concat(e.latitude.toFixed(6),", Lng: ").concat(e.longitude.toFixed(6)))):(console.error("Geocoding returned null for address:",Ht.address),alert('Could not find coordinates for this address. The address might be too specific or incomplete. Please try:\n\n1. Using "Select on Map" to pick the location manually\n2. Entering coordinates manually\n3. Checking if the address format is correct'))}catch(e){console.error("Geocoding error in handleFetchFromAddress:",e),alert("Failed to fetch coordinates: ".concat(e.message||"Unknown error",'\n\nPlease try:\n1. Using "Select on Map" to pick the location\n2. Entering coordinates manually'))}finally{$t(!1)}}else alert("No address available for this customer")},disabled:Zt||!Ht.address,style:{flex:1,padding:"10px 16px",background:Zt||!Ht.address?"#9ca3af":"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:Zt||!Ht.address?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[Zt?(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,animation:"spin 1s linear infinite"},children:"sync"}):(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"location_on"}),Zt?"Fetching...":"Fetch from Address"]}),(0,u.jsxs)("button",{onClick:()=>{const e="https://www.google.com/maps?q=".concat(Vt||"0",",").concat(Xt||"0");window.open(e,"_blank"),alert("Please select location on Google Maps, then copy coordinates and paste them below.")},style:{flex:1,padding:"10px 16px",background:"#10b981",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"map"}),"Select on Map"]})]}),(0,u.jsxs)("div",{style:{marginBottom:16},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",marginBottom:8,display:"block",fontSize:14},children:"Latitude (-90 to 90)"}),(0,u.jsx)("input",{type:"number",step:"any",value:Vt,onChange:e=>Jt(e.target.value),placeholder:"e.g., 12.9716",style:{padding:"12px 16px",borderRadius:8,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box"}})]}),(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",marginBottom:8,display:"block",fontSize:14},children:"Longitude (-180 to 180)"}),(0,u.jsx)("input",{type:"number",step:"any",value:Xt,onChange:e=>Kt(e.target.value),placeholder:"e.g., 77.5946",style:{padding:"12px 16px",borderRadius:8,border:"2px solid #e5e7eb",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box"}})]})]}),(0,u.jsxs)("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[(0,u.jsx)("button",{onClick:()=>{Gt(!1),qt(null),Jt(""),Kt("")},style:{padding:"10px 20px",background:"#e5e7eb",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer",color:"#374151"},children:"Cancel"}),(0,u.jsx)("button",{onClick:async()=>{if(!Ht)return;const e=Vt.trim()?parseFloat(Vt.trim()):null,t=Xt.trim()?parseFloat(Xt.trim()):null;if(Vt.trim()&&(isNaN(e)||e<-90||e>90))return void alert("Latitude must be between -90 and 90");if(Xt.trim()&&(isNaN(t)||t<-180||t>180))return void alert("Longitude must be between -180 and 180");yt&&jt?Mt(n=>(0,a.A)((0,a.A)({},n),{},{[Ht.id]:{latitude:e,longitude:t}})):xt(n=>(0,a.A)((0,a.A)({},n),{},{[Ht.id]:{latitude:e,longitude:t}}));try{const n=JSON.parse(localStorage.getItem("route_customers")||"[]").map(n=>n.customer_id===Ht.id?(0,a.A)((0,a.A)({},n),{},{latitude:e,longitude:t}):n);localStorage.setItem("route_customers",JSON.stringify(n)),ct(n)}catch(n){console.error("Error updating customer coordinates:",n)}Gt(!1),qt(null),Jt(""),Kt("")},style:{padding:"10px 20px",background:"#16a34a",color:"#fff",border:"none",borderRadius:8,fontWeight:700,cursor:"pointer"},children:"Save"})]})]})}),Qt&&tn&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002,padding:20,animation:"fadeIn 0.2s ease-in"},children:(0,u.jsxs)("div",{style:{width:"100%",maxWidth:650,maxHeight:"90vh",background:"#fff",borderRadius:20,boxShadow:"0 25px 60px rgba(0,0,0,0.25)",overflow:"hidden",display:"flex",flexDirection:"column",animation:"slideUp 0.3s ease-out"},children:[(0,u.jsxs)("div",{style:{padding:"24px 28px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:48,height:48,borderRadius:12,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:28},children:"assignment"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#fff",fontSize:22,marginBottom:2},children:"Assign Route"}),(0,u.jsxs)("div",{style:{fontSize:13,color:"rgba(255,255,255,0.8)",fontWeight:500},children:["Assign a route to ",tn.name]})]})]}),(0,u.jsx)("button",{onClick:()=>en(!1),style:{border:"none",background:"rgba(255,255,255,0.2)",cursor:"pointer",fontSize:24,color:"#fff",width:36,height:36,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(255,255,255,0.3)",e.target.style.transform="rotate(90deg)"},onMouseLeave:e=>{e.target.style.background="rgba(255,255,255,0.2)",e.target.style.transform="rotate(0deg)"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:28,overflowY:"auto",flex:1,background:"#f8fafc"},children:[(0,u.jsx)("div",{style:{marginBottom:24,padding:20,background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:16,border:"1px solid #bfdbfe",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.1)"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#fff"},children:"person"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:16,color:"#1e40af",fontWeight:700},children:tn.name}),(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:tn.email})]})]})}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"route"}),"Select Route ",(0,u.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsxs)("select",{value:(null===an||void 0===an?void 0:an.id)||"",onChange:e=>{const t=Fe.find(t=>t.id===e.target.value);sn(t||null)},style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",cursor:"pointer",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",appearance:"none"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"},children:[(0,u.jsx)("option",{value:"",children:"Select a route"}),Fe.map(e=>(0,u.jsxs)("option",{value:e.id,children:[e.name," (",e.customerCount||0," customers)"]},e.id))]}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8",pointerEvents:"none"},children:"route"}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8",pointerEvents:"none"},children:"arrow_drop_down"})]})]}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#1e293b",marginBottom:10,display:"flex",alignItems:"center",gap:6,fontSize:15},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#3b82f6"},children:"email"}),"Salesperson Email ",(0,u.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,u.jsxs)("div",{style:{position:"relative"},children:[(0,u.jsx)("input",{type:"email",value:on,onChange:e=>rn(e.target.value),placeholder:"Enter salesperson email",style:{padding:"14px 16px 14px 48px",borderRadius:12,border:"2px solid #e2e8f0",width:"100%",fontSize:15,background:"#fff",boxSizing:"border-box",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},onFocus:e=>{e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="0 1px 3px rgba(0,0,0,0.05)"}}),(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",fontSize:20,color:"#94a3b8"},children:"email"})]})]}),(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsxs)("label",{style:{fontWeight:600,color:"#374151",marginBottom:8,display:"block",fontSize:14},children:["Days of Week ",ln.length>0&&"(".concat(ln.length," selected)")]}),(0,u.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[(0,u.jsx)("button",{onClick:()=>{dn([])},style:{padding:"8px 16px",borderRadius:20,border:"2px solid ".concat(0===ln.length?"#3b82f6":"#d1d5db"),background:0===ln.length?"#3b82f6":"#fff",color:0===ln.length?"#fff":"#374151",fontSize:14,fontWeight:500,cursor:"pointer"},children:"Daily"}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((e,t)=>{const n=ln.includes(t);return(0,u.jsx)("button",{onClick:()=>{dn(n?e=>e.filter(e=>e!==t):e=>[...e,t])},style:{padding:"8px 16px",borderRadius:20,border:"2px solid ".concat(n?"#3b82f6":"#d1d5db"),background:n?"#3b82f6":"#fff",color:n?"#fff":"#374151",fontSize:14,fontWeight:500,cursor:"pointer",transition:"all 0.2s ease"},children:e.substring(0,3)},t)})]}),ln.length>0&&(0,u.jsxs)("div",{style:{marginTop:8,fontSize:12,color:"#64748b"},children:["Selected: ",ln.map(e=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]).join(", ")]})]}),(0,u.jsx)("div",{style:{marginBottom:20},children:(0,u.jsxs)("div",{onClick:()=>pn(!cn),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",border:"2px solid #e5e7eb",borderRadius:8,cursor:"pointer",background:"#fff"},children:[(0,u.jsx)("label",{style:{fontWeight:600,color:"#374151",fontSize:14,cursor:"pointer"},children:"Recurring"}),(0,u.jsx)("div",{style:{width:50,height:30,borderRadius:15,background:cn?"#3b82f6":"#d1d5db",position:"relative",transition:"background-color 0.2s"},children:(0,u.jsx)("div",{style:{width:26,height:26,borderRadius:"50%",background:"#fff",position:"absolute",top:2,right:cn?2:22,transition:"right 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})})]})})]}),(0,u.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e2e8f0",background:"#fff",display:"flex",justifyContent:"flex-end",gap:12,boxShadow:"0 -4px 12px rgba(0,0,0,0.04)"},children:[(0,u.jsx)("button",{onClick:()=>en(!1),style:{padding:"12px 24px",background:"#f1f5f9",border:"none",borderRadius:12,fontWeight:600,cursor:"pointer",color:"#475569",fontSize:15,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#e2e8f0",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="#f1f5f9",e.target.style.transform="translateY(0)"},children:"Cancel"}),(0,u.jsxs)("button",{onClick:async()=>{if(an)if(on.trim()){un(!0);try{const t={id:Date.now().toString(),route_id:an.id,route_name:an.name,user_id:on.trim(),days_of_week:ln.length>0?ln:null,day_of_week:1===ln.length?ln[0]:null,is_recurring:cn,assigned_at:(new Date).toISOString()};let n=!1;try{const e=await(0,d.apiPost)("/api/routes/assign",t);e&&!1!==e.success&&(n=!0,console.log("\u2705 Route assignment saved via API"))}catch(e){console.log("\u26a0\ufe0f API not available, using localStorage:",e)}if(!n){const e=JSON.parse(localStorage.getItem("route_assignments")||"[]").filter(e=>e.route_id!==t.route_id);e.push(t),localStorage.setItem("route_assignments",JSON.stringify(e)),console.log("\u2705 Route assignment saved to localStorage");const n=JSON.parse(localStorage.getItem("routes")||"[]").map(e=>e.id===t.route_id?(0,a.A)((0,a.A)({},e),{},{assignedTo:t.user_id}):e);localStorage.setItem("routes",JSON.stringify(n)),console.log("\u2705 Route updated with assignment in localStorage")}await Un(),qe(e=>e+1),en(!1),alert("Route assigned successfully")}catch(t){console.error("Error assigning route:",t),alert("Failed to assign route. Please try again.")}finally{un(!1)}}else alert("Please enter salesperson email");else alert("Please select a route")},disabled:gn||!an||!on.trim(),style:{padding:"12px 28px",background:!gn&&an&&on.trim()?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"#cbd5e1",color:"#fff",border:"none",borderRadius:12,fontWeight:700,cursor:!gn&&an&&on.trim()?"pointer":"not-allowed",opacity:gn?.8:1,display:"flex",alignItems:"center",gap:8,fontSize:15,boxShadow:!gn&&an&&on.trim()?"0 4px 12px rgba(59, 130, 246, 0.3)":"none",transition:"all 0.2s"},onMouseEnter:e=>{!gn&&an&&on.trim()&&(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(59, 130, 246, 0.4)")},onMouseLeave:e=>{!gn&&an&&on.trim()&&(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)")},children:[gn&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,animation:"spin 1s linear infinite"},children:"sync"}),!gn&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"assignment"}),gn?"Assigning...":"Assign Route"]})]})]})}),xn&&mn&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002,padding:20,animation:"fadeIn 0.2s ease-in"},children:(0,u.jsxs)("div",{style:{width:"100%",maxWidth:650,maxHeight:"90vh",background:"#fff",borderRadius:20,boxShadow:"0 25px 60px rgba(0,0,0,0.25)",overflow:"hidden",display:"flex",flexDirection:"column",animation:"slideUp 0.3s ease-out"},children:[(0,u.jsxs)("div",{style:{padding:"24px 28px",background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(99, 102, 241, 0.3)"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:48,height:48,borderRadius:12,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:28},children:"settings"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#fff",fontSize:22,marginBottom:2},children:"Route Actions"}),(0,u.jsxs)("div",{style:{fontSize:13,color:"rgba(255,255,255,0.8)",fontWeight:500},children:["Manage routes for ",mn.name]})]})]}),(0,u.jsx)("button",{onClick:()=>fn(!1),style:{border:"none",background:"rgba(255,255,255,0.2)",cursor:"pointer",fontSize:24,color:"#fff",width:36,height:36,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="rgba(255,255,255,0.3)",e.target.style.transform="rotate(90deg)"},onMouseLeave:e=>{e.target.style.background="rgba(255,255,255,0.2)",e.target.style.transform="rotate(0deg)"},children:"\xd7"})]}),(0,u.jsxs)("div",{style:{padding:28,overflowY:"auto",flex:1,background:"#f8fafc"},children:[(0,u.jsx)("div",{style:{marginBottom:24,padding:20,background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:16,border:"1px solid #bfdbfe",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.1)"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[(0,u.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:"#fff"},children:"person"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:16,color:"#1e40af",fontWeight:700},children:mn.name}),(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:mn.email})]})]})}),(0,u.jsx)("div",{style:{marginBottom:16},children:(0,u.jsxs)("button",{onClick:()=>{var e;fn(!1),nn(e=mn),sn(null),rn(e.email),dn([]),pn(!1),en(!0)},style:{width:"100%",padding:"16px 24px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",border:"none",borderRadius:12,fontSize:15,fontWeight:700,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:10,boxSizing:"border-box",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"assignment"}),"Assign Route"]})}),(0,u.jsx)("div",{style:{marginBottom:24},children:(0,u.jsxs)("button",{onClick:()=>yn(!bn),style:{width:"100%",padding:"16px 24px",background:bn?"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)":"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"#fff",border:"none",borderRadius:12,fontSize:15,fontWeight:700,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:10,boxSizing:"border-box",boxShadow:bn?"0 4px 12px rgba(99, 102, 241, 0.3)":"0 4px 12px rgba(139, 92, 246, 0.3)"},onMouseEnter:e=>{e.target.style.background=bn?"linear-gradient(135deg, #4f46e5 0%, #4338ca 100%)":"linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%)",e.target.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.target.style.background=bn?"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)":"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",e.target.style.transform="translateY(0)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:bn?"visibility_off":"visibility"}),bn?"Hide Assigned Routes":"View Assigned Routes"]})}),bn&&(0,u.jsxs)("div",{style:{marginBottom:20,padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,u.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"#1e293b",marginBottom:12},children:"Assigned Routes"}),(()=>{const e=JSON.parse(localStorage.getItem("route_assignments")||"[]").filter(e=>e.user_id===mn.email).map(e=>e.route_name).filter(Boolean);return 0===e.length?(0,u.jsx)("div",{style:{color:"#94a3b8",fontSize:13,fontStyle:"italic",padding:"20px",textAlign:"center"},children:"No routes assigned"}):(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:e.map((e,t)=>{const n=Fe.find(t=>t.name===e);return(0,u.jsxs)("div",{style:{padding:"8px 14px",background:"#dbeafe",color:"#1e40af",borderRadius:8,fontSize:13,fontWeight:500,border:"1px solid #bfdbfe",display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>{n&&(fn(!1),Yn(n))},onMouseEnter:e=>{e.currentTarget.style.background="#bfdbfe",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="#dbeafe",e.currentTarget.style.transform="translateY(0)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"route"}),e,(0,u.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{if(window.confirm('Are you sure you want to remove the assignment of "'.concat(e,'" from this user?')))try{const s=JSON.parse(localStorage.getItem("route_assignments")||"[]").filter(n=>!(n.user_id===t&&n.route_name===e));localStorage.setItem("route_assignments",JSON.stringify(s));const o=Fe.find(t=>t.name===e);if(o&&0===s.filter(e=>e.route_id===o.id).length){const e=JSON.parse(localStorage.getItem("routes")||"[]").map(e=>e.id===o.id?(0,a.A)((0,a.A)({},e),{},{assignedTo:null}):e);localStorage.setItem("routes",JSON.stringify(e))}try{await(0,d.apiPost)("/api/routes/unassign",{route_name:e,user_id:t})}catch(n){console.log("\u26a0\ufe0f API not available, using localStorage:",n)}await Un(),qe(e=>e+1),alert("Route assignment removed successfully")}catch(s){console.error("Error deleting assignment:",s),alert("Failed to remove assignment. Please try again.")}})(e,mn.email)},style:{marginLeft:4,padding:"2px 4px",background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"background-color 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#fee2e2"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Remove assignment",children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"close"})})]},t)})})})()]}),!bn&&(0,u.jsx)("div",{style:{padding:40,textAlign:"center",color:"#94a3b8",fontSize:14,fontStyle:"italic"},children:"Additional route actions content will be added here"})]}),(0,u.jsx)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e2e8f0",background:"#fff",display:"flex",justifyContent:"flex-end",gap:12,boxShadow:"0 -4px 12px rgba(0,0,0,0.04)"},children:(0,u.jsx)("button",{onClick:()=>fn(!1),style:{padding:"12px 24px",background:"#f1f5f9",border:"none",borderRadius:12,fontWeight:600,cursor:"pointer",color:"#475569",fontSize:15,transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},onMouseEnter:e=>{e.target.style.background="#e2e8f0",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="#f1f5f9",e.target.style.transform="translateY(0)"},children:"Close"})})]})}),(0,u.jsx)(v,{isOpen:Ie,onClose:()=>Ae(!1),onSuccess:async()=>{try{const e=await(0,b.AR)();Re(e),We(null)}catch(e){console.error("Error refreshing subscription info:",e)}Ae(!1),Se("User limit increased successfully! You can now create more users."),ve(""),setTimeout(()=>{Se("")},5e3)}})]})};var S=n(7694),w=n(46938),k=n(48247);const _=()=>{console.log("ShareAccess component rendered");const e=(0,k.a)(),[t,n]=(0,s.useState)([]),[a,o]=(0,s.useState)(""),[r,i]=(0,s.useState)(!1),[c,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[f,m]=(0,s.useState)(null),[h,b]=(0,s.useState)(""),[y,v]=(0,s.useState)([]),[j,S]=(0,s.useState)(""),[w,_]=(0,s.useState)([]),[N,C]=(0,s.useState)(!1),[z,I]=(0,s.useState)(""),[A,T]=(0,s.useState)(!1),[R,E]=(0,s.useState)([]);(0,s.useEffect)(()=>{const e=JSON.parse(sessionStorage.getItem("allConnections")||"[]");n(e);const t=sessionStorage.getItem("selectedCompanyGuid"),a=sessionStorage.getItem("selectedCompanyTallylocId");if(t){const n=e.find(e=>e.guid===t&&(!a||String(e.tallyloc_id)===String(a)));n&&"Full Access"===n.access_type&&o(t)}(async()=>{C(!0);try{const e=await(0,d.Vg)("/api/access-control/roles/all");e&&e.roles&&(_(e.roles),console.log("Roles fetched:",e.roles))}catch(e){console.error("Error fetching roles:",e)}finally{C(!1)}})()},[]),(0,s.useEffect)(()=>{if(!z.trim())return void E([]);const e=setTimeout(()=>{const e=z.toLowerCase(),n=[],a=[],s=[];for(let r=0;r<t.length;r++){const o=t[r],i=o.company||"",l=o.access_type||"",d=i.toLowerCase(),c=l.toLowerCase(),p=d.includes(e),g=c.includes(e);(p||g)&&(d===e||c===e?n.push(o):d.startsWith(e)||c.startsWith(e)?a.push(o):s.push(o))}const o=[...n,...a,...s];E(o)},150);return()=>clearTimeout(e)},[z,t]),(0,s.useEffect)(()=>{A&&!z.trim()&&(t.length<100?E(t):E([]))},[A,z,t]);const W=(0,s.useMemo)(()=>{if(!a)return null;const e=sessionStorage.getItem("selectedCompanyTallylocId");return t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)))},[a,t]),L=(0,s.useMemo)(()=>null!==f&&void 0!==f&&f.emails?f.emails.filter(e=>e.EMAIL.toLowerCase().includes(h.toLowerCase())||e.LEDGERS.some(e=>e.NAME.toLowerCase().includes(h.toLowerCase())||e.GROUP.toLowerCase().includes(h.toLowerCase()))):[],[f,h]);return(0,u.jsxs)("div",{style:{width:"100%",maxWidth:"1400px",margin:"0",padding:e?"12px 8px":"0"},children:[(0,u.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n          \n          @keyframes dropdownFadeIn {\n            from {\n              opacity: 0;\n              transform: translateY(-10px);\n            }\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n          \n          .dropdown-animation {\n            animation: dropdownFadeIn 0.2s ease-out;\n          }\n          \n          @media (max-width: 768px) {\n            .share-access-table {\n              overflow-x: auto;\n              -webkit-overflow-scrolling: touch;\n            }\n            .share-access-table table {\n              min-width: 600px;\n            }\n          }\n        "}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:e?20:32,marginTop:e?20:50,flexDirection:e?"column":"row",gap:e?12:0,alignItems:e?"flex-start":"center"},children:[(0,u.jsxs)("div",{style:{width:e?"100%":"auto"},children:[(0,u.jsxs)("h2",{style:{color:"#1e40af",fontWeight:700,fontSize:e?20:28,margin:0,display:"flex",alignItems:"center",gap:e?8:12,flexWrap:"wrap"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?24:32,color:"#1e40af"},children:"share"}),"Share Access Management"]}),(0,u.jsx)("div",{style:{color:"#64748b",fontSize:e?14:16,marginTop:4},children:"Grant access to users"})]}),(0,u.jsxs)("div",{style:{background:"#f0f9ff",color:"#0369a1",padding:e?"6px 12px":"8px 16px",borderRadius:20,fontSize:e?12:14,fontWeight:600,display:"flex",alignItems:"center",gap:8,width:e?"100%":"auto",justifyContent:e?"center":"flex-start"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?16:18},children:"business"}),t.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).length," companies available"]})]}),(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:e?12:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:e?16:32,marginBottom:e?16:24,width:"100%",boxSizing:"border-box"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:e?8:12,marginBottom:e?16:28,paddingBottom:e?12:16,borderBottom:"2px solid #f1f5f9"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?20:24,color:"#3b82f6"},children:"share"}),(0,u.jsx)("h3",{style:{color:"#1e293b",fontWeight:700,margin:0,fontSize:e?18:20},children:"Share Access Form"})]}),(0,u.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),W)if(W.tallyloc_id){x(!0),p("");try{var t;const e=await(0,d.apiPost)(l.API_CONFIG.ENDPOINTS.TALLY_LEDGER_SHAREACCESS,{tallyloc_id:W.tallyloc_id,company:W.company,guid:W.guid});m(e);const n=(null===(t=e.emails)||void 0===t?void 0:t.filter(e=>1===e.STATUS).map(e=>e.EMAIL))||[];v(n)}catch(n){p("Error getting masters. Please try again."),console.error("Error getting masters:",n)}finally{x(!1)}}else p("Company configuration is incomplete. Please contact administrator.");else p("Please select a company first.")},children:(0,u.jsxs)("div",{style:{display:e?"flex":"grid",gridTemplateColumns:e?"none":"400px 200px",flexDirection:e?"column":"row",gap:e?"16px":"24px",alignItems:e?"stretch":"end",position:"relative"},children:[(0,u.jsx)("div",{style:{position:"relative"},children:(0,u.jsxs)("div",{style:{position:"relative",background:"white",borderRadius:"12px",border:A?"2px solid #3b82f6":"2px solid #e2e8f0",transition:"all 0.2s ease",boxShadow:A?"0 4px 12px rgba(59, 130, 246, 0.15)":"0 1px 3px rgba(0, 0, 0, 0.1)",zIndex:A?1001:"auto"},children:[(0,u.jsx)("input",{value:a?(()=>{const e=sessionStorage.getItem("selectedCompanyTallylocId"),n=t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)));return n?"".concat(n.company," [").concat(n.access_type,"]"):""})():z,onChange:e=>{const n=e.target.value;I(n),o(""),T(!0),n.trim()||(t.length<100?E(t):E([]))},onFocus:()=>{i(!0),T(!0),t.length<100&&E(t)},onBlur:()=>i(!1),required:!0,style:{width:"100%",padding:e?"14px 18px":"16px 20px",paddingRight:a?e?"45px":"50px":e?"18px":"20px",border:"none",borderRadius:"12px",fontSize:e?"14px":"15px",color:"#374151",outline:"none",background:"transparent",cursor:"text"},placeholder:""}),!a&&(0,u.jsx)("span",{className:"material-icons",style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",color:A?"#3b82f6":"#9ca3af",fontSize:"20px",pointerEvents:"none",transition:"color 0.2s ease"},children:A?"expand_less":"search"}),a&&(0,u.jsx)("button",{type:"button",onClick:()=>{o(""),I(""),T(!1),t.length<100?E(t):E([])},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"4px",borderRadius:"50%",color:"#64748b",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",transition:"color 0.2s ease"},title:"Clear company",children:"\xd7"}),(0,u.jsx)("label",{style:{position:"absolute",left:"16px",top:r||(()=>{const e=sessionStorage.getItem("selectedCompanyTallylocId");return!!t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)))})()?"-8px":"50%",transform:r||(()=>{const e=sessionStorage.getItem("selectedCompanyTallylocId");return!!t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)))})()?"none":"translateY(-50%)",fontSize:r||(()=>{const e=sessionStorage.getItem("selectedCompanyTallylocId");return!!t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)))})()?"11px":"14px",color:r||(()=>{const e=sessionStorage.getItem("selectedCompanyTallylocId");return!!t.find(t=>t.guid===a&&(!e||String(t.tallyloc_id)===String(e)))})()?"#3b82f6":"#6b7280",backgroundColor:"#fff",padding:"0 6px",transition:"all 0.2s ease",pointerEvents:"none",zIndex:1},children:"Company"}),A&&(0,u.jsxs)("div",{className:"dropdown-animation",style:{position:"absolute",top:"calc(100% + 2px)",left:0,right:0,backgroundColor:"white",border:"2px solid #3b82f6",borderRadius:"8px",maxHeight:e?"250px":"300px",overflowY:"auto",zIndex:9999,boxShadow:"0 10px 25px rgba(59, 130, 246, 0.2)",marginTop:"0",minHeight:"50px"},children:[R.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).map((t,n)=>(0,u.jsxs)("div",{onClick:()=>{o(t.guid),I(""),T(!1)},style:{padding:e?"10px 14px":"12px 16px",cursor:"pointer",borderBottom:n<R.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).length-1?"1px solid #f1f5f9":"none",transition:"background-color 0.2s ease"},onMouseEnter:e=>{e.target.style.backgroundColor="#f8fafc"},onMouseLeave:e=>{e.target.style.backgroundColor="white"},children:[(0,u.jsx)("div",{style:{fontWeight:"600",color:"#1e293b",fontSize:e?"13px":"14px"},children:t.company}),(0,u.jsxs)("div",{style:{fontSize:e?"11px":"12px",color:"#64748b",marginTop:"2px"},children:["Access Type: ",t.access_type||"N/A"]})]},t.guid)),R.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).length>0&&(0,u.jsxs)("div",{style:{padding:e?"10px 14px":"12px 16px",textAlign:"center",color:"#64748b",fontSize:e?"11px":"12px",fontStyle:"italic",borderTop:"1px solid #f1f5f9",backgroundColor:"#f8fafc"},children:["Showing ",R.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).length," company",1!==R.filter(e=>"Connected"===e.status&&"Full Access"===e.access_type).length?"s":""]})]})]})}),(0,u.jsxs)("button",{type:"submit",disabled:g||!W,style:{background:g||!W?"#9ca3af":"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:e?14:16,padding:e?"14px 20px":"12px 24px",cursor:g||!W?"not-allowed":"pointer",boxShadow:"0 2px 8px 0 rgba(59,130,246,0.10)",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:8,minWidth:e?"100%":140,width:e?"100%":"auto"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?16:18},children:g?"sync":"search"}),g?"Getting...":"Get Masters"]})]})})]}),c&&(0,u.jsxs)("div",{style:{background:c.includes("Error")?"#fee2e2":"#d1fae5",color:c.includes("Error")?"#b91c1c":"#059669",borderRadius:e?12:16,padding:e?12:16,marginBottom:e?16:24,fontWeight:600,fontSize:e?13:15,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?16:18},children:c.includes("Error")?"error_outline":"check_circle"}),(0,u.jsx)("span",{style:{wordBreak:"break-word"},children:c})]}),f&&(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:e?12:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:e?16:24,marginBottom:e?16:24,display:"flex",flexDirection:e?"column":"row",justifyContent:"space-between",alignItems:e?"stretch":"center",gap:16},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:e?8:12,flex:1,width:e?"100%":"auto"},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:e?18:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:h,onChange:e=>b(e.target.value),placeholder:"Search users...",style:{padding:e?"10px 14px":"12px 16px",borderRadius:8,border:"1.5px solid #e2e8f0",fontSize:e?14:16,color:"#1e293b",outline:"none",flex:1,maxWidth:e?"100%":400,width:"100%",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#e2e8f0"})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:e?"column":"row",alignItems:"stretch",gap:12,width:e?"100%":"auto"},children:[(0,u.jsxs)("div",{style:{position:"relative",width:e?"100%":"auto"},children:[(0,u.jsxs)("select",{value:j,onChange:e=>S(e.target.value),disabled:N,required:!0,style:{padding:e?"10px 14px":"12px 16px",borderRadius:8,border:"2px solid ".concat(j?"#e5e7eb":"#dc2626"),fontSize:e?14:15,color:"#1e293b",outline:"none",background:"#fff",cursor:N?"not-allowed":"pointer",minWidth:e?"100%":250,width:e?"100%":"auto"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor=j?"#e5e7eb":"#dc2626",children:[(0,u.jsx)("option",{value:"",children:N?"Loading roles...":"Select a role *"}),w.map(e=>(0,u.jsx)("option",{value:e.id,children:e.display_name},e.id))]}),!j&&(0,u.jsx)("span",{style:{position:"absolute",top:"-8px",right:"8px",color:"#dc2626",fontSize:e?"10px":"12px",fontWeight:600,background:"#fff",padding:"0 4px"},children:"Required"})]}),(0,u.jsxs)("button",{onClick:async()=>{if(W)if(W.tallyloc_id)if(j){x(!0),p("");try{const n=y.map(e=>{var t;const n=null===(t=f.emails)||void 0===t?void 0:t.find(t=>t.EMAIL===e),a=null===n||void 0===n?void 0:n.ROLE_ID;return{email:e,roleId:a||j||null}}),a=await(0,d.apiPost)(l.API_CONFIG.ENDPOINTS.TALLY_LEDGER_SHAREACCESS_ACC,{tallyloc_id:W.tallyloc_id,company:W.company,guid:W.guid,users:n}),s=a.results.deactivated,o=a.results.activated+a.results.created+a.results.newAccounts;p("Total Deactivated = ".concat(s," and Total Active = ").concat(o)),setTimeout(()=>{p("")},5e3),console.log("Share access response:",a);try{const t=await(0,d.apiPost)(l.API_CONFIG.ENDPOINTS.TALLY_LEDGER_SHAREACCESS,{tallyloc_id:W.tallyloc_id,company:W.company,guid:W.guid});if(t){var e;m(t);const n=(null===(e=t.emails)||void 0===e?void 0:e.filter(e=>1===e.STATUS).map(e=>e.EMAIL))||[];v(n)}}catch(t){console.error("Error refreshing table data:",t)}}catch(n){p("Error managing access. Please try again."),console.error("Error managing access:",n)}finally{x(!1)}}else p("Please select a role before sharing access.");else p("Company configuration is incomplete. Please contact administrator.");else p("Please select a company first.")},disabled:0===y.length||!j,style:{background:0!==y.length&&j?"linear-gradient(135deg, #059669 0%, #10b981 100%)":"#9ca3af",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:e?14:16,padding:e?"12px 20px":"12px 24px",cursor:0!==y.length&&j?"pointer":"not-allowed",boxShadow:"0 2px 8px 0 rgba(5,150,105,0.10)",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:8,minWidth:e?"100%":160,width:e?"100%":"auto"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?16:18},children:"share"}),"Share Access (",y.length,")"]})]})]}),f&&(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:e?12:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:e?16:32,marginBottom:e?16:24},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:e?8:12,marginBottom:e?16:24,paddingBottom:e?12:16,borderBottom:"2px solid #f1f5f9"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:e?20:24,color:"#3b82f6"},children:"group"}),(0,u.jsxs)("h3",{style:{color:"#1e293b",fontWeight:700,margin:0,fontSize:e?18:20},children:["Share Access (",L.length,")"]})]}),(0,u.jsx)("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,overflow:"hidden"},children:(0,u.jsx)("div",{className:"share-access-table",style:{maxHeight:e?"400px":"500px",overflowY:"auto",overflowX:e?"auto":"visible"},children:(0,u.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{style:{background:"#f3f4f6"},children:[(0,u.jsxs)("th",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",width:e?"60px":"80px",fontSize:e?12:14},children:[(0,u.jsx)("input",{type:"checkbox",checked:L.length>0&&y.length===L.length,onChange:e=>{if(e.target.checked){const e=[...new Set([...y,...L.map(e=>e.EMAIL)])];v(e)}else{const e=y.filter(e=>!L.some(t=>t.EMAIL===e));v(e)}},style:{marginRight:e?"4px":"8px"}}),!e&&"All"]}),(0,u.jsx)("th",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",width:e?"120px":"150px",fontSize:e?12:14},children:"Role"}),(0,u.jsx)("th",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",width:e?"180px":"200px",fontSize:e?12:14},children:"Email"}),(0,u.jsx)("th",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",fontSize:e?12:14},children:"Ledgers"})]})}),(0,u.jsx)("tbody",{children:L.map((t,n)=>{const a=t.ROLE_ID?w.find(e=>e.id===t.ROLE_ID):null,s=a?a.display_name:"-";return(0,u.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6",background:1===t.STATUS?"#fef3c7":"#fff"},children:[(0,u.jsx)("td",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left"},children:(0,u.jsx)("input",{type:"checkbox",checked:y.includes(t.EMAIL),onChange:()=>(e=>{v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(t.EMAIL),style:{marginRight:e?"4px":"8px"}})}),(0,u.jsx)("td",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",fontWeight:500,color:"#374151",fontSize:e?12:14},children:s}),(0,u.jsx)("td",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",fontWeight:500,color:"#374151",fontSize:e?12:14,wordBreak:"break-word"},children:t.EMAIL}),(0,u.jsx)("td",{style:{padding:e?"10px 12px":"12px 16px",textAlign:"left",color:"#6b7280",maxWidth:e?"250px":"400px",fontSize:e?11:14},children:(0,u.jsx)("div",{style:{wordWrap:"break-word",whiteSpace:e?"normal":"pre-wrap",lineHeight:"1.4"},children:t.LEDGERS.map(e=>"".concat(e.NAME," (").concat(e.GROUP,")")).join(" | ")})})]},n)})})]})})})]})]})};var N=n(61669);const C=function(){const[e,t]=(0,s.useState)(null),[n,a]=(0,s.useState)(null),[o,i]=(0,s.useState)(!0),l=(0,r.Zp)();(0,s.useEffect)(()=>{d()},[]);const d=async()=>{try{const e=await(0,b.AR)();t(e),a(null)}catch(e){console.error("Error fetching subscription data:",e)}finally{i(!1)}};if(o||!e)return null;const{planName:c,status:p,isTrial:g,total_user_limit:x,trialEndDate:f}=e,m=(null===n||void 0===n?void 0:n.count)||0,h=(x>0?m/x*100:0)>=80,y=m>=x,v=g?(0,b.ss)(f):null,j=()=>g?"#f59e0b":y?"#ef4444":h?"#f59e0b":"active"===p?"#22c55e":"#64748b";return(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 16px",background:y?"#fef2f2":h?"#fef3c7":"#f0f9ff",border:"1px solid ".concat(y?"#fecaca":h?"#fde68a":"#bae6fd"),borderRadius:20,cursor:"pointer",transition:"all 0.2s",marginRight:16},onClick:()=>l("/admin-dashboard?view=subscription"),onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},title:"View Subscription Details",children:[(0,u.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:j(),boxShadow:"0 0 8px ".concat(j(),"40")}}),(0,u.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"#1e293b"},children:g?"Trial - ".concat(v," days left"):y?"Limit Reached":h?"Near Limit":c||"Active"}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"4px 12px",background:"#fff",borderRadius:12,fontSize:12,fontWeight:600,color:y?"#dc2626":h?"#d97706":"#0369a1"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"people"}),(0,u.jsxs)("span",{children:[m,"/",x]})]}),y&&(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,color:"#dc2626"},children:"warning"})]})};const z=function(){const[e,t]=(0,s.useState)(!1),[n,a]=(0,s.useState)(null),[o,i]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),p=(0,r.Zp)();(0,s.useEffect)(()=>{g()},[]);const g=async()=>{try{const n=await(0,b.f8)();if(n&&n.isTrial&&n.daysRemaining<=7&&!n.reminderDismissed){a(n);try{const e=await(0,d.Vg)("/api/subscription/plans");null!==e&&void 0!==e&&e.plans&&i(e.plans)}catch(e){console.error("Error fetching plans:",e)}t(!0)}}catch(e){console.error("Error checking trial status:",e)}},x=()=>{t(!1),p("/admin-dashboard?view=subscription")},f=()=>{t(!1)};if(!e||!n)return null;const m=n.daysRemaining||(0,b.ss)(n.trialEndDate);return(0,u.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",animation:"fadeIn 0.3s ease-out"},onClick:f,children:[(0,u.jsx)("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes slideUp {\n          from { \n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to { \n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "}),(0,u.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:20,padding:32,maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",animation:"slideUp 0.3s ease-out",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("button",{onClick:f,style:{position:"absolute",top:16,right:16,background:"none",border:"none",cursor:"pointer",padding:8,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background 0.2s",color:"#64748b"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9"},onMouseLeave:e=>{e.currentTarget.style.background="none"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"close"})}),(0,u.jsxs)("div",{style:{marginBottom:24,textAlign:"center"},children:[(0,u.jsx)("div",{style:{width:64,height:64,borderRadius:"50%",background:"linear-gradient(135deg, #f59e0b 0%, #ef4444 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.3)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32,color:"#fff"},children:"schedule"})}),(0,u.jsx)("h2",{style:{margin:0,fontSize:28,fontWeight:700,color:"#1e293b",marginBottom:8},children:"Trial Ending Soon"}),(0,u.jsxs)("p",{style:{margin:0,fontSize:16,color:"#64748b"},children:["Your free trial expires in ",m," ",1===m?"day":"days"]})]}),(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",borderRadius:12,padding:20,marginBottom:24,border:"1px solid #fbbf24"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#f59e0b"},children:"info"}),(0,u.jsx)("span",{style:{fontWeight:600,color:"#92400e",fontSize:16},children:"Don't lose access to your data"})]}),(0,u.jsx)("p",{style:{margin:0,color:"#78350f",fontSize:14,lineHeight:1.6},children:"Subscribe now to continue using all features and maintain access to your Tally connections, user management, and analytics after your trial ends."})]}),o.length>0&&(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18,fontWeight:600,color:"#1e293b"},children:"Choose a Plan"}),(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.slice(0,2).map(e=>(0,u.jsx)("div",{style:{border:"2px solid #e2e8f0",borderRadius:12,padding:16,transition:"all 0.2s",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.boxShadow="none"},onClick:x,children:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,fontSize:18,color:"#1e293b",marginBottom:4},children:e.name}),(0,u.jsxs)("div",{style:{fontSize:14,color:"#64748b"},children:[e.baseUsers," base users"]})]}),(0,u.jsxs)("div",{style:{textAlign:"right"},children:[(0,u.jsxs)("div",{style:{fontWeight:700,fontSize:20,color:"#1e40af"},children:["\u20b9",e.monthlyPrice,"/mo"]}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b"},children:["or \u20b9",e.annualPrice,"/yr"]})]})]})},e.id))})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,u.jsxs)("button",{onClick:x,style:{flex:1,padding:"14px 24px",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)",transition:"all 0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:8},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20},children:"credit_card"}),"Subscribe Now"]}),(0,u.jsx)("button",{onClick:async()=>{c(!0);try{await(0,b.$c)("7_day")&&(t(!1),localStorage.setItem("trialReminderDismissed",Date.now().toString()))}catch(e){console.error("Error dismissing reminder:",e)}finally{c(!1)}},disabled:l,style:{padding:"14px 24px",background:"#f1f5f9",color:"#64748b",border:"1px solid #e2e8f0",borderRadius:10,fontWeight:600,fontSize:16,cursor:l?"not-allowed":"pointer",transition:"all 0.2s",opacity:l?.6:1},onMouseEnter:e=>{l||(e.currentTarget.style.background="#e2e8f0")},onMouseLeave:e=>{l||(e.currentTarget.style.background="#f1f5f9")},children:l?"Dismissing...":"Remind Me Later"})]})]})]})};var I=n(80045);const A=["created_at","updated_at","id","created_by"],T="/api/subscriptions/admin/bank-details",R=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[r,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)({company_name:"",account_holder_name:"",bank_name:"",account_number:"",ifsc_code:"",branch_name:"",upi_id:"",is_active:!0}),[m,h]=(0,s.useState)({});(0,s.useEffect)(()=>{b()},[]);const b=async()=>{try{o(!0),i(null);const e=await(async()=>{const e=await(0,d.Vg)(T);return(null===e||void 0===e?void 0:e.data)||[]})();t(e)}catch(e){console.error("Error fetching bank details:",e),i("Failed to load bank details. Please try again.")}finally{o(!1)}},y=e=>{const{name:t,value:n,type:s,checked:o}=e.target;f(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"checkbox"===s?o:n})),m[t]&&h(e=>{const n=(0,a.A)({},e);return delete n[t],n})},v=async e=>{try{const t=await(async e=>{const t=await(0,d.Vg)("".concat(T,"/").concat(e));return(null===t||void 0===t?void 0:t.data)||null})(e);t&&(f({company_name:t.company_name||"",account_holder_name:t.account_holder_name||"",bank_name:t.bank_name||"",account_number:t.account_number||"",ifsc_code:t.ifsc_code||"",branch_name:t.branch_name||"",upi_id:t.upi_id||"",is_active:void 0===t.is_active||t.is_active}),g(e),c(!0))}catch(t){console.error("Error fetching bank details:",t),alert("Failed to load bank details for editing.")}},j=()=>{S(),c(!0)},S=()=>{f({company_name:"",account_holder_name:"",bank_name:"",account_number:"",ifsc_code:"",branch_name:"",upi_id:"",is_active:!0}),g(null),h({}),c(!1)};return n&&0===e.length?(0,u.jsx)("div",{className:"bank-details-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading bank details..."})]})}):(0,u.jsxs)("div",{className:"bank-details-page",children:[(0,u.jsxs)("div",{className:"bank-details-header",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{children:"Bank Details Management"}),(0,u.jsx)("p",{children:"Manage company bank account information"})]}),(0,u.jsxs)("button",{className:"create-button",onClick:j,children:[(0,u.jsx)("span",{className:"material-icons",children:"add"}),"Add New Bank Details"]})]}),r&&(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:r}),(0,u.jsx)("button",{onClick:b,className:"retry-button",children:"Retry"})]}),l&&(0,u.jsx)("div",{className:"form-modal",children:(0,u.jsxs)("div",{className:"form-modal-content",children:[(0,u.jsxs)("div",{className:"form-modal-header",children:[(0,u.jsx)("h2",{children:p?"Edit Bank Details":"Create Bank Details"}),(0,u.jsx)("button",{className:"close-button",onClick:S,children:"\xd7"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return x.company_name.trim()||(e.company_name="Company name is required"),x.account_holder_name.trim()||(e.account_holder_name="Account holder name is required"),x.bank_name.trim()||(e.bank_name="Bank name is required"),x.account_number.trim()||(e.account_number="Account number is required"),x.ifsc_code.trim()||(e.ifsc_code="IFSC code is required"),h(e),0===Object.keys(e).length})())try{p?(await(async(e,t)=>{const{created_at:n,updated_at:a,id:s,created_by:o}=t,r=(0,I.A)(t,A),i=await(0,d.mu)("".concat(T,"/").concat(e),r);return(null===i||void 0===i?void 0:i.data)||null})(p,x),alert("Bank details updated successfully!")):(await(async e=>{const t=await(0,d.apiPost)(T,e);return(null===t||void 0===t?void 0:t.data)||null})(x),alert("Bank details created successfully!")),S(),b()}catch(t){console.error("Error saving bank details:",t),alert("Failed to ".concat(p?"update":"create"," bank details. Please try again."))}},className:"bank-details-form",children:[(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"company_name",children:["Company Name ",(0,u.jsx)("span",{className:"required",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"company_name",name:"company_name",value:x.company_name,onChange:y,className:m.company_name?"error":""}),m.company_name&&(0,u.jsx)("span",{className:"error-message",children:m.company_name})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"account_holder_name",children:["Account Holder Name ",(0,u.jsx)("span",{className:"required",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"account_holder_name",name:"account_holder_name",value:x.account_holder_name,onChange:y,className:m.account_holder_name?"error":""}),m.account_holder_name&&(0,u.jsx)("span",{className:"error-message",children:m.account_holder_name})]})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"bank_name",children:["Bank Name ",(0,u.jsx)("span",{className:"required",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"bank_name",name:"bank_name",value:x.bank_name,onChange:y,className:m.bank_name?"error":""}),m.bank_name&&(0,u.jsx)("span",{className:"error-message",children:m.bank_name})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"account_number",children:["Account Number ",(0,u.jsx)("span",{className:"required",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"account_number",name:"account_number",value:x.account_number,onChange:y,className:m.account_number?"error":""}),m.account_number&&(0,u.jsx)("span",{className:"error-message",children:m.account_number})]})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"ifsc_code",children:["IFSC Code ",(0,u.jsx)("span",{className:"required",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"ifsc_code",name:"ifsc_code",value:x.ifsc_code,onChange:y,className:m.ifsc_code?"error":"",style:{textTransform:"uppercase"}}),m.ifsc_code&&(0,u.jsx)("span",{className:"error-message",children:m.ifsc_code})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"branch_name",children:"Branch Name"}),(0,u.jsx)("input",{type:"text",id:"branch_name",name:"branch_name",value:x.branch_name,onChange:y})]})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"upi_id",children:"UPI ID"}),(0,u.jsx)("input",{type:"text",id:"upi_id",name:"upi_id",value:x.upi_id,onChange:y,placeholder:"company@upi"}),x.upi_id&&(0,u.jsx)("small",{className:"form-hint",children:"QR code can be generated using this UPI ID"})]}),p&&(0,u.jsx)("div",{className:"form-group",children:(0,u.jsxs)("label",{htmlFor:"is_active",className:"checkbox-label",children:[(0,u.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:x.is_active,onChange:y}),(0,u.jsx)("span",{children:"Active"})]})})]}),(0,u.jsxs)("div",{className:"form-actions",children:[(0,u.jsx)("button",{type:"button",className:"cancel-button",onClick:S,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",children:p?"Update":"Create"})]})]})]})}),0!==e.length||n?(0,u.jsx)("div",{className:"bank-details-table-container",children:(0,u.jsxs)("table",{className:"bank-details-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Company Name"}),(0,u.jsx)("th",{children:"Account Holder"}),(0,u.jsx)("th",{children:"Bank Name"}),(0,u.jsx)("th",{children:"Account Number"}),(0,u.jsx)("th",{children:"IFSC Code"}),(0,u.jsx)("th",{children:"Branch"}),(0,u.jsx)("th",{children:"UPI ID"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Created"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:e.map(e=>{return(0,u.jsxs)("tr",{className:e.is_active?"":"inactive",children:[(0,u.jsx)("td",{children:e.company_name}),(0,u.jsx)("td",{children:e.account_holder_name}),(0,u.jsx)("td",{children:e.bank_name}),(0,u.jsx)("td",{children:e.account_number}),(0,u.jsx)("td",{children:e.ifsc_code}),(0,u.jsx)("td",{children:e.branch_name||"N/A"}),(0,u.jsx)("td",{children:e.upi_id||"N/A"}),(0,u.jsx)("td",{children:(0,u.jsx)("span",{className:"status-badge ".concat(e.is_active?"active":"inactive"),children:e.is_active?"Active":"Inactive"})}),(0,u.jsx)("td",{children:(t=e.created_at,t?new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A")}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"edit-button",onClick:()=>v(e.id),title:"Edit",children:(0,u.jsx)("span",{className:"material-icons",children:"edit"})})})]},e.id);var t})})]})}):(0,u.jsxs)("div",{className:"no-data-container",children:[(0,u.jsx)("span",{className:"material-icons",children:"account_balance"}),(0,u.jsx)("p",{children:"No bank details found."}),(0,u.jsx)("button",{onClick:j,className:"create-button",children:"Create First Bank Details"})]})]})},E=["created_at","updated_at"],W="/api/subscriptions",L=async()=>{const e=await(0,d.Vg)("".concat(W,"/slabs/internal"));return{slabs:(null===e||void 0===e?void 0:e.data)||[],bank_details:(null===e||void 0===e?void 0:e.bank_details)||null}},B=async e=>{const t=await(0,d.apiPost)("".concat(W,"/purchase"),e);return(null===t||void 0===t?void 0:t.data)||null},P=async()=>{const e=await(0,d.Vg)("".concat(W,"/current"));return(null===e||void 0===e?void 0:e.data)||null},M=e=>{let{status:t,daysRemaining:n=null}=e;const a=(()=>{switch(null===t||void 0===t?void 0:t.toLowerCase()){case"active":return{className:"status-badge-active",label:"Active"};case"trial":return{className:"status-badge-trial",label:null!==n?"Trial (".concat(n," days left)"):"Trial"};case"pending_payment":case"pending":return{className:"status-badge-pending",label:"Pending Payment"};case"expired":case"trial_expired":return{className:"status-badge-expired",label:"Expired"};default:return{className:"status-badge-default",label:t||"Unknown"}}})();return(0,u.jsx)("span",{className:"status-badge ".concat(a.className),children:a.label})},F=e=>{let{title:t,current:n,limit:a,remaining:s,freeUsed:o,freeAvailable:r,paidCount:i}=e;const l=a?Math.round(n/a*100):0,d=l>=80&&l<95,c=l>=95;return(0,u.jsxs)("div",{className:"usage-card",children:[(0,u.jsxs)("div",{className:"usage-card-header",children:[(0,u.jsx)("h3",{children:t}),(0,u.jsxs)("div",{className:"usage-card-stats",children:[(0,u.jsx)("span",{className:"usage-current",children:n}),a&&(0,u.jsx)("span",{className:"usage-separator",children:"/"}),a&&(0,u.jsx)("span",{className:"usage-limit",children:a})]})]}),a&&(0,u.jsxs)("div",{className:"usage-progress-container",children:[(0,u.jsx)("div",{className:"usage-progress-bar",children:(0,u.jsx)("div",{className:"usage-progress-fill",style:{width:"".concat(Math.min(l,100),"%"),backgroundColor:c?"#dc3545":d?"#ffc107":"#28a745"}})}),(0,u.jsxs)("div",{className:"usage-progress-text",children:[void 0!==s&&s>=0&&(0,u.jsxs)("span",{className:"usage-remaining",children:[s," remaining"]}),(0,u.jsxs)("span",{className:"usage-percentage",children:[l,"%"]})]})]}),(void 0!==o||void 0!==r||void 0!==i)&&(0,u.jsxs)("div",{className:"usage-details",children:[void 0!==o&&(0,u.jsxs)("div",{className:"usage-detail-item",children:[(0,u.jsx)("span",{className:"usage-detail-label",children:"Free Used:"}),(0,u.jsx)("span",{className:"usage-detail-value",children:o})]}),void 0!==r&&(0,u.jsxs)("div",{className:"usage-detail-item",children:[(0,u.jsx)("span",{className:"usage-detail-label",children:"Free Available:"}),(0,u.jsx)("span",{className:"usage-detail-value",children:r})]}),void 0!==i&&(0,u.jsxs)("div",{className:"usage-detail-item",children:[(0,u.jsx)("span",{className:"usage-detail-label",children:"Paid Users:"}),(0,u.jsx)("span",{className:"usage-detail-value",children:i})]})]}),d&&(0,u.jsxs)("div",{className:"usage-warning",children:["\u26a0\ufe0f Approaching limit (",l,"% used)"]}),c&&(0,u.jsx)("div",{className:"usage-critical",children:"\ud83d\udea8 Limit reached! Please upgrade your plan."})]})},D=e=>{let{plan:t,billingCycle:n,isSelected:a=!1,isCurrent:s=!1,onSelect:o}=e;const r=e=>{if(null===e||void 0===e)return 0;const t=parseFloat(e);return isNaN(t)?0:t},i=r(t.yearly_price||t.yearly_price_per_user),l=r(t.monthly_price||t.monthly_price_per_user),d="yearly"===n?i:l,c="yearly"===n?i>0?(i/12).toFixed(2):"0.00":l.toString(),p="yearly"===n&&l>0&&i>0?(12*l-i).toFixed(2):0,g=t.min_users===t.max_users?"".concat(t.min_users," user").concat(t.min_users>1?"s":""):"".concat(t.min_users,"-").concat(t.max_users," users");return(0,u.jsxs)("div",{className:"plan-card ".concat(a?"plan-card-selected":""," ").concat(s?"plan-card-current":""),onClick:o,children:[s&&(0,u.jsx)("div",{className:"plan-card-badge",children:"Current Plan"}),t.popular&&(0,u.jsx)("div",{className:"plan-card-popular",children:"Most Popular"}),(0,u.jsxs)("div",{className:"plan-card-header",children:[(0,u.jsx)("h3",{className:"plan-card-name",children:t.name}),t.description&&(0,u.jsx)("p",{className:"plan-card-description",children:t.description})]}),(0,u.jsxs)("div",{className:"plan-card-pricing",children:[(0,u.jsxs)("div",{className:"plan-card-price",children:[(0,u.jsx)("span",{className:"plan-card-currency",children:"\u20b9"}),(0,u.jsx)("span",{className:"plan-card-amount",children:d.toLocaleString("en-IN")}),(0,u.jsxs)("span",{className:"plan-card-period",children:["/","yearly"===n?"year":"month"]})]}),"yearly"===n&&p>0&&!isNaN(parseFloat(p))&&(0,u.jsxs)("div",{className:"plan-card-savings",children:["Save \u20b9",parseFloat(p).toLocaleString("en-IN"),"/year"]}),"yearly"===n&&c&&!isNaN(parseFloat(c))&&(0,u.jsxs)("div",{className:"plan-card-monthly-equivalent",children:["\u20b9",parseFloat(c).toLocaleString("en-IN"),"/month"]})]}),(0,u.jsxs)("div",{className:"plan-card-details",children:[(0,u.jsxs)("div",{className:"plan-card-detail-item",children:[(0,u.jsx)("span",{className:"plan-card-detail-label",children:"User Range:"}),(0,u.jsx)("span",{className:"plan-card-detail-value",children:g})]}),void 0!==t.free_external_users_per_internal_user&&t.free_external_users_per_internal_user>0&&(0,u.jsxs)("div",{className:"plan-card-detail-item",children:[(0,u.jsx)("span",{className:"plan-card-detail-label",children:"Free External Users Per Internal User:"}),(0,u.jsx)("span",{className:"plan-card-detail-value",children:t.free_external_users_per_internal_user})]})]}),(0,u.jsx)("div",{className:"plan-card-actions",children:s?(0,u.jsx)("button",{className:"plan-card-button plan-card-button-current",disabled:!0,children:"Current Plan"}):(0,u.jsx)("button",{className:"plan-card-button plan-card-button-select",children:a?"Selected":"Select Plan"})})]})},U=e=>{var t;let{isOpen:n,onClose:o,orderDetails:r,onSuccess:i}=e;const[l,d]=(0,s.useState)(!1),[c,p]=(0,s.useState)(null),[g,x]=(0,s.useState)({payment_method:"bank_transfer",payment_reference:"",payment_date:(new Date).toISOString().split("T")[0],employee_code:"",partner_code:""}),[f,m]=(0,s.useState)({}),h=(null===r||void 0===r?void 0:r.bankDetails)||null,b=e=>{const{name:t,value:n}=e.target;x(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n})),f[t]&&m(e=>{const n=(0,a.A)({},e);return delete n[t],n})};if(!n)return null;const y=(null===r||void 0===r?void 0:r.totalAmount)||0,v=null!==h&&void 0!==h&&h.upi_id?((e,t)=>{if(!e)return null;const n=encodeURIComponent((null===h||void 0===h?void 0:h.account_holder_name)||(null===h||void 0===h?void 0:h.company_name)||""),a=t?t.toFixed(2):"";let s="upi://pay?pa=".concat(encodeURIComponent(e),"&pn=").concat(n);return a&&(s+="&am=".concat(a,"&cu=INR")),"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(s))})(h.upi_id,y):null;return(0,u.jsx)("div",{className:"payment-modal-overlay",onClick:o,children:(0,u.jsxs)("div",{className:"payment-modal-content",onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:"payment-modal-header",children:[(0,u.jsx)("h2",{children:"Complete Payment"}),(0,u.jsx)("button",{className:"payment-modal-close",onClick:o,children:"\xd7"})]}),c&&(0,u.jsx)("div",{className:"payment-modal-error",children:c}),(0,u.jsxs)("div",{className:"payment-modal-body",children:[(0,u.jsxs)("div",{className:"payment-modal-left",children:[(0,u.jsxs)("div",{className:"bank-details-section",children:[(0,u.jsx)("h3",{children:"Company Bank Details"}),h?(0,u.jsxs)("div",{className:"bank-details-card",children:[(0,u.jsxs)("div",{className:"bank-detail-item",children:[(0,u.jsx)("label",{children:"Account Holder Name"}),(0,u.jsx)("div",{children:h.account_holder_name||"-"})]}),(0,u.jsxs)("div",{className:"bank-detail-row",children:[(0,u.jsxs)("div",{className:"bank-detail-item bank-detail-half",children:[(0,u.jsx)("label",{children:"Bank Name"}),(0,u.jsx)("div",{children:h.bank_name||"-"})]}),(0,u.jsxs)("div",{className:"bank-detail-item bank-detail-half",children:[(0,u.jsx)("label",{children:"Branch Name"}),(0,u.jsx)("div",{children:h.branch_name||"-"})]})]}),(0,u.jsxs)("div",{className:"bank-detail-row",children:[(0,u.jsxs)("div",{className:"bank-detail-item bank-detail-half",children:[(0,u.jsx)("label",{children:"Account Number"}),(0,u.jsx)("div",{children:h.account_number||"-"})]}),(0,u.jsxs)("div",{className:"bank-detail-item bank-detail-half",children:[(0,u.jsx)("label",{children:"IFSC Code"}),(0,u.jsx)("div",{children:h.ifsc_code||"-"})]})]})]}):(0,u.jsx)("div",{className:"bank-details-error",children:"No bank details available"})]}),(0,u.jsxs)("div",{className:"upi-section",children:[(0,u.jsx)("h3",{children:"UPI Payment"}),null!==h&&void 0!==h&&h.upi_id?(0,u.jsxs)("div",{className:"upi-details-card",children:[(0,u.jsxs)("div",{className:"upi-id-display",children:[(0,u.jsx)("label",{children:"UPI ID"}),(0,u.jsx)("div",{className:"upi-id-value",children:h.upi_id})]}),v&&(0,u.jsxs)("div",{className:"upi-qr-code",children:[(0,u.jsx)("img",{src:v,alt:"UPI QR Code",className:"qr-code-image"}),(0,u.jsx)("p",{className:"qr-code-hint",children:"Scan to pay via UPI"})]})]}):(0,u.jsx)("div",{className:"upi-error",children:"UPI ID not available"})]})]}),(0,u.jsxs)("div",{className:"payment-modal-right",children:[(0,u.jsxs)("div",{className:"payment-summary-section",children:[(0,u.jsx)("h3",{children:"Payment Summary"}),(0,u.jsxs)("div",{className:"payment-summary-card",children:[(0,u.jsxs)("div",{className:"summary-item",children:[(0,u.jsx)("span",{children:"Total Amount"}),(0,u.jsxs)("strong",{children:["\u20b9",(null===r||void 0===r||null===(t=r.totalAmount)||void 0===t?void 0:t.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),(0,u.jsxs)("div",{className:"summary-item",children:[(0,u.jsx)("span",{children:"Billing Cycle"}),(0,u.jsx)("span",{children:"yearly"===(null===r||void 0===r?void 0:r.billingCycle)?"Yearly":"Monthly"})]}),(null===r||void 0===r?void 0:r.internalPlan)&&(0,u.jsxs)("div",{className:"summary-item",children:[(0,u.jsx)("span",{children:r.internalPlan.name}),(0,u.jsxs)("span",{children:[r.totalInternalUsers||1," user(s)"]})]}),(null===r||void 0===r?void 0:r.totalFreeExternalUsers)>0&&(0,u.jsxs)("div",{className:"summary-item",children:[(0,u.jsx)("span",{children:"Free External Users"}),(0,u.jsxs)("span",{children:[r.totalFreeExternalUsers," user(s)"]})]})]})]}),(0,u.jsxs)("form",{className:"payment-form",onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return g.payment_reference.trim()||(e.payment_reference="Payment reference is required"),g.payment_date||(e.payment_date="Payment date is required"),m(e),0===Object.keys(e).length})())try{var t,n;d(!0),p(null);const e={internal_slab_id:null===(t=r.internalPlan)||void 0===t?void 0:t.id,billing_cycle:r.billingCycle||"monthly",user_count:r.totalInternalUsers||(null===(n=r.internalPlan)||void 0===n?void 0:n.min_users)||1,partner_id:g.partner_code||null,employee_id:g.employee_code||null,payment_method:g.payment_method,payment_reference:g.payment_reference,payment_proof_url:null,payment_date:g.payment_date},a=await B(e);a?(i&&i(a),o()):p("Failed to process payment. Please try again.")}catch(a){console.error("Error submitting payment:",a),p(a.message||"Failed to process payment. Please try again.")}finally{d(!1)}},children:[(0,u.jsx)("h3",{children:"Payment Details"}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group form-group-half",children:[(0,u.jsx)("label",{htmlFor:"payment_method",children:"Payment Method *"}),(0,u.jsxs)("select",{id:"payment_method",name:"payment_method",value:g.payment_method,onChange:b,className:f.payment_method?"error":"",children:[(0,u.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,u.jsx)("option",{value:"upi",children:"UPI"}),(0,u.jsx)("option",{value:"netbanking",children:"Net Banking"})]}),f.payment_method&&(0,u.jsx)("span",{className:"error-message",children:f.payment_method})]}),(0,u.jsxs)("div",{className:"form-group form-group-half",children:[(0,u.jsx)("label",{htmlFor:"payment_date",children:"Payment Date *"}),(0,u.jsx)("input",{type:"date",id:"payment_date",name:"payment_date",value:g.payment_date,onChange:b,max:(new Date).toISOString().split("T")[0],className:f.payment_date?"error":""}),f.payment_date&&(0,u.jsx)("span",{className:"error-message",children:f.payment_date})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_reference",children:"Payment Reference / Transaction ID *"}),(0,u.jsx)("input",{type:"text",id:"payment_reference",name:"payment_reference",value:g.payment_reference,onChange:b,placeholder:"Enter transaction ID or reference number",className:f.payment_reference?"error":""}),f.payment_reference&&(0,u.jsx)("span",{className:"error-message",children:f.payment_reference})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group form-group-half",children:[(0,u.jsx)("label",{htmlFor:"employee_code",children:"Employee Code"}),(0,u.jsx)("input",{type:"text",id:"employee_code",name:"employee_code",value:g.employee_code,onChange:b,placeholder:"Enter employee code (optional)",className:f.employee_code?"error":""}),f.employee_code&&(0,u.jsx)("span",{className:"error-message",children:f.employee_code})]}),(0,u.jsxs)("div",{className:"form-group form-group-half",children:[(0,u.jsx)("label",{htmlFor:"partner_code",children:"Partner Code"}),(0,u.jsx)("input",{type:"text",id:"partner_code",name:"partner_code",value:g.partner_code,onChange:b,placeholder:"Enter partner code (optional)",className:f.partner_code?"error":""}),f.partner_code&&(0,u.jsx)("span",{className:"error-message",children:f.partner_code})]})]}),(0,u.jsxs)("div",{className:"payment-form-actions",children:[(0,u.jsx)("button",{type:"button",className:"cancel-button",onClick:o,disabled:l,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:l,children:l?"Processing...":"Accept & Submit"})]})]})]})]}),")}"]})})},Y=e=>{let{internalPlan:t,internalPlans:n=[],billingCycle:a,selectedInternalPlanId:o,bankDetails:r,onPlanChange:i,onBack:l,onContinue:d,onShowPaymentModal:c}=e;const[p,g]=(0,s.useState)(0),x=n.find(e=>e.id===o)||t;(0,s.useEffect)(()=>{const e=(null===x||void 0===x?void 0:x.min_users)||1;g(e)},[o,x]);const f="yearly"===a?(null===x||void 0===x?void 0:x.yearly_price)||0:(null===x||void 0===x?void 0:x.monthly_price)||0,m=(null===x||void 0===x?void 0:x.min_users)||1,h=(null===x||void 0===x?void 0:x.max_users)||m,b=Math.max(m,p||m),y=(null===x||void 0===x?void 0:x.free_external_users_per_internal_user)||0,v=y*b,j=e=>{const t=[...n].sort((e,t)=>(e.min_users||0)-(t.min_users||0)),a=t.findIndex(t=>t.id===e);return a>=0&&a<t.length-1?t[a+1]:null},S=b*f,w=S;return(0,u.jsxs)("div",{className:"billing-details-screen",children:[(0,u.jsxs)("div",{className:"billing-details-header",children:[(0,u.jsx)("button",{className:"back-button",onClick:l,children:"\u2190 Back to Plans"}),(0,u.jsx)("h1",{children:"Review Your Order"})]}),(0,u.jsxs)("div",{className:"billing-details-content",children:[(0,u.jsxs)("div",{className:"additional-users-section",children:[(0,u.jsx)("h2",{children:"Additional Users"}),(0,u.jsxs)("div",{className:"user-counter-group",children:[(0,u.jsxs)("div",{className:"user-counter",children:[(0,u.jsx)("label",{children:"Additional Internal Users"}),(0,u.jsxs)("div",{className:"counter-controls",children:[(0,u.jsx)("button",{className:"counter-btn",onClick:()=>{const e=Math.max(m,(p||m)-1);g(e)},disabled:(p||m)<=m,children:"-"}),(0,u.jsx)("input",{type:"number",value:p||m,onChange:e=>{const t=parseInt(e.target.value)||0,n=Math.max(m,t);if(n>h){const e=j(o);e&&i?i(e.id):g(h)}else g(n)},min:m,max:h,className:"counter-input"}),(0,u.jsx)("button",{className:"counter-btn",onClick:()=>{const e=p||m;if(e<h)g(e+1);else{const e=j(o);e&&i&&i(e.id)}},disabled:(p||m)>=h&&!j(o),children:"+"})]}),(0,u.jsxs)("div",{className:"counter-price",children:["\u20b9",f.toLocaleString("en-IN")," per user per ","yearly"===a?"year":"month",(0,u.jsx)("br",{}),(0,u.jsxs)("strong",{children:["Total: \u20b9",(b*f).toLocaleString("en-IN"),"/","yearly"===a?"year":"month"]}),h>m&&(0,u.jsxs)("div",{className:"counter-limit",children:["(Range: ",m," to ",h," users)"]})]})]}),v>0&&(0,u.jsxs)("div",{className:"free-users-info",style:{marginTop:"20px",padding:"15px",backgroundColor:"#f0f9ff",borderRadius:"8px"},children:[(0,u.jsx)("strong",{children:"Free External Users Included:"}),(0,u.jsxs)("p",{style:{margin:"8px 0 0 0",color:"#666"},children:["You will receive ",(0,u.jsxs)("strong",{children:[v," free external users"]})," (",y," per internal user) with this plan."]})]})]})]}),(0,u.jsxs)("div",{className:"order-summary-section",children:[(0,u.jsx)("h2",{children:"Order Summary"}),(0,u.jsxs)("div",{className:"order-summary-card",children:[(0,u.jsxs)("div",{className:"order-item",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:(null===x||void 0===x?void 0:x.name)||"Internal Plan"}),(0,u.jsxs)("div",{className:"order-item-detail",children:[b," user",b>1?"s":""," \u2022 ","yearly"===a?"Yearly":"Monthly"," Billing"]})]}),(0,u.jsxs)("div",{className:"order-item-price",children:["\u20b9",S.toLocaleString("en-IN")," per ","yearly"===a?"year":"month"]})]}),v>0&&(0,u.jsxs)("div",{className:"order-item",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:"Free External Users"}),(0,u.jsxs)("div",{className:"order-item-detail",children:[v," user(s) included (",y," per internal user)"]})]}),(0,u.jsxs)("div",{className:"order-item-price",children:["\u20b90.00 per ","yearly"===a?"year":"month"]})]}),(0,u.jsxs)("div",{className:"order-total",children:[(0,u.jsx)("strong",{children:"Total Amount"}),(0,u.jsxs)("strong",{className:"total-price",children:["\u20b9",w.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})," per ","yearly"===a?"year":"month"]})]}),(0,u.jsxs)("div",{className:"payment-methods",children:[(0,u.jsx)("div",{className:"payment-methods-label",children:"Accepted Payment Methods:"}),(0,u.jsxs)("div",{className:"payment-icons",children:[(0,u.jsx)("span",{className:"payment-icon",children:"\ud83d\udcf1 UPI"}),(0,u.jsx)("span",{className:"payment-icon",children:"\ud83c\udfe6 Netbanking"})]})]}),(0,u.jsxs)("button",{className:"subscribe-button",onClick:()=>{c&&c({internalPlan:x,billingCycle:a,totalInternalUsers:b,totalAmount:w,totalFreeExternalUsers:v,freeExternalUsersPerInternalUser:y,bankDetails:r})},children:[(0,u.jsx)("span",{className:"material-icons",children:"subscriptions"}),"Subscribe Now & Pay"]})]})]})]})]})},O=e=>{let{onPlanSelect:t,onContinue:n}=e;const[o,r]=(0,s.useState)([]),[i,l]=(0,s.useState)("monthly"),[d,c]=(0,s.useState)(null),[p,g]=(0,s.useState)(!0),[x,f]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{k()},[]);const[S,w]=(0,s.useState)(null),k=async()=>{try{g(!0),f(null);const e=await L();r(e.slabs),w(e.bank_details),e.slabs.length>0&&c(e.slabs[0].id)}catch(e){console.error("Error fetching plans:",e),f("Failed to load subscription plans. Please try again.")}finally{g(!1)}};if(p)return(0,u.jsx)("div",{className:"subscription-plans-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading subscription plans..."})]})});if(x)return(0,u.jsx)("div",{className:"subscription-plans-page",children:(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:x}),(0,u.jsx)("button",{onClick:k,className:"retry-button",children:"Retry"})]})});if(m){const e=o.find(e=>e.id===d);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Y,{internalPlan:e,internalPlans:o,billingCycle:i,selectedInternalPlanId:d,bankDetails:S,onPlanChange:e=>{e&&c(e)},onBack:()=>h(!1),onContinue:t=>{const n=(0,a.A)({internalPlan:e,billingCycle:i,bankDetails:S},t);j(n),y(!0)},onShowPaymentModal:e=>{j(e),y(!0)}}),(0,u.jsx)(U,{isOpen:b,onClose:()=>{y(!1),j(null)},orderDetails:v,onSuccess:e=>{console.log("Payment successful:",e),n&&v&&n(v),alert("Payment submitted successfully! Your subscription is pending approval.")}})]})}o.find(e=>e.id===d);return(0,u.jsxs)("div",{className:"subscription-plans-page",children:[(0,u.jsxs)("div",{className:"plans-page-header",children:[(0,u.jsx)("h1",{children:"Choose Your Subscription Plan"}),(0,u.jsx)("p",{children:"Select the plan that best fits your needs"})]}),(0,u.jsxs)("div",{className:"billing-cycle-toggle",children:[(0,u.jsx)("button",{className:"toggle-button ".concat("monthly"===i?"active":""),onClick:()=>l("monthly"),children:"Monthly"}),(0,u.jsxs)("button",{className:"toggle-button ".concat("yearly"===i?"active":""),onClick:()=>l("yearly"),children:["Yearly",(0,u.jsx)("span",{className:"savings-badge",children:"Save up to 20%"})]})]}),(0,u.jsx)("div",{className:"plans-section",children:(0,u.jsxs)("div",{className:"plans-subsection",children:[(0,u.jsx)("h2",{children:"Subscription Plans"}),(0,u.jsx)("div",{className:"plans-grid",children:o.map(e=>(0,u.jsx)(D,{plan:e,billingCycle:i,isSelected:d===e.id,onSelect:()=>{return t=e.id,void c(t);var t}},e.id))})]})}),d&&(0,u.jsx)("div",{className:"plans-page-actions",children:(0,u.jsx)("button",{className:"continue-button",onClick:()=>{d?h(!0):f("Please select an internal user plan.")},children:"Continue to Billing Details"})}),(0,u.jsx)(U,{isOpen:b,onClose:()=>{y(!1),j(null)},orderDetails:v,onSuccess:e=>{console.log("Payment successful:",e),n&&v&&n(v),alert("Payment submitted successfully! Your subscription is pending approval.")}})]})},G=e=>{let{onUpgrade:t,onDowngrade:n,onViewBilling:a}=e;const[o,r]=(0,s.useState)(null),[i,l]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{p()},[]);const p=async()=>{try{l(!0),c(null);const e=await P();r(e)}catch(e){console.error("Error fetching subscription:",e),c("Failed to load subscription details. Please try again.")}finally{l(!1)}},g=e=>e?new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"}):"N/A";if(i)return(0,u.jsx)("div",{className:"current-subscription-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading subscription details..."})]})});if(d)return(0,u.jsx)("div",{className:"current-subscription-page",children:(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:d}),(0,u.jsx)("button",{onClick:p,className:"retry-button",children:"Retry"})]})});if(!o)return(0,u.jsx)("div",{className:"current-subscription-page",children:(0,u.jsxs)("div",{className:"no-subscription-container",children:[(0,u.jsx)("h2",{children:"No Active Subscription"}),(0,u.jsx)("p",{children:"You don't have an active subscription. Please purchase a plan to continue."}),t&&(0,u.jsx)("button",{onClick:()=>t(),className:"purchase-button",children:"Purchase Plan"})]})});const x=void 0!==o.days_remaining?o.days_remaining:(e=>{if(!e)return null;const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return Math.max(0,n)})(o.end_date);return(0,u.jsxs)("div",{className:"current-subscription-page",children:[(0,u.jsx)("div",{className:"subscription-page-header",children:(0,u.jsx)("h1",{children:"My Subscription"})}),(0,u.jsxs)("div",{className:"subscription-status-card",children:[(0,u.jsx)("div",{className:"status-card-header",children:(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{children:"Subscription Status"}),(0,u.jsx)(M,{status:o.status,daysRemaining:o.is_trial?x:null})]})}),(0,u.jsxs)("div",{className:"status-card-details",children:[(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"Plan:"}),(0,u.jsx)("span",{className:"detail-value",children:o.internal_slab_id?"Slab ".concat(o.internal_slab_id):"N/A"})]}),(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"Billing Cycle:"}),(0,u.jsx)("span",{className:"detail-value",children:o.billing_cycle?o.billing_cycle.charAt(0).toUpperCase()+o.billing_cycle.slice(1):"N/A"})]}),(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"Start Date:"}),(0,u.jsx)("span",{className:"detail-value",children:g(o.start_date)})]}),(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"End Date:"}),(0,u.jsx)("span",{className:"detail-value",children:g(o.end_date)})]}),o.is_trial&&null!==x&&(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"Trial Days Remaining:"}),(0,u.jsxs)("span",{className:"detail-value highlight",children:[x," days"]})]}),!o.is_trial&&o.end_date&&(0,u.jsxs)("div",{className:"detail-row",children:[(0,u.jsx)("span",{className:"detail-label",children:"Renewal Date:"}),(0,u.jsx)("span",{className:"detail-value",children:g(o.end_date)})]})]})]}),o.usage&&(0,u.jsxs)("div",{className:"usage-section",children:[(0,u.jsx)("h2",{children:"Usage Statistics"}),(0,u.jsx)("div",{className:"usage-cards-container",children:o.usage.internal_users&&(0,u.jsx)(F,{title:"Internal Users",current:o.usage.internal_users.current,limit:o.usage.internal_users.limit,remaining:o.usage.internal_users.remaining})})]}),(0,u.jsxs)("div",{className:"subscription-actions",children:[t&&(0,u.jsx)("button",{onClick:()=>t(),className:"action-button action-button-primary",children:"Upgrade Plan"}),n&&"active"===o.status&&(0,u.jsx)("button",{onClick:()=>n(),className:"action-button action-button-secondary",children:"Downgrade Plan"}),a&&(0,u.jsx)("button",{onClick:()=>a(),className:"action-button action-button-outline",children:"View Billing History"})]})]})},H=e=>{var t,n;let{selectedPlan:o,billingCycle:r,onSuccess:i,onCancel:l}=e;const[d,c]=(0,s.useState)({internal_slab_id:(null===o||void 0===o?void 0:o.id)||"",billing_cycle:r||"monthly",partner_id:null,employee_id:null,payment_method:"bank_transfer",payment_reference:"",payment_proof_url:"",payment_date:(new Date).toISOString().split("T")[0]}),[p,g]=(0,s.useState)([]),[x,f]=(0,s.useState)(!1),[m,h]=(0,s.useState)(null),[b,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{o&&c(e=>(0,a.A)((0,a.A)({},e),{},{internal_slab_id:o.id})),v()},[o]);const v=async()=>{try{const e=await L();g(e.slabs)}catch(e){console.error("Error fetching plans:",e)}},j=e=>{const{name:t,value:n}=e.target;c(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n||null})),h(null)},S=p.find(e=>e.id===d.internal_slab_id)||o;return b?(0,u.jsx)("div",{className:"purchase-subscription-page",children:(0,u.jsxs)("div",{className:"success-container",children:[(0,u.jsx)("div",{className:"success-icon",children:"\u2713"}),(0,u.jsx)("h2",{children:"Payment Submitted Successfully!"}),(0,u.jsx)("p",{children:"Your payment is pending validation. You will be notified once it's approved."}),(0,u.jsxs)("p",{className:"success-note",children:["Invoice Number: ",d.payment_reference||"Pending"]})]})}):(0,u.jsxs)("div",{className:"purchase-subscription-page",children:[(0,u.jsxs)("div",{className:"purchase-page-header",children:[(0,u.jsx)("h1",{children:"Purchase Subscription"}),(0,u.jsx)("p",{children:"Complete your subscription purchase by providing payment details"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h(null),f(!0);try{const e=await B(d);e&&(y(!0),setTimeout(()=>{i&&i(e)},2e3))}catch(t){console.error("Error purchasing subscription:",t),h(t.message||"Failed to purchase subscription. Please try again.")}finally{f(!1)}},className:"purchase-form",children:[(0,u.jsxs)("div",{className:"form-section",children:[(0,u.jsx)("h2",{children:"Plan Summary"}),S&&(0,u.jsxs)("div",{className:"plan-summary",children:[(0,u.jsxs)("div",{className:"summary-row",children:[(0,u.jsx)("span",{className:"summary-label",children:"Plan:"}),(0,u.jsx)("span",{className:"summary-value",children:S.name})]}),(0,u.jsxs)("div",{className:"summary-row",children:[(0,u.jsx)("span",{className:"summary-label",children:"User Range:"}),(0,u.jsx)("span",{className:"summary-value",children:S.min_users===S.max_users?"".concat(S.min_users," user").concat(S.min_users>1?"s":""):"".concat(S.min_users,"-").concat(S.max_users," users")})]}),(0,u.jsxs)("div",{className:"summary-row",children:[(0,u.jsx)("span",{className:"summary-label",children:"Billing Cycle:"}),(0,u.jsx)("span",{className:"summary-value",children:d.billing_cycle.charAt(0).toUpperCase()+d.billing_cycle.slice(1)})]}),(0,u.jsxs)("div",{className:"summary-row",children:[(0,u.jsx)("span",{className:"summary-label",children:"Price:"}),(0,u.jsxs)("span",{className:"summary-value",children:["\u20b9","yearly"===d.billing_cycle?null===(t=S.yearly_price)||void 0===t?void 0:t.toLocaleString("en-IN"):null===(n=S.monthly_price)||void 0===n?void 0:n.toLocaleString("en-IN"),"/","yearly"===d.billing_cycle?"year":"month"]})]})]})]}),(0,u.jsxs)("div",{className:"form-section",children:[(0,u.jsx)("h2",{children:"Payment Details"}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_method",children:"Payment Method *"}),(0,u.jsxs)("select",{id:"payment_method",name:"payment_method",value:d.payment_method,onChange:j,required:!0,children:[(0,u.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,u.jsx)("option",{value:"cheque",children:"Cheque"}),(0,u.jsx)("option",{value:"cash",children:"Cash"}),(0,u.jsx)("option",{value:"online",children:"Online"})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"payment_reference",children:["Payment Reference *",(0,u.jsx)("span",{className:"field-hint",children:"(Transaction ID, Cheque Number, etc.)"})]}),(0,u.jsx)("input",{type:"text",id:"payment_reference",name:"payment_reference",value:d.payment_reference,onChange:j,required:!0,placeholder:"Enter payment reference"})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_date",children:"Payment Date *"}),(0,u.jsx)("input",{type:"date",id:"payment_date",name:"payment_date",value:d.payment_date,onChange:j,required:!0,max:(new Date).toISOString().split("T")[0]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_proof",children:"Payment Proof (Optional but Recommended)"}),(0,u.jsx)("input",{type:"file",id:"payment_proof",name:"payment_proof",onChange:async e=>{const t=e.target.files[0];t&&c(e=>(0,a.A)((0,a.A)({},e),{},{payment_proof_url:t.name}))},accept:".pdf,.jpg,.jpeg,.png"}),(0,u.jsx)("small",{className:"field-hint",children:"Upload payment receipt, screenshot, or proof document"})]})]}),(0,u.jsxs)("div",{className:"form-section",children:[(0,u.jsx)("h2",{children:"Optional Information"}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"partner_id",children:"Partner Referral Code (Optional)"}),(0,u.jsx)("input",{type:"text",id:"partner_id",name:"partner_id",value:d.partner_id||"",onChange:j,placeholder:"Enter partner referral code"})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"employee_id",children:"Employee ID (Optional)"}),(0,u.jsx)("input",{type:"text",id:"employee_id",name:"employee_id",value:d.employee_id||"",onChange:j,placeholder:"Enter employee ID"})]})]}),m&&(0,u.jsx)("div",{className:"error-message",children:m}),(0,u.jsxs)("div",{className:"form-actions",children:[l&&(0,u.jsx)("button",{type:"button",onClick:l,className:"cancel-button",disabled:x,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:x,children:x?"Submitting...":"Submit Payment"})]})]})]})},q=e=>{var t,n,o,r;let{mode:i="upgrade",onSuccess:l,onCancel:c}=e;const[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)([]),[m,h]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),[v,j]=(0,s.useState)(!0),[S,w]=(0,s.useState)(!1),[k,_]=(0,s.useState)(!1),[N,C]=(0,s.useState)(null),[z,I]=(0,s.useState)(!1),[A,T]=(0,s.useState)({payment_method:"bank_transfer",payment_reference:"",payment_proof_url:"",payment_date:(new Date).toISOString().split("T")[0]});(0,s.useEffect)(()=>{R()},[]),(0,s.useEffect)(()=>{m&&p&&E()},[m,i]);const R=async()=>{try{j(!0);const[e,t]=await Promise.all([P(),L()]);g(e);const n=t.slabs;if(e){const t=e.internal_slab_id,a=n.filter(e=>"upgrade"===i?e.id>t:e.id<t);f(a)}else f(n)}catch(e){console.error("Error fetching data:",e),C("Failed to load subscription data. Please try again.")}finally{j(!1)}},E=async()=>{if("upgrade"===i)try{w(!0),C(null);const e=await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/billing/calculate-upgrade"),{new_slab_id:e});return(null===t||void 0===t?void 0:t.data)||null})(m);y(e)}catch(e){console.error("Error calculating upgrade:",e),C("Failed to calculate upgrade amount. Please try again.")}finally{w(!1)}},B=e=>{const{name:t,value:n}=e.target;T(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n||null}))};if(v)return(0,u.jsx)("div",{className:"upgrade-downgrade-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading subscription data..."})]})});const M=x.find(e=>e.id===m),F=p?x.find(e=>e.id===p.internal_slab_id):null;return(0,u.jsxs)("div",{className:"upgrade-downgrade-page",children:[(0,u.jsxs)("div",{className:"page-header",children:[(0,u.jsxs)("h1",{children:["upgrade"===i?"Upgrade":"Downgrade"," Subscription"]}),(0,u.jsxs)("p",{children:["Select a new plan to ",i," your subscription"]})]}),p&&F&&(0,u.jsxs)("div",{className:"current-plan-section",children:[(0,u.jsx)("h2",{children:"Current Plan"}),(0,u.jsx)(D,{plan:F,billingCycle:p.billing_cycle,isCurrent:!0})]}),(0,u.jsxs)("div",{className:"available-plans-section",children:[(0,u.jsx)("h2",{children:"Available Plans"}),0===x.length?(0,u.jsxs)("p",{className:"no-plans-message",children:["No ","upgrade"===i?"higher":"lower"," plans available."]}):(0,u.jsx)("div",{className:"plans-grid",children:x.map(e=>(0,u.jsx)(D,{plan:e,billingCycle:(null===p||void 0===p?void 0:p.billing_cycle)||"monthly",isSelected:m===e.id,onSelect:()=>{return t=e.id,h(t),y(null),I(!1),void C(null);var t}},e.id))})]}),M&&"upgrade"===i&&b&&(0,u.jsxs)("div",{className:"preview-section",children:[(0,u.jsx)("h2",{children:"Upgrade Preview"}),(0,u.jsxs)("div",{className:"preview-card",children:[(0,u.jsxs)("div",{className:"preview-row",children:[(0,u.jsx)("span",{className:"preview-label",children:"Old Price:"}),(0,u.jsxs)("span",{className:"preview-value",children:["\u20b9",null===(t=b.oldPrice)||void 0===t?void 0:t.toLocaleString("en-IN")]})]}),(0,u.jsxs)("div",{className:"preview-row",children:[(0,u.jsx)("span",{className:"preview-label",children:"New Price:"}),(0,u.jsxs)("span",{className:"preview-value",children:["\u20b9",null===(n=b.newPrice)||void 0===n?void 0:n.toLocaleString("en-IN")]})]}),(0,u.jsxs)("div",{className:"preview-row",children:[(0,u.jsx)("span",{className:"preview-label",children:"Days Remaining:"}),(0,u.jsxs)("span",{className:"preview-value",children:[b.daysRemaining," days"]})]}),(0,u.jsxs)("div",{className:"preview-row highlight",children:[(0,u.jsx)("span",{className:"preview-label",children:"Amount to Charge:"}),(0,u.jsxs)("span",{className:"preview-value",children:["\u20b9",null===(o=b.total_amount)||void 0===o?void 0:o.toLocaleString("en-IN")]})]})]})]}),N&&(0,u.jsxs)("div",{className:"error-container ".concat("user_limit"===N.type?"error-user-limit":""),children:[(0,u.jsx)("p",{className:"error-message",children:N.message}),"user_limit"===N.type&&(0,u.jsxs)("div",{className:"error-details",children:[(0,u.jsxs)("p",{children:["Current Users: ",N.currentCount]}),(0,u.jsxs)("p",{children:["New Limit: ",N.newLimit]}),(0,u.jsxs)("p",{children:["Excess Users: ",N.excessUsers]}),(0,u.jsxs)("p",{className:"error-action",children:["Please remove ",N.excessUsers," user(s) before downgrading."]})]})]}),M&&(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),C(null),_(!0);try{let e;e="upgrade"===i?await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/upgrade"),e);return(null===t||void 0===t?void 0:t.data)||null})((0,a.A)({new_slab_id:m},A)):await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/downgrade"),e);return(null===t||void 0===t?void 0:t.data)||null})({new_slab_id:m}),e&&l&&l(e)}catch(n){var t;console.error("Error ".concat(i,"ing subscription:"),n),"USER_COUNT_EXCEEDS_LIMIT"===(null===(t=n.error)||void 0===t?void 0:t.code)?C({type:"user_limit",message:n.error.message,currentCount:n.error.current_count,newLimit:n.error.new_limit,excessUsers:n.error.excess_users}):C({type:"general",message:n.message||"Failed to ".concat(i," subscription. Please try again.")})}finally{_(!1)}},className:"upgrade-form",children:["upgrade"===i&&(0,u.jsxs)("div",{className:"payment-section",children:[(0,u.jsx)("h2",{children:"Payment Details"}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_method",children:"Payment Method *"}),(0,u.jsxs)("select",{id:"payment_method",name:"payment_method",value:A.payment_method,onChange:B,required:!0,children:[(0,u.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,u.jsx)("option",{value:"cheque",children:"Cheque"}),(0,u.jsx)("option",{value:"cash",children:"Cash"}),(0,u.jsx)("option",{value:"online",children:"Online"})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_reference",children:"Payment Reference *"}),(0,u.jsx)("input",{type:"text",id:"payment_reference",name:"payment_reference",value:A.payment_reference,onChange:B,required:!0,placeholder:"Enter payment reference"})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_date",children:"Payment Date *"}),(0,u.jsx)("input",{type:"date",id:"payment_date",name:"payment_date",value:A.payment_date,onChange:B,required:!0,max:(new Date).toISOString().split("T")[0]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"payment_proof",children:"Payment Proof (Optional)"}),(0,u.jsx)("input",{type:"file",id:"payment_proof",name:"payment_proof",accept:".pdf,.jpg,.jpeg,.png"})]})]}),"downgrade"===i&&b&&(0,u.jsxs)("div",{className:"downgrade-preview",children:[(0,u.jsx)("h2",{children:"Downgrade Preview"}),(0,u.jsxs)("div",{className:"preview-card",children:[(0,u.jsxs)("div",{className:"preview-row highlight",children:[(0,u.jsx)("span",{className:"preview-label",children:"Credit Amount:"}),(0,u.jsxs)("span",{className:"preview-value",children:["\u20b9",null===(r=b.creditAmount)||void 0===r?void 0:r.toLocaleString("en-IN")]})]}),(0,u.jsx)("p",{className:"preview-note",children:"This amount will be credited to your account and applied to your next billing cycle."})]})]}),(0,u.jsxs)("div",{className:"form-actions",children:[c&&(0,u.jsx)("button",{type:"button",onClick:c,className:"cancel-button",disabled:k,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:k||S,children:k?"".concat("upgrade"===i?"Upgrading":"Downgrading","..."):"Confirm ".concat("upgrade"===i?"Upgrade":"Downgrade")})]})]})]})},V=e=>{let{onViewInvoice:t}=e;const[n,o]=(0,s.useState)([]),[r,i]=(0,s.useState)({status:"",limit:50,offset:0}),[l,c]=(0,s.useState)(!0),[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{m()},[r]);const m=async()=>{try{c(!0),g(null);const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{limit:t=50,offset:n=0,status:a=""}=e;let s="".concat(W,"/billing/history?limit=").concat(t,"&offset=").concat(n);a&&(s+="&status=".concat(a));const o=await(0,d.Vg)(s);return(null===o||void 0===o?void 0:o.data)||[]}(r);o(e)}catch(e){console.error("Error fetching billing history:",e),g("Failed to load billing history. Please try again.")}finally{c(!1)}},h=async e=>{try{const n=await(async e=>{const t=await(0,d.Vg)("".concat(W,"/billing/invoice/").concat(e));return(null===t||void 0===t?void 0:t.data)||null})(e);f(n),t&&t(n)}catch(n){console.error("Error fetching invoice:",n),alert("Failed to load invoice details.")}},b=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e),y=e=>e?new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"N/A";return l&&0===n.length?(0,u.jsx)("div",{className:"billing-history-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading billing history..."})]})}):(0,u.jsxs)("div",{className:"billing-history-page",children:[(0,u.jsxs)("div",{className:"billing-page-header",children:[(0,u.jsx)("h1",{children:"Billing History"}),(0,u.jsx)("p",{children:"View all your invoices and payment records"})]}),(0,u.jsx)("div",{className:"billing-filters",children:(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{htmlFor:"status_filter",children:"Filter by Status:"}),(0,u.jsxs)("select",{id:"status_filter",name:"status",value:r.status,onChange:e=>{const{name:t,value:n}=e.target;i(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n,offset:0}))},children:[(0,u.jsx)("option",{value:"",children:"All Status"}),(0,u.jsx)("option",{value:"paid",children:"Paid"}),(0,u.jsx)("option",{value:"pending_validation",children:"Pending Validation"}),(0,u.jsx)("option",{value:"pending_payment",children:"Pending Payment"}),(0,u.jsx)("option",{value:"failed",children:"Failed"})]})]})}),p&&(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:p}),(0,u.jsx)("button",{onClick:m,className:"retry-button",children:"Retry"})]}),0!==n.length||l?(0,u.jsx)("div",{className:"billing-table-container",children:(0,u.jsxs)("table",{className:"billing-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Invoice Number"}),(0,u.jsx)("th",{children:"Date"}),(0,u.jsx)("th",{children:"Amount"}),(0,u.jsx)("th",{children:"Discount"}),(0,u.jsx)("th",{children:"Tax"}),(0,u.jsx)("th",{children:"Total"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Payment Method"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:n.map(e=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"invoice-number",children:e.invoice_number||"N/A"}),(0,u.jsx)("td",{children:y(e.billing_date||e.payment_date)}),(0,u.jsx)("td",{children:b(e.amount||0)}),(0,u.jsx)("td",{children:b(e.discount_amount||0)}),(0,u.jsx)("td",{children:b(e.tax_amount||0)}),(0,u.jsx)("td",{className:"total-amount",children:b(e.total_amount||0)}),(0,u.jsx)("td",{children:(0,u.jsx)(M,{status:e.status})}),(0,u.jsx)("td",{children:e.payment_method||"N/A"}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"view-invoice-button",onClick:()=>h(e.id),children:"View"})})]},e.id))})]})}):(0,u.jsx)("div",{className:"no-billing-container",children:(0,u.jsx)("p",{children:"No billing records found."})}),x&&(0,u.jsx)("div",{className:"invoice-modal",children:(0,u.jsxs)("div",{className:"invoice-modal-content",children:[(0,u.jsxs)("div",{className:"invoice-modal-header",children:[(0,u.jsx)("h2",{children:"Invoice Details"}),(0,u.jsx)("button",{className:"close-button",onClick:()=>f(null),children:"\xd7"})]}),(0,u.jsxs)("div",{className:"invoice-modal-body",children:[(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Invoice Number:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:x.invoice_number})]}),(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Billing Date:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:y(x.billing_date)})]}),(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Amount:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:b(x.amount||0)})]}),(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Discount:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:b(x.discount_amount||0)})]}),(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Tax:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:b(x.tax_amount||0)})]}),(0,u.jsxs)("div",{className:"invoice-detail-row highlight",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Total Amount:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:b(x.total_amount||0)})]}),(0,u.jsxs)("div",{className:"invoice-detail-row",children:[(0,u.jsx)("span",{className:"invoice-detail-label",children:"Status:"}),(0,u.jsx)("span",{className:"invoice-detail-value",children:(0,u.jsx)(M,{status:x.status})})]})]})]})})]})},J=e=>{let{onAddUser:t,onUpgrade:n}=e;const[a,o]=(0,s.useState)(null),[r,i]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{p()},[]);const p=async()=>{try{i(!0),c(null);const e=await(async()=>{const e=await(0,d.Vg)("".concat(W,"/usage/current"));return(null===e||void 0===e?void 0:e.data)||null})();o(e)}catch(e){console.error("Error fetching usage:",e),c("Failed to load usage statistics. Please try again.")}finally{i(!1)}},g=async e=>{try{const a=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=await(0,d.apiPost)("".concat(W,"/usage/validate"),{user_type:e,count:t});return(null===n||void 0===n?void 0:n.data)||null}(e,1);a.allowed?t&&t(e):a.requires_upgrade&&n?window.confirm("".concat(a.reason,"\n\nWould you like to upgrade your plan?"))&&n():alert(a.reason)}catch(a){console.error("Error validating user addition:",a),alert("Failed to validate user addition. Please try again.")}};if(r)return(0,u.jsx)("div",{className:"usage-dashboard-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading usage statistics..."})]})});if(l)return(0,u.jsx)("div",{className:"usage-dashboard-page",children:(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:l}),(0,u.jsx)("button",{onClick:p,className:"retry-button",children:"Retry"})]})});if(!a)return(0,u.jsx)("div",{className:"usage-dashboard-page",children:(0,u.jsxs)("div",{className:"no-usage-container",children:[(0,u.jsx)("h2",{children:"No Usage Data Available"}),(0,u.jsx)("p",{children:"Unable to load usage statistics. Please try again later."})]})});const x=a.internal_users,f=x&&x.remaining>0;return(0,u.jsxs)("div",{className:"usage-dashboard-page",children:[(0,u.jsxs)("div",{className:"usage-page-header",children:[(0,u.jsx)("h1",{children:"Usage Dashboard"}),(0,u.jsx)("p",{children:"Monitor your subscription usage and limits"})]}),(0,u.jsx)("div",{className:"usage-cards-section",children:x&&(0,u.jsxs)("div",{className:"usage-card-wrapper",children:[(0,u.jsx)(F,{title:"Internal Users",current:x.current,limit:x.limit,remaining:x.remaining}),(0,u.jsxs)("div",{className:"usage-actions",children:[(0,u.jsx)("button",{className:"add-user-button ".concat(f?"":"disabled"),onClick:()=>g("internal"),disabled:!f,children:f?"Add Internal User":"Limit Reached"}),!f&&n&&(0,u.jsx)("button",{className:"upgrade-button",onClick:n,children:"Upgrade Plan"})]})]})}),(0,u.jsxs)("div",{className:"usage-info-section",children:[(0,u.jsx)("h2",{children:"Usage Information"}),(0,u.jsx)("div",{className:"info-cards",children:x&&(0,u.jsxs)("div",{className:"info-card",children:[(0,u.jsx)("h3",{children:"Internal Users"}),(0,u.jsx)("p",{children:"Internal users have full access to all features and can manage the subscription."}),(0,u.jsxs)("ul",{children:[(0,u.jsxs)("li",{children:["Current: ",x.current," users"]}),(0,u.jsxs)("li",{children:["Limit: ",x.limit," users"]}),(0,u.jsxs)("li",{children:["Remaining: ",x.remaining," users"]})]})]})})]})]})},X=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)({limit:10,offset:0,date_from:""}),[r,i]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)(null),[m,h]=(0,s.useState)("");(0,s.useEffect)(()=>{b()},[n]);const b=async()=>{try{i(!0),c(null);const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{limit:t=10,offset:n=0,date_from:a=""}=e;let s="".concat(W,"/admin/payments/pending?limit=").concat(t,"&offset=").concat(n);a&&(s+="&date_from=".concat(a));const o=await(0,d.Vg)(s);return(null===o||void 0===o?void 0:o.data)||[]}(n);t(e)}catch(e){console.error("Error fetching pending payments:",e),c("Failed to load pending payments. Please try again.")}finally{i(!1)}},y=async e=>{try{const t=await(async e=>{const t=await(0,d.Vg)("".concat(W,"/admin/payments/pending/").concat(e));return(null===t||void 0===t?void 0:t.data)||null})(e);g(t)}catch(t){console.error("Error fetching payment details:",t),alert("Failed to load payment details.")}},v=async e=>{if(x)try{const t=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a=await(0,d.apiPost)("".concat(W,"/admin/payments/validate/").concat(e),{action:t,validation_notes:n});return(null===a||void 0===a?void 0:a.data)||null}(x.id,e,m);t&&(f(null),h(""),b(),alert("Payment ".concat("approve"===e?"approved":"rejected"," successfully.")))}catch(t){console.error("Error validating payment:",t),alert("Failed to ".concat(e," payment. Please try again."))}},j=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e);return r&&0===e.length?(0,u.jsx)("div",{className:"payment-validation-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading pending payments..."})]})}):(0,u.jsxs)("div",{className:"payment-validation-page",children:[(0,u.jsxs)("div",{className:"validation-page-header",children:[(0,u.jsx)("h1",{children:"Payment Validation"}),(0,u.jsx)("p",{children:"Review and validate pending payment submissions"})]}),(0,u.jsxs)("div",{className:"validation-filters",children:[(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{htmlFor:"date_from",children:"Date From:"}),(0,u.jsx)("input",{type:"date",id:"date_from",name:"date_from",value:n.date_from,onChange:e=>o(t=>(0,a.A)((0,a.A)({},t),{},{date_from:e.target.value}))})]}),(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{htmlFor:"limit",children:"Results per page:"}),(0,u.jsxs)("select",{id:"limit",name:"limit",value:n.limit,onChange:e=>o(t=>(0,a.A)((0,a.A)({},t),{},{limit:parseInt(e.target.value)})),children:[(0,u.jsx)("option",{value:"10",children:"10"}),(0,u.jsx)("option",{value:"25",children:"25"}),(0,u.jsx)("option",{value:"50",children:"50"})]})]})]}),l&&(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:l}),(0,u.jsx)("button",{onClick:b,className:"retry-button",children:"Retry"})]}),0!==e.length||r?(0,u.jsx)("div",{className:"payments-table-container",children:(0,u.jsxs)("table",{className:"payments-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Invoice Number"}),(0,u.jsx)("th",{children:"Owner"}),(0,u.jsx)("th",{children:"Email"}),(0,u.jsx)("th",{children:"Amount"}),(0,u.jsx)("th",{children:"Payment Method"}),(0,u.jsx)("th",{children:"Payment Reference"}),(0,u.jsx)("th",{children:"Payment Date"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:e.map(e=>{return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"invoice-number",children:e.invoice_number||"N/A"}),(0,u.jsx)("td",{children:e.owner_name||"N/A"}),(0,u.jsx)("td",{children:e.owner_email||"N/A"}),(0,u.jsx)("td",{children:j(e.total_amount||0)}),(0,u.jsx)("td",{children:e.payment_method||"N/A"}),(0,u.jsx)("td",{children:e.payment_reference||"N/A"}),(0,u.jsx)("td",{children:(t=e.payment_date,t?new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"N/A")}),(0,u.jsx)("td",{children:(0,u.jsx)(M,{status:e.status})}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{className:"action-buttons",children:[(0,u.jsx)("button",{className:"view-button",onClick:()=>y(e.id),children:"View"}),(0,u.jsx)("button",{className:"validate-button",onClick:()=>(e=>{f(e),h("")})(e),children:"Validate"})]})})]},e.id);var t})})]})}):(0,u.jsx)("div",{className:"no-payments-container",children:(0,u.jsx)("p",{children:"No pending payments found."})}),p&&(0,u.jsx)("div",{className:"payment-modal",children:(0,u.jsxs)("div",{className:"payment-modal-content",children:[(0,u.jsxs)("div",{className:"payment-modal-header",children:[(0,u.jsx)("h2",{children:"Payment Details"}),(0,u.jsx)("button",{className:"close-button",onClick:()=>g(null),children:"\xd7"})]}),(0,u.jsxs)("div",{className:"payment-modal-body",children:[(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Invoice Number:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:p.invoice_number})]}),(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Owner:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:p.owner_name})]}),(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Email:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:p.owner_email})]}),(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Amount:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:j(p.total_amount||0)})]}),(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Payment Method:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:p.payment_method})]}),(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Payment Reference:"}),(0,u.jsx)("span",{className:"payment-detail-value",children:p.payment_reference})]}),p.payment_proof_url&&(0,u.jsxs)("div",{className:"payment-detail-row",children:[(0,u.jsx)("span",{className:"payment-detail-label",children:"Payment Proof:"}),(0,u.jsx)("a",{href:p.payment_proof_url,target:"_blank",rel:"noopener noreferrer",className:"proof-link",children:"View Proof"})]})]})]})}),x&&(0,u.jsx)("div",{className:"validation-modal",children:(0,u.jsxs)("div",{className:"validation-modal-content",children:[(0,u.jsxs)("div",{className:"validation-modal-header",children:[(0,u.jsx)("h2",{children:"Validate Payment"}),(0,u.jsx)("button",{className:"close-button",onClick:()=>{f(null),h("")},children:"\xd7"})]}),(0,u.jsxs)("div",{className:"validation-modal-body",children:[(0,u.jsxs)("p",{className:"validation-info",children:["Invoice: ",(0,u.jsx)("strong",{children:x.invoice_number}),(0,u.jsx)("br",{}),"Amount: ",(0,u.jsx)("strong",{children:j(x.total_amount||0)}),(0,u.jsx)("br",{}),"Owner: ",(0,u.jsx)("strong",{children:x.owner_name})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"validation_notes",children:"Validation Notes:"}),(0,u.jsx)("textarea",{id:"validation_notes",value:m,onChange:e=>h(e.target.value),rows:"4",placeholder:"Enter validation notes (optional)"})]}),(0,u.jsxs)("div",{className:"validation-actions",children:[(0,u.jsx)("button",{className:"reject-button",onClick:()=>v("reject"),children:"Reject"}),(0,u.jsx)("button",{className:"approve-button",onClick:()=>v("approve"),children:"Approve"})]})]})]})})]})},K=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(null),[r,i]=(0,s.useState)({discount_type:"percentage",discount_value:0,discount_reason:""}),[l,c]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null);return(0,u.jsxs)("div",{className:"discount-management-page",children:[(0,u.jsxs)("div",{className:"discount-page-header",children:[(0,u.jsx)("h1",{children:"Discount Management"}),(0,u.jsx)("p",{children:"Apply discounts to billing records"})]}),(0,u.jsx)("div",{className:"discount-form-container",children:(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n){c(!0),g(null);try{const e=await(async(e,t)=>{const n=await(0,d.apiPost)("".concat(W,"/admin/discounts/billing/").concat(e,"/apply"),t);return(null===n||void 0===n?void 0:n.data)||null})(n.id,r);e&&(alert("Discount applied successfully."),o(null),i({discount_type:"percentage",discount_value:0,discount_reason:""}))}catch(t){console.error("Error applying discount:",t),g(t.message||"Failed to apply discount. Please try again.")}finally{c(!1)}}},className:"discount-form",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"billing_id",children:"Select Billing Record *"}),(0,u.jsx)("input",{type:"number",id:"billing_id",placeholder:"Enter Billing ID",onChange:e=>o({id:parseInt(e.target.value)}),required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"discount_type",children:"Discount Type *"}),(0,u.jsxs)("select",{id:"discount_type",value:r.discount_type,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{discount_type:e.target.value})),required:!0,children:[(0,u.jsx)("option",{value:"percentage",children:"Percentage"}),(0,u.jsx)("option",{value:"fixed",children:"Fixed Amount"})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsxs)("label",{htmlFor:"discount_value",children:["Discount Value * (","percentage"===r.discount_type?"%":"\u20b9",")"]}),(0,u.jsx)("input",{type:"number",id:"discount_value",value:r.discount_value,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{discount_value:parseFloat(e.target.value)||0})),min:"0",step:"percentage"===r.discount_type?"1":"0.01",required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"discount_reason",children:"Discount Reason"}),(0,u.jsx)("textarea",{id:"discount_reason",value:r.discount_reason,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{discount_reason:e.target.value})),rows:"3",placeholder:"Enter reason for discount"})]}),p&&(0,u.jsx)("div",{className:"error-message",children:p}),(0,u.jsx)("div",{className:"form-actions",children:(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:l,children:l?"Applying...":"Apply Discount"})})]})})]})},Z=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[r,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)({name:"",description:"",min_users:1,max_users:1,monthly_price:0,yearly_price:0,free_external_users_per_internal_user:0,features_included:[]});(0,s.useEffect)(()=>{m()},[]);const m=async()=>{try{o(!0),i(null);const e=await L();t(e.slabs)}catch(e){console.error("Error fetching slabs:",e),i("Failed to load slabs. Please try again.")}finally{o(!1)}},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(g(e),f(e)):(g(null),f({name:"",description:"",min_users:1,max_users:1,monthly_price:0,yearly_price:0,free_external_users_per_internal_user:0,features_included:[]})),c(!0)},b=()=>{c(!1),g(null),f({name:"",description:"",min_users:1,max_users:1,monthly_price:0,yearly_price:0,free_external_users_per_internal_user:0,features_included:[]})},y=e=>{const{name:t,value:n,type:s,checked:o}=e.target;f(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"checkbox"===s?o:"number"===s?parseFloat(n)||0:n}))},v=async e=>{if(window.confirm("Are you sure you want to deactivate this slab?"))try{await(async e=>{const t=await(0,d.Al)("".concat(W,"/slabs/internal/").concat(e));return(null===t||void 0===t?void 0:t.success)||!1})(e),m(),alert("Slab deactivated successfully.")}catch(t){console.error("Error deleting slab:",t),alert("Failed to deactivate slab. Please try again.")}};return(0,u.jsxs)("div",{className:"slab-management-page",children:[(0,u.jsxs)("div",{className:"slab-page-header",children:[(0,u.jsx)("h1",{children:"Slab Management"}),(0,u.jsx)("p",{children:"Manage subscription slabs for internal users"})]}),(0,u.jsx)("div",{className:"slab-actions",children:(0,u.jsx)("button",{className:"add-slab-button",onClick:()=>h(),children:"+ Add New Slab"})}),r&&(0,u.jsx)("div",{className:"error-container",children:(0,u.jsx)("p",{className:"error-message",children:r})}),n?(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading slabs..."})]}):(0,u.jsx)("div",{className:"slabs-table-container",children:(0,u.jsxs)("table",{className:"slabs-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"User Range"}),(0,u.jsx)("th",{children:"Monthly Price (Per User)"}),(0,u.jsx)("th",{children:"Yearly Price (Per User)"}),(0,u.jsx)("th",{children:"Free External Users Per Internal User"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:e.map(e=>{var t,n;return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"slab-name",children:e.name}),(0,u.jsx)("td",{children:e.min_users===e.max_users?"".concat(e.min_users," user").concat(e.min_users>1?"s":""):"".concat(e.min_users,"-").concat(e.max_users," users")}),(0,u.jsxs)("td",{children:["\u20b9",null===(t=e.monthly_price)||void 0===t?void 0:t.toLocaleString("en-IN")]}),(0,u.jsxs)("td",{children:["\u20b9",null===(n=e.yearly_price)||void 0===n?void 0:n.toLocaleString("en-IN")]}),(0,u.jsx)("td",{children:e.free_external_users_per_internal_user||0}),(0,u.jsx)("td",{children:(0,u.jsx)("span",{className:"status-badge ".concat(e.is_active?"active":"inactive"),children:e.is_active?"Active":"Inactive"})}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{className:"action-buttons",children:[(0,u.jsx)("button",{className:"edit-button",onClick:()=>h(e),children:"Edit"}),e.is_active&&(0,u.jsx)("button",{className:"delete-button",onClick:()=>v(e.id),children:"Deactivate"})]})})]},e.id)})})]})}),l&&(0,u.jsx)("div",{className:"slab-modal",children:(0,u.jsxs)("div",{className:"slab-modal-content",children:[(0,u.jsxs)("div",{className:"slab-modal-header",children:[(0,u.jsxs)("h2",{children:[p?"Edit":"Create"," Internal Slab"]}),(0,u.jsx)("button",{className:"close-button",onClick:b,children:"\xd7"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(null);try{p?await(async(e,t)=>{const{created_at:n,updated_at:a}=t,s=(0,I.A)(t,E),o=await(0,d.mu)("".concat(W,"/slabs/internal/").concat(e),s);return(null===o||void 0===o?void 0:o.data)||null})(p.id,x):await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/slabs/internal"),e);return(null===t||void 0===t?void 0:t.data)||null})(x),b(),m(),alert("Slab ".concat(p?"updated":"created"," successfully."))}catch(t){console.error("Error saving slab:",t),i(t.message||"Failed to save slab. Please try again.")}},className:"slab-form",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"name",children:"Name *"}),(0,u.jsx)("input",{type:"text",id:"name",name:"name",value:x.name,onChange:y,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"description",children:"Description"}),(0,u.jsx)("textarea",{id:"description",name:"description",value:x.description,onChange:y,rows:"3"})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"min_users",children:"Min Users *"}),(0,u.jsx)("input",{type:"number",id:"min_users",name:"min_users",value:x.min_users,onChange:y,min:"1",required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"max_users",children:"Max Users *"}),(0,u.jsx)("input",{type:"number",id:"max_users",name:"max_users",value:x.max_users,onChange:y,min:"1",required:!0})]})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"monthly_price",children:"Monthly Price (Per User) *"}),(0,u.jsx)("input",{type:"number",id:"monthly_price",name:"monthly_price",value:x.monthly_price,onChange:y,min:"0",step:"0.01",required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"yearly_price",children:"Yearly Price (Per User) *"}),(0,u.jsx)("input",{type:"number",id:"yearly_price",name:"yearly_price",value:x.yearly_price,onChange:y,min:"0",step:"0.01",required:!0})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"free_external_users_per_internal_user",children:"Free External Users Per Internal User"}),(0,u.jsx)("input",{type:"number",id:"free_external_users_per_internal_user",name:"free_external_users_per_internal_user",value:x.free_external_users_per_internal_user,onChange:y,min:"0"}),(0,u.jsx)("small",{children:"Number of free external users provided for each internal user in this slab"})]}),(0,u.jsxs)("div",{className:"form-actions",children:[(0,u.jsx)("button",{type:"button",className:"cancel-button",onClick:b,children:"Cancel"}),(0,u.jsxs)("button",{type:"submit",className:"submit-button",children:[p?"Update":"Create"," Slab"]})]})]})]})})]})},$=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[r,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[p,g]=(0,s.useState)({name:"",email:"",mobileno:"",contact_info:"",commission_rate:0,commission_type:"percentage",referral_code:""}),[x,f]=(0,s.useState)(!1),[m,h]=(0,s.useState)({}),[b,y]=(0,s.useState)({limit:50,offset:0,is_active:""});(0,s.useEffect)(()=>{v()},[b]);const v=async()=>{try{o(!0),i(null);const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{limit:t=10,offset:n=0,is_active:a=""}=e;let s="".concat(W,"/admin/partners/all?limit=").concat(t,"&offset=").concat(n);""!==a&&(s+="&is_active=".concat(a));const o=await(0,d.Vg)(s);return(null===o||void 0===o?void 0:o.data)||[]}(b);t(e)}catch(e){console.error("Error fetching partners:",e),i("Failed to load partners. Please try again.")}finally{o(!1)}},j=e=>{const{name:t,value:n}=e.target;g(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"commission_rate"===t?parseFloat(n)||0:n}))},S=async(e,n)=>{const s=!n;h(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!0}));try{const n=await(async(e,t)=>{const n=await(0,d.mu)("".concat(W,"/admin/partners/").concat(e,"/status"),{is_active:t});return(null===n||void 0===n?void 0:n.data)||null})(e,s);n&&(t(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{is_active:s}):t)),alert("Partner status updated to ".concat(s?"Active":"Inactive",".")))}catch(o){console.error("Error updating partner status:",o),alert("Failed to update partner status. Please try again.")}finally{h(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!1}))}};return(0,u.jsxs)("div",{className:"partner-management-page",children:[(0,u.jsxs)("div",{className:"page-header",children:[(0,u.jsx)("h1",{children:"Partner Management"}),(0,u.jsx)("p",{children:"Create and manage partners for referral tracking"})]}),(0,u.jsxs)("div",{className:"page-actions",children:[(0,u.jsx)("button",{className:"create-button",onClick:()=>c(!0),children:"+ Create New Partner"}),(0,u.jsx)("div",{className:"filters",children:(0,u.jsxs)("select",{value:b.is_active,onChange:e=>y(t=>(0,a.A)((0,a.A)({},t),{},{is_active:e.target.value})),children:[(0,u.jsx)("option",{value:"",children:"All Partners"}),(0,u.jsx)("option",{value:"true",children:"Active Only"}),(0,u.jsx)("option",{value:"false",children:"Inactive Only"})]})})]}),r&&(0,u.jsx)("div",{className:"error-container",children:(0,u.jsx)("p",{className:"error-message",children:r})}),l&&(0,u.jsx)("div",{className:"modal-overlay",onClick:()=>c(!1),children:(0,u.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:"modal-header",children:[(0,u.jsx)("h2",{children:"Create New Partner"}),(0,u.jsx)("button",{className:"close-button",onClick:()=>c(!1),children:"\xd7"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(null),f(!0);try{await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/admin/partners/create"),e);return(null===t||void 0===t?void 0:t.data)||null})(p)&&(alert("Partner created successfully."),c(!1),g({name:"",email:"",mobileno:"",contact_info:"",commission_rate:0,commission_type:"percentage",referral_code:""}),v())}catch(t){console.error("Error creating partner:",t),i(t.message||"Failed to create partner. Please try again.")}finally{f(!1)}},className:"partner-form",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"name",children:"Partner Name *"}),(0,u.jsx)("input",{type:"text",id:"name",name:"name",value:p.name,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"email",children:"Email *"}),(0,u.jsx)("input",{type:"email",id:"email",name:"email",value:p.email,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"mobileno",children:"Mobile Number *"}),(0,u.jsx)("input",{type:"tel",id:"mobileno",name:"mobileno",value:p.mobileno,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"contact_info",children:"Contact Information"}),(0,u.jsx)("textarea",{id:"contact_info",name:"contact_info",value:p.contact_info,onChange:j,rows:"3",placeholder:"Address, etc."})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"commission_rate",children:"Commission Rate *"}),(0,u.jsx)("input",{type:"number",id:"commission_rate",name:"commission_rate",value:p.commission_rate,onChange:j,min:"0",step:"0.01",required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"commission_type",children:"Commission Type *"}),(0,u.jsxs)("select",{id:"commission_type",name:"commission_type",value:p.commission_type,onChange:j,required:!0,children:[(0,u.jsx)("option",{value:"percentage",children:"Percentage"}),(0,u.jsx)("option",{value:"fixed",children:"Fixed Amount"})]})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"referral_code",children:"Referral Code *"}),(0,u.jsx)("input",{type:"text",id:"referral_code",name:"referral_code",value:p.referral_code,onChange:j,required:!0,placeholder:"e.g., PART123"})]}),(0,u.jsxs)("div",{className:"form-actions",children:[(0,u.jsx)("button",{type:"button",className:"cancel-button",onClick:()=>c(!1),disabled:x,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:x,children:x?"Creating...":"Create Partner"})]})]})]})}),n?(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading partners..."})]}):(0,u.jsx)("div",{className:"partners-table-container",children:(0,u.jsxs)("table",{className:"partners-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"Email"}),(0,u.jsx)("th",{children:"Mobile"}),(0,u.jsx)("th",{children:"Referral Code"}),(0,u.jsx)("th",{children:"Commission Rate"}),(0,u.jsx)("th",{children:"Commission Type"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:0===e.length?(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"8",className:"no-data",children:"No partners found. Create your first partner to get started."})}):e.map(e=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"partner-name",children:e.name}),(0,u.jsx)("td",{children:e.email}),(0,u.jsx)("td",{children:e.mobileno}),(0,u.jsx)("td",{className:"referral-code",children:e.referral_code}),(0,u.jsxs)("td",{children:[e.commission_rate,"%"]}),(0,u.jsx)("td",{children:"percentage"===e.commission_type?"Percentage":"Fixed"}),(0,u.jsx)("td",{children:(0,u.jsx)("span",{className:"status-badge ".concat(e.is_active?"active":"inactive"),children:e.is_active?"Active":"Inactive"})}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"status-toggle-btn ".concat(e.is_active?"deactivate":"activate"),onClick:()=>S(e.id,e.is_active),disabled:m[e.id],title:e.is_active?"Deactivate Partner":"Activate Partner",children:m[e.id]?"Updating...":e.is_active?"Deactivate":"Activate"})})]},e.id))})]})})]})},Q=()=>{const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[r,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[p,g]=(0,s.useState)({name:"",email:"",mobileno:"",contact_info:"",employee_id:"",department:""}),[x,f]=(0,s.useState)(!1),[m,h]=(0,s.useState)({}),[b,y]=(0,s.useState)({limit:50,offset:0});(0,s.useEffect)(()=>{v()},[b]);const v=async()=>{try{o(!0),i(null);const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{limit:t=10,offset:n=0}=e,a=await(0,d.Vg)("".concat(W,"/admin/employees/all?limit=").concat(t,"&offset=").concat(n));return(null===a||void 0===a?void 0:a.data)||[]}(b);t(e)}catch(e){console.error("Error fetching employees:",e),i("Failed to load employees. Please try again.")}finally{o(!1)}},j=e=>{const{name:t,value:n}=e.target;g(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n}))},S=async(e,n)=>{const s=!n;h(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!0}));try{const n=await(async(e,t)=>{const n=await(0,d.mu)("".concat(W,"/admin/employees/").concat(e,"/status"),{is_active:t});return(null===n||void 0===n?void 0:n.data)||null})(e,s);n&&(t(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{is_active:s}):t)),alert("Employee status updated to ".concat(s?"Active":"Inactive",".")))}catch(o){console.error("Error updating employee status:",o),alert("Failed to update employee status. Please try again.")}finally{h(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!1}))}};return(0,u.jsxs)("div",{className:"employee-management-page",children:[(0,u.jsxs)("div",{className:"page-header",children:[(0,u.jsx)("h1",{children:"Employee Management"}),(0,u.jsx)("p",{children:"Create and manage employees for tracking and incentives"})]}),(0,u.jsx)("div",{className:"page-actions",children:(0,u.jsx)("button",{className:"create-button",onClick:()=>c(!0),children:"+ Create New Employee"})}),r&&(0,u.jsx)("div",{className:"error-container",children:(0,u.jsx)("p",{className:"error-message",children:r})}),l&&(0,u.jsx)("div",{className:"modal-overlay",onClick:()=>c(!1),children:(0,u.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:"modal-header",children:[(0,u.jsx)("h2",{children:"Create New Employee"}),(0,u.jsx)("button",{className:"close-button",onClick:()=>c(!1),children:"\xd7"})]}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(null),f(!0);try{await(async e=>{const t=await(0,d.apiPost)("".concat(W,"/admin/employees/create"),e);return(null===t||void 0===t?void 0:t.data)||null})(p)&&(alert("Employee created successfully."),c(!1),g({name:"",email:"",mobileno:"",contact_info:"",employee_id:"",department:""}),v())}catch(t){console.error("Error creating employee:",t),i(t.message||"Failed to create employee. Please try again.")}finally{f(!1)}},className:"employee-form",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"name",children:"Employee Name *"}),(0,u.jsx)("input",{type:"text",id:"name",name:"name",value:p.name,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"email",children:"Email *"}),(0,u.jsx)("input",{type:"email",id:"email",name:"email",value:p.email,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"mobileno",children:"Mobile Number *"}),(0,u.jsx)("input",{type:"tel",id:"mobileno",name:"mobileno",value:p.mobileno,onChange:j,required:!0})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"employee_id",children:"Employee ID *"}),(0,u.jsx)("input",{type:"text",id:"employee_id",name:"employee_id",value:p.employee_id,onChange:j,required:!0,placeholder:"e.g., EMP123"})]})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"department",children:"Department"}),(0,u.jsx)("input",{type:"text",id:"department",name:"department",value:p.department,onChange:j,placeholder:"e.g., Sales, Marketing"})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"contact_info",children:"Contact Information"}),(0,u.jsx)("textarea",{id:"contact_info",name:"contact_info",value:p.contact_info,onChange:j,rows:"3",placeholder:"Address, etc."})]}),(0,u.jsxs)("div",{className:"form-actions",children:[(0,u.jsx)("button",{type:"button",className:"cancel-button",onClick:()=>c(!1),disabled:x,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"submit-button",disabled:x,children:x?"Creating...":"Create Employee"})]})]})]})}),n?(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading employees..."})]}):(0,u.jsx)("div",{className:"employees-table-container",children:(0,u.jsxs)("table",{className:"employees-table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Name"}),(0,u.jsx)("th",{children:"Email"}),(0,u.jsx)("th",{children:"Mobile"}),(0,u.jsx)("th",{children:"Employee ID"}),(0,u.jsx)("th",{children:"Department"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Actions"})]})}),(0,u.jsx)("tbody",{children:0===e.length?(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"7",className:"no-data",children:"No employees found. Create your first employee to get started."})}):e.map(e=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"employee-name",children:e.name}),(0,u.jsx)("td",{children:e.email}),(0,u.jsx)("td",{children:e.mobileno}),(0,u.jsx)("td",{className:"employee-id",children:e.employee_id}),(0,u.jsx)("td",{children:e.department||"N/A"}),(0,u.jsx)("td",{children:(0,u.jsx)("span",{className:"status-badge ".concat(!1!==e.is_active?"active":"inactive"),children:!1!==e.is_active?"Active":"Inactive"})}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"status-toggle-btn ".concat(!1!==e.is_active?"deactivate":"activate"),onClick:()=>S(e.id,!1!==e.is_active),disabled:m[e.id],title:!1!==e.is_active?"Deactivate Employee":"Activate Employee",children:m[e.id]?"Updating...":!1!==e.is_active?"Deactivate":"Activate"})})]},e.id))})]})})]})},ee=()=>{const[e,t]=(0,s.useState)(null),[n,a]=(0,s.useState)(!0),[o,r]=(0,s.useState)(null);(0,s.useEffect)(()=>{i()},[]);const i=async()=>{try{a(!0),r(null);const e=await(async()=>{const e=await(0,d.Vg)("".concat(W,"/employee/dashboard"));return(null===e||void 0===e?void 0:e.data)||null})();t(e)}catch(e){console.error("Error fetching employee dashboard:",e),r("Failed to load dashboard data. Please try again.")}finally{a(!1)}};return n?(0,u.jsx)("div",{className:"employee-dashboard-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading dashboard..."})]})}):o?(0,u.jsx)("div",{className:"employee-dashboard-page",children:(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:o}),(0,u.jsx)("button",{onClick:i,className:"retry-button",children:"Retry"})]})}):e?(0,u.jsxs)("div",{className:"employee-dashboard-page",children:[(0,u.jsxs)("div",{className:"dashboard-header",children:[(0,u.jsx)("h1",{children:"Employee Dashboard"}),(0,u.jsxs)("p",{children:["Welcome, ",e.employee_name||"Employee"]})]}),(0,u.jsxs)("div",{className:"stats-grid",children:[(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Total Subscriptions"}),(0,u.jsx)("div",{className:"stat-value",children:e.total_subscriptions||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Active Subscriptions"}),(0,u.jsx)("div",{className:"stat-value",children:e.active_subscriptions||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Expiring Soon"}),(0,u.jsx)("div",{className:"stat-value",children:e.expiring_soon||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Expired"}),(0,u.jsx)("div",{className:"stat-value",children:e.expired||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Current Month"}),(0,u.jsx)("div",{className:"stat-value",children:e.current_month_subscriptions||0})]})]})]}):(0,u.jsx)("div",{className:"employee-dashboard-page",children:(0,u.jsx)("div",{className:"no-data-container",children:(0,u.jsx)("p",{children:"No dashboard data available."})})})},te=()=>{const[e,t]=(0,s.useState)(null),[n,a]=(0,s.useState)(!0),[o,r]=(0,s.useState)(null);(0,s.useEffect)(()=>{i()},[]);const i=async()=>{try{a(!0),r(null);const e=await(async()=>{const e=await(0,d.Vg)("".concat(W,"/partner/dashboard"));return(null===e||void 0===e?void 0:e.data)||null})();t(e)}catch(e){console.error("Error fetching partner dashboard:",e),r("Failed to load dashboard data. Please try again.")}finally{a(!1)}},l=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e);return n?(0,u.jsx)("div",{className:"partner-dashboard-page",children:(0,u.jsxs)("div",{className:"loading-container",children:[(0,u.jsx)("div",{className:"spinner"}),(0,u.jsx)("p",{children:"Loading dashboard..."})]})}):o?(0,u.jsx)("div",{className:"partner-dashboard-page",children:(0,u.jsxs)("div",{className:"error-container",children:[(0,u.jsx)("p",{className:"error-message",children:o}),(0,u.jsx)("button",{onClick:i,className:"retry-button",children:"Retry"})]})}):e?(0,u.jsxs)("div",{className:"partner-dashboard-page",children:[(0,u.jsxs)("div",{className:"dashboard-header",children:[(0,u.jsx)("h1",{children:"Partner Dashboard"}),(0,u.jsxs)("p",{children:["Welcome, ",e.partner_name||"Partner"]})]}),(0,u.jsxs)("div",{className:"stats-grid",children:[(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Total Customers"}),(0,u.jsx)("div",{className:"stat-value",children:e.total_customers||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Active Customers"}),(0,u.jsx)("div",{className:"stat-value",children:e.active_customers||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Expiring Soon"}),(0,u.jsx)("div",{className:"stat-value",children:e.expiring_soon||0})]}),(0,u.jsxs)("div",{className:"stat-card",children:[(0,u.jsx)("div",{className:"stat-label",children:"Expired"}),(0,u.jsx)("div",{className:"stat-value",children:e.expired||0})]})]}),(0,u.jsxs)("div",{className:"commission-section",children:[(0,u.jsx)("h2",{children:"Commission Summary"}),(0,u.jsxs)("div",{className:"commission-grid",children:[(0,u.jsxs)("div",{className:"commission-card",children:[(0,u.jsx)("div",{className:"commission-label",children:"Total Commissions"}),(0,u.jsx)("div",{className:"commission-value",children:l(e.total_commissions||0)})]}),(0,u.jsxs)("div",{className:"commission-card",children:[(0,u.jsx)("div",{className:"commission-label",children:"Pending Commissions"}),(0,u.jsx)("div",{className:"commission-value",children:l(e.pending_commissions||0)})]}),(0,u.jsxs)("div",{className:"commission-card",children:[(0,u.jsx)("div",{className:"commission-label",children:"Paid Commissions"}),(0,u.jsx)("div",{className:"commission-value",children:l(e.paid_commissions||0)})]})]})]})]}):(0,u.jsx)("div",{className:"partner-dashboard-page",children:(0,u.jsx)("div",{className:"no-data-container",children:(0,u.jsx)("p",{children:"No dashboard data available."})})})},ne=[{key:"company",label:"Company"},{key:"conn_name",label:"Site ID"},{key:"access_type",label:"Access Type"},{key:"shared_email",label:"Shared By/Owner"},{key:"status",label:"Status"}];const ae=function(){const e=sessionStorage.getItem("name"),t=sessionStorage.getItem("email"),n=sessionStorage.getItem("token"),c=()=>(sessionStorage.getItem("user_type")||"customer").trim().toLowerCase(),[p,g]=(0,s.useState)(c()),[m,b]=(0,o.ok)(),[y,v]=(0,s.useState)(m.get("view")||"dashboard");(0,s.useEffect)(()=>{const e=c();g(e),console.log("AdminDashboard - user_type from sessionStorage:",e),console.log("AdminDashboard - canAccessAdminSubscription check:","superadmin"===e),console.log("AdminDashboard - userType state:",p)},[]);const k=()=>{const e=(p||"").trim().toLowerCase();return"superadmin"===e||"customer"===e},I=()=>{const e=(p||"").trim().toLowerCase(),t="superadmin"===e;return console.log("canAccessAdminSubscription called:",{userType:p,normalizedType:e,hasAccess:t,sessionStorageValue:sessionStorage.getItem("user_type")}),t},A=()=>{const e=(p||"").trim().toLowerCase();return"superadmin"===e||"employee"===e},T=()=>{const e=(p||"").trim().toLowerCase();return"superadmin"===e||"partner"===e},[E,W]=(0,s.useState)(window.innerWidth>900),L=((0,s.useRef)(),(0,r.Zp)()),[B,P]=(0,s.useState)(!1),M=(0,s.useRef)(),[F,D]=(0,s.useState)(!1),[U,Y]=(0,s.useState)(null),[ae,se]=(0,s.useState)(localStorage.getItem("google_access_token")||null),[oe,re]=(0,s.useState)({show:!1,text:"",top:0}),[ie,le]=(0,s.useState)(!1),[de,ce]=(0,s.useState)({top:0,left:0,width:0}),pe=(0,s.useRef)(null),ge=(0,s.useRef)(null),[ue,xe]=(0,s.useState)({top:0,left:0}),[fe,me]=(0,s.useState)(!1),[he,be]=(0,s.useState)({top:0,left:0}),ye=(0,s.useRef)(null),[ve,je]=(0,s.useState)(!1),[Se,we]=(0,s.useState)({top:0,left:0}),ke=(0,s.useRef)(null);let _e=null;const Ne=f(),[Ce,ze]=(0,s.useState)(!1),Ie=[{key:"modules",label:"Modules Management",icon:"apps"},{key:"roles",label:"Roles Management",icon:"group"},{key:"create-access",label:"User Management",icon:"person_add"},{key:"share-access",label:"Share Access",icon:"share"},{key:"subscription",label:"Subscription",icon:"subscriptions"}];(0,s.useEffect)(()=>{const e=m.get("view");e&&["dashboard","tally-config","modules","roles","create-access","share-access","subscription"].includes(e)&&v(e)},[m]);const Ae=e=>{v(e),b({view:e}),window.innerWidth<=900&&W(!1)},[Te,Re]=(0,s.useState)([]),[Ee,We]=(0,s.useState)(!1),[Le,Be]=(0,s.useState)(""),[Pe,Me]=(0,s.useState)(""),Fe=Te.filter(e=>ne.some(t=>String(e[t.key]||"").toLowerCase().includes(Pe.toLowerCase()))),De=async e=>{if(console.log("\ud83d\udd0d Company clicked:",e),"Connected"!==e.status)return void console.log("\u26a0\ufe0f Company not connected, skipping navigation");console.log("\ud83d\udd0d Current auth state:",{token:!!sessionStorage.getItem("token"),email:!!sessionStorage.getItem("email"),name:!!sessionStorage.getItem("name")}),sessionStorage.setItem("tallyloc_id",e.tallyloc_id||""),sessionStorage.setItem("conn_name",e.conn_name||""),sessionStorage.setItem("company",e.company||""),sessionStorage.setItem("guid",e.guid||""),sessionStorage.setItem("shared_email",e.shared_email||""),sessionStorage.setItem("status",e.status||""),sessionStorage.setItem("access_type",e.access_type||""),sessionStorage.setItem("address",e.address||""),sessionStorage.setItem("pincode",e.pincode||""),sessionStorage.setItem("statename",e.statename||""),sessionStorage.setItem("countryname",e.countryname||""),sessionStorage.setItem("company_email",e.email||""),sessionStorage.setItem("phonenumber",e.phonenumber||""),sessionStorage.setItem("mobilenumbers",e.mobilenumbers||""),sessionStorage.setItem("gstinno",e.gstinno||""),sessionStorage.setItem("startingfrom",e.startingfrom||""),sessionStorage.setItem("booksfrom",e.booksfrom||""),sessionStorage.setItem("createdAt",e.createdAt||""),sessionStorage.setItem("selectedCompanyGuid",e.guid||""),sessionStorage.setItem("selectedCompanyTallylocId",e.tallyloc_id||"");const t=Te.filter(e=>"Connected"===e.status);sessionStorage.setItem("allConnections",JSON.stringify(t)),console.log("\ud83d\ude80 Navigating to /tally-dashboard"),L("/tally-dashboard")},Ue=async()=>{We(!0),Be("");const e=Date.now();try{const t=await(0,d.Vg)("/api/tally/user-connections?ts=".concat(e));if(t){let e=[];if(Array.isArray(t))e=t;else if(t.createdByMe&&t.sharedWithMe){const n=Array.isArray(t.createdByMe)?t.createdByMe.map(e=>(0,a.A)((0,a.A)({},e),{},{type:"Created By Me"})):[],s=Array.isArray(t.sharedWithMe)?t.sharedWithMe.map(e=>(0,a.A)((0,a.A)({},e),{},{type:"Shared With Me"})):[];e=[...n,...s]}Re(e),sessionStorage.setItem("allConnections",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("connectionsUpdated"))}}catch(t){Be("Failed to load connections")}finally{We(!1)}};(0,s.useEffect)(()=>{"dashboard"===y&&Ue()},[y,n]),(0,s.useEffect)(()=>{const e=()=>{window.innerWidth<=900&&E&&W(!1),window.innerWidth>900&&!E&&W(!0)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[E]);const Ye=[{key:"dashboard",label:"Home",icon:"home"},{key:"control-panel",label:"Control Panel",icon:"admin_panel_settings",subItems:[{key:"tally-config",label:"Tally Connections",icon:"settings"},...Ie]}];(0,s.useEffect)(()=>{function e(e){M.current&&!M.current.contains(e.target)&&P(!1),ge.current&&!ge.current.contains(e.target)&&le(!1)}return B||ie?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[B,ie]),(0,s.useEffect)(()=>{const e=()=>{if(ie&&pe.current){const e=pe.current.getBoundingClientRect();ce({top:e.top,left:e.left+e.width,width:e.width})}};if(ie){e();const t=()=>e(),n=()=>e();return window.addEventListener("resize",t),window.addEventListener("scroll",n,!0),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",n,!0)}}},[ie]),(0,s.useEffect)(()=>{const e=()=>{if(B&&M.current){const e=M.current.getBoundingClientRect();xe({top:Math.max(8,e.top-180),left:e.left+e.width+8})}};if(B){e();const t=()=>e(),n=()=>e();return window.addEventListener("resize",t),window.addEventListener("scroll",n,!0),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",n,!0)}}},[B,E]),(0,s.useEffect)(()=>{E||le(!1)},[E]),(0,s.useEffect)(()=>{["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)&&le(!0)},[y]);const Oe=()=>{sessionStorage.clear(),window.location.href="/Development"};return(0,u.jsxs)("div",{style:{width:"100%",minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #f8fafc 100%)"},children:[(0,u.jsx)("style",{children:"\n  @import url('https://fonts.googleapis.com/icon?family=Material+Icons');\n  .material-icons {\n    font-family: 'Material Icons';\n    font-weight: normal;\n    font-style: normal;\n    font-size: 24px;\n    line-height: 1;\n    letter-spacing: normal;\n    text-transform: none;\n    display: inline-block;\n    white-space: nowrap;\n    word-wrap: normal;\n    direction: ltr;\n    -webkit-font-feature-settings: 'liga';\n    -webkit-font-smoothing: antialiased;\n  }\n"}),Ne&&(0,u.jsx)("button",{onClick:()=>ze(!0),style:{position:"fixed",top:"16px",left:"16px",zIndex:1e4,background:"#fff",border:"1px solid #e5e7eb",borderRadius:"10px",width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f8fafc",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",e.currentTarget.style.transform="scale(1.05)"},onMouseLeave:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)",e.currentTarget.style.transform="scale(1)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#1e293b"},children:"menu"})}),Ne&&(0,u.jsx)(x,{isOpen:Ce,onClose:()=>ze(!1),sidebarItems:Ye,activeView:y,onViewChange:Ae,name:e,email:t,onProfileClick:()=>P(!0),onLogout:Oe,profileDropdownOpen:B,setProfileDropdownOpen:P,showGoogleConfigModal:F,setShowGoogleConfigModal:D,SubscriptionBadge:C,navigate:L}),F&&(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:5e3,display:"flex",alignItems:"center",justifyContent:"center",animation:"fadeIn 0.2s ease-out"},onClick:()=>D(!1),children:(0,u.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:16,padding:28,maxWidth:500,width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,u.jsxs)("h2",{style:{margin:0,fontSize:22,fontWeight:700,color:"#1e293b",display:"flex",alignItems:"center",gap:10},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:28,color:"#4285f4"},children:"account_circle"}),"Google Account Configuration"]}),(0,u.jsx)("button",{onClick:()=>D(!1),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",color:"#6b7280",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9",e.currentTarget.style.color="#1e293b"},onMouseLeave:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#6b7280"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24},children:"close"})})]}),(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsxs)("div",{style:{padding:16,borderRadius:12,background:(0,l.isGoogleDriveFullyConfigured)().configured?"#f0fdf4":"#fef2f2",border:"1px solid ".concat((0,l.isGoogleDriveFullyConfigured)().configured?"#86efac":"#fecaca"),marginBottom:20},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,color:(0,l.isGoogleDriveFullyConfigured)().configured?"#16a34a":"#dc2626"},children:(0,l.isGoogleDriveFullyConfigured)().configured?"check_circle":"error"}),(0,u.jsx)("span",{style:{fontWeight:600,color:"#1e293b"},children:"Configuration Status"})]}),(0,u.jsx)("div",{style:{fontSize:14,color:"#64748b",marginLeft:30},children:(0,l.isGoogleDriveFullyConfigured)().configured?"Google Drive API is configured and ready to use.":"Google Drive API credentials need to be configured in environment variables."})]}),(0,u.jsxs)("div",{style:{marginBottom:20},children:[(0,u.jsx)("h3",{style:{fontSize:16,fontWeight:600,color:"#1e293b",marginBottom:12},children:"Account Authentication"}),(0,u.jsx)("p",{style:{fontSize:14,color:"#64748b",marginBottom:16},children:"Connect your Google account to enable document upload and Google Drive integration features."}),(0,u.jsxs)("button",{onClick:async()=>{try{if(!(0,l.isGoogleDriveFullyConfigured)().configured)return void alert("Google API credentials are not configured. Please configure REACT_APP_GOOGLE_CLIENT_ID and REACT_APP_GOOGLE_API_KEY in your environment variables.");if(!window.google||!window.google.accounts){const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,document.body.appendChild(e),await new Promise(t=>{e.onload=t})}window.google.accounts.oauth2.initTokenClient({client_id:l.GOOGLE_DRIVE_CONFIG.CLIENT_ID,scope:l.GOOGLE_DRIVE_CONFIG.SCOPES,callback:e=>{e.error?Y({type:"error",message:e.error_description||"Authentication failed"}):e.access_token&&(se(e.access_token),Y({type:"success",message:"Google account connected successfully!"}),localStorage.setItem("google_access_token",e.access_token))}}).requestAccessToken({prompt:"consent"})}catch(e){Y({type:"error",message:e.message||"Failed to initialize Google authentication"})}},style:{width:"100%",padding:"14px 20px",background:ae?"linear-gradient(135deg, #34a853 0%, #28a745 100%)":"linear-gradient(135deg, #4285f4 0%, #1a73e8 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:15,cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(66,133,244,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:10,transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(66,133,244,0.35)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(66,133,244,0.25)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20},children:ae?"check_circle":"login"}),ae?"Re-authenticate Google Account":"Connect Google Account"]}),U&&(0,u.jsxs)("div",{style:{marginTop:16,padding:12,borderRadius:8,background:"success"===U.type?"#f0fdf4":"#fef2f2",border:"1px solid ".concat("success"===U.type?"#86efac":"#fecaca"),color:"success"===U.type?"#16a34a":"#dc2626",fontSize:14,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"success"===U.type?"check_circle":"error"}),U.message]}),ae&&(0,u.jsxs)("div",{style:{marginTop:16,padding:12,borderRadius:8,background:"#f0fdf4",border:"1px solid #86efac",fontSize:14,color:"#16a34a",display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"check_circle"}),"Google account is connected. The connection will remain active until you unlink or switch accounts."]})]})]})]})}),!Ne&&(0,u.jsxs)("aside",{className:"adminhome-sidebar sidebar-animated",style:{height:"100vh",position:"fixed",top:0,left:0,background:"#1e3a8a",overflowY:"auto",width:E?220:60,minWidth:E?220:60,maxWidth:E?220:60,transition:"width 0.3s, min-width 0.3s, max-width 0.3s",display:"flex",flexDirection:"column"},children:[(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"20px 12px",position:"relative",flexShrink:0},children:(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,u.jsx)("img",{src:i,alt:"DataLynk Logo",style:{width:E?"140px":"70px",height:E?"140px":"70px",filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1))",transition:"width 0.3s ease",objectFit:"contain"}})})}),(0,u.jsxs)("nav",{style:{display:"flex",flexDirection:"column",gap:18,fontSize:17,padding:"0 12px 12px 12px",flex:1,overflowY:"auto",minHeight:0},children:[(0,u.jsxs)("a",{href:"#",onClick:()=>{Ae("dashboard")},style:{color:"dashboard"===y?"#ff9800":"#fff",background:"dashboard"===y?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"dashboard"===y?700:500,margin:"0 8px",border:"dashboard"===y?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Home",onMouseEnter:e=>{if(!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Dashboard",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"home"}),E&&(0,u.jsx)("span",{className:"sidebar-link-label",children:"Home"})]}),(0,u.jsxs)("div",{style:{position:"relative"},ref:ge,children:[(0,u.jsxs)("a",{ref:pe,href:"#",onClick:e=>{e.preventDefault(),le(!ie)},style:{color:ie||["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)?"#ff9800":"#fff",background:ie||["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:ie||["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)?700:500,margin:"0 8px",border:ie||["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Control Panel",onMouseEnter:e=>{if(E&&le(!0),!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Control Panel",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"admin_panel_settings"}),E&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"sidebar-link-label",children:"Control Panel"}),(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,marginLeft:"auto",color:ie||["tally-config","modules","roles","create-access","share-access","subscription"].includes(y)?"#ff9800":"rgba(255, 255, 255, 0.7)",transition:"transform 0.2s",transform:ie?"rotate(180deg)":"rotate(0deg)"},children:"arrow_drop_down"})]})]}),E&&ie&&(0,u.jsxs)("div",{style:{position:"fixed",top:"".concat(de.top,"px"),left:"".concat(de.left+8,"px"),backgroundColor:"#1e3a8a",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"8px 0",minWidth:"220px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.3)",zIndex:1e4,display:"flex",flexDirection:"column",gap:2},onMouseEnter:()=>{if(le(!0),pe.current){const e=pe.current.getBoundingClientRect();ce({top:e.top,left:e.left+e.width,width:e.width})}},onMouseLeave:()=>le(!1),children:[(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("tally-config"),le(!1)},style:{color:"tally-config"===y?"#ff9800":"#fff",background:"tally-config"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"tally-config"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},onMouseEnter:e=>{"tally-config"!==y&&(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},onMouseLeave:e=>{"tally-config"!==y&&(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"settings"}),(0,u.jsx)("span",{children:"Tally Connections"})]}),Ie.map(e=>(0,u.jsxs)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),Ae(e.key),le(!1)},style:{color:y===e.key?"#ff9800":"#fff",background:y===e.key?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:y===e.key?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},onMouseEnter:t=>{y!==e.key&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},onMouseLeave:t=>{y!==e.key&&(t.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:e.icon}),(0,u.jsx)("span",{children:e.label})]},e.key))]})]}),k()&&(0,u.jsxs)("div",{style:{position:"relative"},ref:ye,children:[(0,u.jsxs)("a",{ref:ye,href:"#",onClick:e=>{e.preventDefault(),me(!fe)},style:{color:fe||["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard"].includes(y)?"#ff9800":"#fff",background:fe||["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard"].includes(y)?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:fe||["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard"].includes(y)?700:500,margin:"0 8px",border:fe||["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard"].includes(y)?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Subscription",onMouseEnter:e=>{if(E&&(me(!0),ye.current)){const e=ye.current.getBoundingClientRect();be({top:e.top,left:e.left+e.width,width:e.width})}if(!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Subscription",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"subscriptions"}),E&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"sidebar-link-label",children:"Subscription"}),(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,marginLeft:"auto",color:fe||["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard"].includes(y)?"#ff9800":"rgba(255, 255, 255, 0.7)",transition:"transform 0.2s",transform:fe?"rotate(180deg)":"rotate(0deg)"},children:"arrow_drop_down"})]})]}),E&&fe&&k()&&(0,u.jsxs)("div",{style:{position:"fixed",top:"".concat(he.top,"px"),left:"".concat(he.left+8,"px"),backgroundColor:"#1e3a8a",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"8px 0",minWidth:"220px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.3)",zIndex:1e4,display:"flex",flexDirection:"column",gap:2},onMouseEnter:()=>{if(me(!0),ye.current){const e=ye.current.getBoundingClientRect();be({top:e.top,left:e.left+e.width,width:e.width})}},onMouseLeave:()=>me(!1),children:[(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("subscription_plans"),me(!1)},style:{color:"subscription_plans"===y?"#ff9800":"#fff",background:"subscription_plans"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"subscription_plans"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"card_membership"}),(0,u.jsx)("span",{children:"Subscription Plans"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("current_subscription"),me(!1)},style:{color:"current_subscription"===y?"#ff9800":"#fff",background:"current_subscription"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"current_subscription"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"account_circle"}),(0,u.jsx)("span",{children:"My Subscription"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("purchase_subscription"),me(!1)},style:{color:"purchase_subscription"===y?"#ff9800":"#fff",background:"purchase_subscription"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"purchase_subscription"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"shopping_cart"}),(0,u.jsx)("span",{children:"Purchase Subscription"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("upgrade_downgrade"),me(!1)},style:{color:"upgrade_downgrade"===y?"#ff9800":"#fff",background:"upgrade_downgrade"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"upgrade_downgrade"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"trending_up"}),(0,u.jsx)("span",{children:"Upgrade/Downgrade"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("billing_history"),me(!1)},style:{color:"billing_history"===y?"#ff9800":"#fff",background:"billing_history"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"billing_history"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"receipt"}),(0,u.jsx)("span",{children:"Billing History"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("usage_dashboard"),me(!1)},style:{color:"usage_dashboard"===y?"#ff9800":"#fff",background:"usage_dashboard"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"usage_dashboard"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"dashboard"}),(0,u.jsx)("span",{children:"Usage Dashboard"})]})]})]}),(()=>{const e=I();return e?console.log("Subscription Admin menu WILL be rendered. userType:",p):console.log("Subscription Admin menu NOT rendered. userType:",p,"sessionStorage:",sessionStorage.getItem("user_type")),e})()&&(0,u.jsxs)("div",{style:{position:"relative"},ref:ke,children:[(0,u.jsxs)("a",{ref:ke,href:"#",onClick:e=>{e.preventDefault(),je(!ve)},style:{color:ve||["payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details"].includes(y)?"#ff9800":"#fff",background:ve||["payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details"].includes(y)?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:ve||["payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details"].includes(y)?700:500,margin:"0 8px",border:ve||["payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details"].includes(y)?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Subscription Admin",onMouseEnter:e=>{if(E&&(je(!0),ke.current)){const e=ke.current.getBoundingClientRect();we({top:e.top,left:e.left+e.width,width:e.width})}if(!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Subscription Admin",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"admin_panel_settings"}),E&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"sidebar-link-label",children:"Subscription Admin"}),(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18,marginLeft:"auto",color:ve||["payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details"].includes(y)?"#ff9800":"rgba(255, 255, 255, 0.7)",transition:"transform 0.2s",transform:ve?"rotate(180deg)":"rotate(0deg)"},children:"arrow_drop_down"})]})]}),E&&ve&&(0,u.jsxs)("div",{style:{position:"fixed",top:"".concat(Se.top,"px"),left:"".concat(Se.left+8,"px"),backgroundColor:"#1e3a8a",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"8px 0",minWidth:"220px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.3)",zIndex:1e4,display:"flex",flexDirection:"column",gap:2},onMouseEnter:()=>{if(je(!0),ke.current){const e=ke.current.getBoundingClientRect();we({top:e.top,left:e.left+e.width,width:e.width})}},onMouseLeave:()=>je(!1),children:[(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("payment_validation"),je(!1)},style:{color:"payment_validation"===y?"#ff9800":"#fff",background:"payment_validation"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"payment_validation"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"verified"}),(0,u.jsx)("span",{children:"Payment Validation"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("discount_management"),je(!1)},style:{color:"discount_management"===y?"#ff9800":"#fff",background:"discount_management"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"discount_management"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"local_offer"}),(0,u.jsx)("span",{children:"Discount Management"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("slab_management"),je(!1)},style:{color:"slab_management"===y?"#ff9800":"#fff",background:"slab_management"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"slab_management"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"layers"}),(0,u.jsx)("span",{children:"Slab Management"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("partner_management"),je(!1)},style:{color:"partner_management"===y?"#ff9800":"#fff",background:"partner_management"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"partner_management"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"handshake"}),(0,u.jsx)("span",{children:"Partner Management"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("employee_management"),je(!1)},style:{color:"employee_management"===y?"#ff9800":"#fff",background:"employee_management"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"employee_management"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"work"}),(0,u.jsx)("span",{children:"Employee Management"})]}),(0,u.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Ae("bank_details"),je(!1)},style:{color:"bank_details"===y?"#ff9800":"#fff",background:"bank_details"===y?"rgba(255, 152, 0, 0.15)":"transparent",padding:"12px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"bank_details"===y?700:500,margin:"0 8px",border:"none",cursor:"pointer",justifyContent:"flex-start",fontSize:"14px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"left"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:20,flexShrink:0},children:"account_balance"}),(0,u.jsx)("span",{children:"Bank Details"})]})]})]}),A()&&(0,u.jsxs)("a",{href:"#",onClick:e=>{e.preventDefault(),Ae("employee_portal")},style:{color:"employee_portal"===y?"#ff9800":"#fff",background:"employee_portal"===y?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"employee_portal"===y?700:500,margin:"0 8px",border:"employee_portal"===y?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Employee Portal",onMouseEnter:e=>{if(!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Employee Portal",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"work"}),E&&(0,u.jsx)("span",{className:"sidebar-link-label",children:"Employee Portal"})]}),T()&&(0,u.jsxs)("a",{href:"#",onClick:e=>{e.preventDefault(),Ae("partner_portal")},style:{color:"partner_portal"===y?"#ff9800":"#fff",background:"partner_portal"===y?"rgba(255,152,0,0.08)":"transparent",textDecoration:"none",padding:"10px 18px",display:"flex",alignItems:"center",gap:12,borderRadius:"8px",fontWeight:"partner_portal"===y?700:500,margin:"0 8px",border:"partner_portal"===y?"1px solid rgba(255, 255, 255, 0.2)":"1px solid transparent",cursor:"pointer",justifyContent:E?"flex-start":"center",position:"relative"},title:"Partner Portal",onMouseEnter:e=>{if(!E){const t=e.currentTarget.getBoundingClientRect();re({show:!0,text:"Partner Portal",top:t.top+window.scrollY}),_e&&clearTimeout(_e),_e=setTimeout(()=>{re({show:!1,text:"",top:0})},1500)}},onMouseLeave:()=>{_e&&clearTimeout(_e),re({show:!1,text:"",top:0})},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22},children:"handshake"}),E&&(0,u.jsx)("span",{className:"sidebar-link-label",children:"Partner Portal"})]})]}),E&&(0,u.jsx)("div",{style:{padding:"0 12px 12px 12px",flexShrink:0},children:(0,u.jsx)(C,{})}),E&&(0,u.jsxs)("div",{style:{padding:"0 12px 12px 12px",flexShrink:0,position:"relative"},children:[(0,u.jsxs)("div",{ref:M,style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",padding:"8px 12px",borderRadius:"8px",background:B?"rgba(255, 255, 255, 0.15)":"transparent",transition:"all 0.3s ease"},onClick:()=>P(e=>!e),onMouseEnter:e=>{B||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},onMouseLeave:e=>{B||(e.currentTarget.style.background="transparent")},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#fff",fontSize:24,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))"},children:"account_circle"}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0,flex:1},children:[(0,u.jsx)("div",{style:{color:"#fff",fontWeight:600,fontSize:13,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:e||"User"}),(0,u.jsx)("div",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:11,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:t||""})]}),(0,u.jsx)("span",{className:"material-icons",style:{color:"rgba(255, 255, 255, 0.8)",fontSize:20,transition:"transform 0.3s ease",transform:B?"rotate(180deg)":"rotate(0deg)"},children:"expand_more"})]}),B&&M.current&&(0,u.jsxs)("div",{style:{position:"fixed",top:"".concat(ue.top,"px"),left:"".concat(ue.left,"px"),minWidth:280,background:"#fff",borderRadius:12,boxShadow:"0 12px 40px 0 rgba(31, 38, 135, 0.2), 0 0 0 1px rgba(0,0,0,0.05)",padding:20,zIndex:4e3,textAlign:"left",animation:"fadeIn 0.2s ease-out"},onClick:e=>e.stopPropagation(),onMouseEnter:()=>{if(M.current){const e=M.current.getBoundingClientRect();xe({top:Math.max(8,e.top-180),left:e.left+e.width+8})}},onMouseLeave:()=>P(!1),children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,paddingBottom:12,borderBottom:"1px solid #e5e7eb"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32,color:"#3b82f6"},children:"account_circle"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:16,color:"#1e293b",fontWeight:700,marginBottom:2},children:e||"User"}),(0,u.jsx)("div",{style:{fontSize:13,color:"#64748b"},children:t||""})]})]}),(0,u.jsxs)("button",{style:{width:"100%",padding:"12px 18px",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(59,130,246,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:8,transition:"all 0.3s ease",marginBottom:10},onClick:()=>{L&&L("/change-password")},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(59,130,246,0.35)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(59,130,246,0.25)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"lock"}),"Change Password"]}),(0,u.jsxs)("button",{style:{width:"100%",padding:"12px 18px",background:"linear-gradient(135deg, #4285f4 0%, #34a853 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px 0 rgba(66,133,244,0.25)",display:"flex",alignItems:"center",justifyContent:"center",gap:8,transition:"all 0.3s ease",marginBottom:10},onClick:()=>{D(!0),P(!1)},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px 0 rgba(66,133,244,0.35)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px 0 rgba(66,133,244,0.25)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"account_circle"}),"Configure Google Account"]})]})]}),E&&(0,u.jsx)("div",{style:{padding:"0 12px 12px 12px",flexShrink:0},children:(0,u.jsxs)("button",{style:{width:"100%",background:"rgba(220, 38, 38, 0.15)",color:"#fff",border:"1px solid rgba(220, 38, 38, 0.3)",padding:"8px 12px",borderRadius:"8px",fontWeight:600,fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(220, 38, 38, 0.2)"},onClick:Oe,onMouseEnter:e=>{e.currentTarget.style.background="rgba(220, 38, 38, 0.25)",e.currentTarget.style.borderColor="rgba(220, 38, 38, 0.4)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(220, 38, 38, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(220, 38, 38, 0.15)",e.currentTarget.style.borderColor="rgba(220, 38, 38, 0.3)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 6px rgba(220, 38, 38, 0.2)"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"logout"}),(0,u.jsx)("span",{children:"Logout"})]})})]}),!Ne&&(0,u.jsx)("button",{className:"sidebar-toggle-btn-main",onClick:()=>W(!E),"aria-label":E?"Collapse sidebar":"Expand sidebar",style:{position:"fixed",top:12,left:(E?220:60)-18,zIndex:5e3,background:"#fff",border:"1.5px solid #cbd5e1",borderRadius:"50%",width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px 0 rgba(31,38,135,0.08)",cursor:"pointer",transition:"left 0.3s"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:22,color:"#1e40af"},children:E?"chevron_left":"chevron_right"})}),!Ne&&oe.show&&!E&&(0,u.jsx)("div",{className:"sidebar-tooltip",style:{top:oe.top},children:oe.text}),(0,u.jsx)("main",{className:"adminhome-main",style:{marginLeft:Ne?0:E?220:60,paddingTop:Ne?0:20,padding:Ne?12:20,transition:"margin 0.3s"},children:"dashboard"===y?(0,u.jsxs)("div",{style:{marginTop:50},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:32},children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h2",{style:{color:"#1e40af",fontWeight:700,fontSize:28,margin:0,display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:32,color:"#1e40af"},children:"account_tree"}),"List of Connections"]}),(0,u.jsx)("div",{style:{color:"#64748b",fontSize:16,marginTop:4},children:"Access Tally Data"})]}),(0,u.jsxs)("div",{style:{background:"#f0f9ff",color:"#0369a1",padding:"8px 16px",borderRadius:20,fontSize:14,fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:18},children:"bar_chart"}),Fe.length," connections available"]})]}),(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:24,marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center",gap:16},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flex:1},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#64748b",fontSize:20},children:"search"}),(0,u.jsx)("input",{type:"text",value:Pe,onChange:e=>Me(e.target.value),placeholder:"Search connections...",style:{padding:"12px 16px",borderRadius:8,border:"1.5px solid #e2e8f0",fontSize:16,width:"100%",maxWidth:400,outline:"none",background:"#f8fafc",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#e2e8f0"})]}),(0,u.jsx)("button",{onClick:Ue,style:{background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",border:"none",borderRadius:8,width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:"0 2px 8px 0 rgba(59,130,246,0.20)"},title:"Refresh connections",disabled:Ee,onMouseEnter:e=>{e.target.style.transform="scale(1.05)",e.target.style.boxShadow="0 4px 12px 0 rgba(59,130,246,0.30)"},onMouseLeave:e=>{e.target.style.transform="scale(1)",e.target.style.boxShadow="0 2px 8px 0 rgba(59,130,246,0.20)"},children:(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#fff",animation:Ee?"spin 1s linear infinite":"none"},children:"refresh"})})]}),Le&&(0,u.jsxs)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:16,padding:24,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("span",{className:"material-icons",style:{color:"#dc2626",fontSize:24},children:"error"}),(0,u.jsx)("div",{style:{color:"#dc2626",fontSize:16},children:Le})]}),(0,u.jsx)("style",{children:"\n                @keyframes spin {\n                  0% { transform: rotate(0deg); }\n                  100% { transform: rotate(360deg); }\n                }\n                @keyframes fadeIn {\n                  from { \n                    opacity: 0;\n                    transform: translateY(-8px);\n                  }\n                  to { \n                    opacity: 1;\n                    transform: translateY(0);\n                  }\n                }\n              "}),window.innerWidth>700?(0,u.jsx)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:0,marginBottom:32,overflow:"hidden"},children:0===Fe.length?(0,u.jsxs)("div",{style:{textAlign:"center",color:"#64748b",padding:60,background:"#f8fafc"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:64,color:"#cbd5e1",marginBottom:16,display:"block"},children:"account_tree"}),(0,u.jsx)("div",{style:{fontSize:18,fontWeight:600,marginBottom:8},children:"No connections found"}),(0,u.jsx)("div",{style:{fontSize:14},children:"Try adjusting your search criteria or create a new connection"})]}):(0,u.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[(0,u.jsx)("thead",{children:(0,u.jsx)("tr",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"},children:ne.map(e=>(0,u.jsx)("th",{style:{padding:"15px 18px",color:"#1e293b",fontWeight:700,textAlign:"left",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"2px solid #e2e8f0"},children:e.label},e.key))})}),(0,u.jsx)("tbody",{children:Ee?(0,u.jsx)("tr",{children:(0,u.jsxs)("td",{colSpan:ne.length,style:{padding:"40px 20px",textAlign:"center",color:"#64748b",background:"#f8fafc"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:24,color:"#3b82f6",marginRight:8,animation:"spin 1s linear infinite"},children:"sync"}),"Loading..."]})}):Fe.map((e,t)=>(0,u.jsx)("tr",{style:{background:t%2===0?"#fff":"#f8fafc",cursor:"Connected"===e.status?"pointer":"default",transition:"all 0.2s ease",borderBottom:"1px solid #f1f5f9"},onClick:"Connected"===e.status?()=>De(e):void 0,title:"Connected"===e.status?"Click to open Tally Dashboard":void 0,onMouseEnter:e=>{e.target.style.background="#f0f9ff",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px 0 rgba(59,130,246,0.10)"},onMouseLeave:e=>{e.target.style.background=t%2===0?"#fff":"#f8fafc",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:ne.map(t=>{let n={padding:"15px 18px",textAlign:"left",borderBottom:"1px solid #f1f5f9"};return"Connected"===e.status?(n.fontWeight=600,n.color="#1e293b"):"Offline"===e.status?(n.fontWeight=400,n.color="#94a3b8"):n.color="#64748b",(0,u.jsx)("td",{style:n,children:"status"===t.key?(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:(0,u.jsxs)("span",{style:{padding:"6px 12px",borderRadius:"18px",fontSize:"12px",fontWeight:600,background:"Connected"===e.status?"#dcfce7":"Offline"===e.status?"#fef2f2":"#f1f5f9",color:"Connected"===e.status?"#166534":"Offline"===e.status?"#dc2626":"#64748b",display:"flex",alignItems:"center",gap:5},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:"Connected"===e.status?"#22c55e":"Offline"===e.status?"#ef4444":"#64748b",display:"inline-block",verticalAlign:"middle",lineHeight:1},children:"Connected"===e.status?"check_circle":"Offline"===e.status?"cancel":"help_outline"}),e[t.key]]})}):"company"===t.key?(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:16},children:e.company?e.company.charAt(0).toUpperCase():"C"}),(0,u.jsx)("div",{children:(0,u.jsx)("div",{style:{fontWeight:600,color:"#1e293b"},children:e[t.key]})})]}):"access_type"===t.key?(0,u.jsx)("span",{style:{padding:"4px 12px",borderRadius:"10px",fontSize:"12px",fontWeight:600,background:"#e0f2fe",color:"#0c4a6e"},children:e[t.key]}):(0,u.jsx)("div",{style:{color:"Offline"===e.status?"#94a3b8":"#64748b"},children:e[t.key]})},t.key)})},e.tallyloc_id+"-"+e.guid+"-"+t))})]})}):(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:16,maxWidth:600,margin:"0 auto"},children:0===Fe.length?(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:40,textAlign:"center"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:48,color:"#cbd5e1",marginBottom:16,display:"block"},children:"account_tree"}),(0,u.jsx)("div",{style:{fontSize:16,fontWeight:600,marginBottom:8,color:"#64748b"},children:"No connections found"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:"Try adjusting your search criteria"})]}):Fe.map((e,t)=>{const n="Connected"===e.status,a="Offline"===e.status;return(0,u.jsxs)("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 4px 24px 0 rgba(31,38,135,0.08)",padding:20,cursor:n?"pointer":"default",transition:"all 0.2s ease",border:n?"2px solid transparent":"2px solid #f1f5f9",opacity:a?.7:1},onClick:n?()=>{console.log("\ud83d\udd25 CLICK EVENT TRIGGERED!"),De(e)}:void 0,title:n?"Tap to open Tally Dashboard":void 0,onMouseEnter:e=>{n&&(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 8px 32px 0 rgba(59,130,246,0.15)",e.target.style.borderColor="#3b82f6")},onMouseLeave:e=>{n&&(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 24px 0 rgba(31,38,135,0.08)",e.target.style.borderColor="transparent")},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,u.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:18},children:e.company?e.company.charAt(0).toUpperCase():"C"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:700,fontSize:16,color:a?"#94a3b8":"#1e293b",marginBottom:2},children:e.company}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#64748b",fontWeight:500},children:["Site ID: ",e.conn_name]})]})]}),(0,u.jsxs)("span",{style:{padding:"8px 16px",borderRadius:"20px",fontSize:"12px",fontWeight:600,background:n?"#dcfce7":a?"#fef2f2":"#f1f5f9",color:n?"#166534":a?"#dc2626":"#64748b",display:"flex",alignItems:"center",gap:6},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16,color:n?"#22c55e":a?"#ef4444":"#64748b"},children:n?"check_circle":a?"cancel":"help_outline"}),e.status]})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,padding:"16px 0",borderTop:"1px solid #f1f5f9"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:12,color:"#64748b",fontWeight:600,marginBottom:4},children:"ACCESS TYPE"}),(0,u.jsx)("span",{style:{padding:"4px 8px",borderRadius:"8px",fontSize:"11px",fontWeight:600,background:"#e0f2fe",color:"#0c4a6e"},children:e.access_type})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:12,color:"#64748b",fontWeight:600,marginBottom:4},children:"SHARED BY"}),(0,u.jsx)("div",{style:{fontSize:13,color:a?"#94a3b8":"#64748b",fontWeight:500},children:e.shared_email})]})]}),n&&(0,u.jsxs)("div",{style:{background:"#f0f9ff",borderRadius:8,padding:"8px 12px",marginTop:12,display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#0369a1"},children:[(0,u.jsx)("span",{className:"material-icons",style:{fontSize:16},children:"touch_app"}),"Tap to access Tally Dashboard"]})]},e.tallyloc_id+"-"+e.guid+"-"+t)})})]}):"tally-config"===y?(0,u.jsx)(h,{}):"create-access"===y?(0,u.jsx)(j,{}):"modules"===y?(0,u.jsx)(S.A,{}):"roles"===y?(0,u.jsx)(w.A,{}):"share-access"===y?(0,u.jsx)(_,{}):"subscription"===y?(0,u.jsx)(N.default,{}):"subscription_plans"===y&&k()?(0,u.jsx)(O,{}):"current_subscription"===y&&k()?(0,u.jsx)(G,{}):"purchase_subscription"===y&&k()?(0,u.jsx)(H,{}):"upgrade_downgrade"===y&&k()?(0,u.jsx)(q,{}):"billing_history"===y&&k()?(0,u.jsx)(V,{}):"usage_dashboard"===y&&k()?(0,u.jsx)(J,{}):"payment_validation"===y&&I()?(0,u.jsx)(X,{}):"discount_management"===y&&I()?(0,u.jsx)(K,{}):"slab_management"===y&&I()?(0,u.jsx)(Z,{}):"partner_management"===y&&I()?(0,u.jsx)($,{}):"employee_management"===y&&I()?(0,u.jsx)(Q,{}):"bank_details"===y&&I()?(0,u.jsx)(R,{}):"employee_portal"===y&&A()?(0,u.jsx)(ee,{}):"partner_portal"===y&&T()?(0,u.jsx)(te,{}):["subscription_plans","current_subscription","purchase_subscription","upgrade_downgrade","billing_history","usage_dashboard","payment_validation","discount_management","slab_management","partner_management","employee_management","bank_details","employee_portal","partner_portal"].includes(y)?(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center"},children:[(0,u.jsx)("h2",{style:{color:"#dc3545",marginBottom:"16px"},children:"Access Denied"}),(0,u.jsx)("p",{style:{color:"#666"},children:"You don't have permission to access this page."})]}):null}),(0,u.jsx)(z,{})]})}},80045(e,t,n){n.d(t,{A:()=>s});var a=n(98587);function s(e,t){if(null==e)return{};var n,s,o=(0,a.A)(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},98587(e,t,n){function a(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}n.d(t,{A:()=>a})}}]);